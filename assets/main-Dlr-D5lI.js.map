{"version":3,"file":"main-Dlr-D5lI.js","sources":["../../node_modules/@datadog/browser-rum-react/esm/domain/reactPlugin.js","../../node_modules/@datadog/browser-rum-react/esm/domain/error/addReactError.js","../../node_modules/@datadog/browser-rum-react/esm/domain/error/errorBoundary.js","../../node_modules/@datadog/browser-rum-react/esm/domain/performance/timer.js","../../node_modules/@datadog/browser-rum-react/esm/domain/performance/addDurationVital.js","../../node_modules/@datadog/browser-rum-react/esm/domain/performance/reactComponentTracker.js"],"sourcesContent":["let globalPublicApi;\nlet globalConfiguration;\nlet globalAddEvent;\nconst onRumInitSubscribers = [];\nconst onRumStartSubscribers = [];\n/**\n * React plugin constructor.\n *\n * @category Main\n * @example\n * ```ts\n * import { datadogRum } from '@datadog/browser-rum'\n * import { reactPlugin } from '@datadog/browser-rum-react'\n *\n * datadogRum.init({\n *   applicationId: '<DATADOG_APPLICATION_ID>',\n *   clientToken: '<DATADOG_CLIENT_TOKEN>',\n *   site: '<DATADOG_SITE>',\n *   plugins: [reactPlugin()],\n *   // ...\n * })\n * ```\n */\nexport function reactPlugin(configuration = {}) {\n    return {\n        name: 'react',\n        onInit({ publicApi, initConfiguration }) {\n            globalPublicApi = publicApi;\n            globalConfiguration = configuration;\n            for (const subscriber of onRumInitSubscribers) {\n                subscriber(globalConfiguration, globalPublicApi);\n            }\n            if (configuration.router) {\n                initConfiguration.trackViewsManually = true;\n            }\n        },\n        onRumStart({ addEvent }) {\n            globalAddEvent = addEvent;\n            for (const subscriber of onRumStartSubscribers) {\n                if (addEvent) {\n                    subscriber(addEvent);\n                }\n            }\n        },\n        getConfigurationTelemetry() {\n            return { router: !!configuration.router };\n        },\n    };\n}\nexport function onRumInit(callback) {\n    if (globalConfiguration && globalPublicApi) {\n        callback(globalConfiguration, globalPublicApi);\n    }\n    else {\n        onRumInitSubscribers.push(callback);\n    }\n}\nexport function onRumStart(callback) {\n    if (globalAddEvent) {\n        callback(globalAddEvent);\n    }\n    else {\n        onRumStartSubscribers.push(callback);\n    }\n}\nexport function resetReactPlugin() {\n    globalPublicApi = undefined;\n    globalConfiguration = undefined;\n    globalAddEvent = undefined;\n    onRumInitSubscribers.length = 0;\n    onRumStartSubscribers.length = 0;\n}\n//# sourceMappingURL=reactPlugin.js.map","import { callMonitored, clocksNow, computeRawError, createHandlingStack, ErrorSource, generateUUID, } from '@datadog/browser-core';\nimport { RumEventType } from '@datadog/browser-rum-core';\nimport { onRumStart } from '../reactPlugin';\n/**\n * Add a React error to the RUM session.\n *\n * @category Error\n * @example\n * ```ts\n * import { createRoot } from 'react-dom/client'\n * import { datadogRum } from '@datadog/browser-rum'\n * import { addReactError } from '@datadog/browser-rum-react'\n *\n * const container = document.getElementById('root')\n * const root = createRoot(container, {\n *   onUncaughtError: (error, errorInfo) => {\n *     // Report uncaught errors to Datadog\n *     addReactError(error, errorInfo)\n *   }\n * })\n * // ...\n * ```\n */\nexport function addReactError(error, info) {\n    const handlingStack = createHandlingStack('react error');\n    const startClocks = clocksNow();\n    onRumStart((addEvent) => {\n        callMonitored(() => {\n            var _a;\n            const rawError = computeRawError({\n                originalError: error,\n                handlingStack,\n                componentStack: (_a = info.componentStack) !== null && _a !== void 0 ? _a : undefined,\n                startClocks,\n                source: ErrorSource.CUSTOM,\n                handling: \"handled\" /* ErrorHandling.HANDLED */,\n                nonErrorPrefix: \"Provided\" /* NonErrorPrefix.PROVIDED */,\n            });\n            addEvent(startClocks.relative, {\n                type: RumEventType.ERROR,\n                date: rawError.startClocks.timeStamp,\n                error: {\n                    id: generateUUID(),\n                    message: rawError.message,\n                    source: rawError.source,\n                    stack: rawError.stack,\n                    handling_stack: rawError.handlingStack,\n                    component_stack: rawError.componentStack,\n                    type: rawError.type,\n                    handling: rawError.handling,\n                    causes: rawError.causes,\n                    source_type: 'browser',\n                    csp: rawError.csp,\n                },\n                context: { framework: 'react', ...rawError.context },\n            }, {\n                error: rawError.originalError,\n                handlingStack: rawError.handlingStack,\n            });\n        });\n    });\n}\n//# sourceMappingURL=addReactError.js.map","import React from 'react';\nimport { addReactError } from './addReactError';\nconst INITIAL_STATE = { didCatch: false, error: null };\n/**\n * ErrorBoundary component to report React errors to Datadog.\n *\n * For more advanced error handling, you can use the {@link addReactError} function.\n *\n * @category Error\n * @example\n * ```ts\n * import { ErrorBoundary } from '@datadog/browser-rum-react'\n *\n * <ErrorBoundary fallback={() => null}>\n *   <Component />\n * </ErrorBoundary>\n * ```\n */\n// eslint-disable-next-line no-restricted-syntax\nexport class ErrorBoundary extends React.Component {\n    constructor(props) {\n        super(props);\n        this.resetError = () => {\n            this.setState(INITIAL_STATE);\n        };\n        this.state = INITIAL_STATE;\n    }\n    static getDerivedStateFromError(error) {\n        return { didCatch: true, error };\n    }\n    componentDidCatch(error, errorInfo) {\n        addReactError(error, errorInfo);\n    }\n    render() {\n        if (this.state.didCatch) {\n            return React.createElement(this.props.fallback, {\n                error: this.state.error,\n                resetError: this.resetError,\n            });\n        }\n        return this.props.children;\n    }\n}\n//# sourceMappingURL=errorBoundary.js.map","import { elapsed, relativeNow, timeStampNow } from '@datadog/browser-core';\nexport function createTimer() {\n    let duration;\n    let startTime;\n    let highPrecisionStartTime;\n    return {\n        startTimer() {\n            // timeStampNow uses Date.now() internally, which is not high precision, but this is what is\n            // used for other events, so we use it here as well.\n            startTime = timeStampNow();\n            // relativeNow uses performance.now() which is higher precision than Date.now(), so we use for\n            // the duration\n            highPrecisionStartTime = relativeNow();\n        },\n        stopTimer() {\n            duration = elapsed(highPrecisionStartTime, relativeNow());\n        },\n        getDuration() {\n            return duration;\n        },\n        getStartTime() {\n            return startTime;\n        },\n    };\n}\n//# sourceMappingURL=timer.js.map","import { onRumInit } from '../reactPlugin';\nexport const addDurationVital = (name, options) => {\n    onRumInit((_, rumPublicApi) => {\n        rumPublicApi.addDurationVital(name, options);\n    });\n};\n//# sourceMappingURL=addDurationVital.js.map","import * as React from 'react';\nimport { createTimer } from './timer';\nimport { addDurationVital } from './addDurationVital';\n/**\n * Track the performance of a React component.\n *\n * @experimental\n */\n// eslint-disable-next-line\nexport const UNSTABLE_ReactComponentTracker = ({ name: componentName, children, }) => {\n    const isFirstRender = React.useRef(true);\n    const renderTimer = createTimer();\n    const effectTimer = createTimer();\n    const layoutEffectTimer = createTimer();\n    const onEffectEnd = () => {\n        var _a, _b, _c;\n        const renderDuration = (_a = renderTimer.getDuration()) !== null && _a !== void 0 ? _a : 0;\n        const effectDuration = (_b = effectTimer.getDuration()) !== null && _b !== void 0 ? _b : 0;\n        const layoutEffectDuration = (_c = layoutEffectTimer.getDuration()) !== null && _c !== void 0 ? _c : 0;\n        const totalRenderTime = renderDuration + effectDuration + layoutEffectDuration;\n        addDurationVital('reactComponentRender', {\n            description: componentName,\n            startTime: renderTimer.getStartTime(), // note: renderTimer should have been started at this point, so getStartTime should not return undefined\n            duration: totalRenderTime,\n            context: {\n                is_first_render: isFirstRender.current,\n                render_phase_duration: renderDuration,\n                effect_phase_duration: effectDuration,\n                layout_effect_phase_duration: layoutEffectDuration,\n                framework: 'react',\n            },\n        });\n        isFirstRender.current = false;\n    };\n    // In react, children are rendered sequentially in the order they are defined. that's why we can\n    // measure perf timings of a component by starting recordings in the component above and stopping\n    // them in the component below.\n    return (React.createElement(React.Fragment, null,\n        React.createElement(LifeCycle, { onRender: renderTimer.startTimer, onLayoutEffect: layoutEffectTimer.startTimer, onEffect: effectTimer.startTimer }),\n        children,\n        React.createElement(LifeCycle, { onRender: renderTimer.stopTimer, onLayoutEffect: layoutEffectTimer.stopTimer, onEffect: () => {\n                effectTimer.stopTimer();\n                onEffectEnd();\n            } })));\n};\nfunction LifeCycle({ onRender, onLayoutEffect, onEffect, }) {\n    onRender();\n    React.useLayoutEffect(onLayoutEffect);\n    React.useEffect(onEffect);\n    return null;\n}\n//# sourceMappingURL=reactComponentTracker.js.map"],"names":["globalPublicApi","globalConfiguration","globalAddEvent","onRumInitSubscribers","onRumStartSubscribers","reactPlugin","configuration","publicApi","initConfiguration","subscriber","addEvent","onRumInit","callback","onRumStart","addReactError","error","info","handlingStack","createHandlingStack","startClocks","clocksNow","callMonitored","_a","rawError","computeRawError","ErrorSource","RumEventType","generateUUID","INITIAL_STATE","ErrorBoundary","React","props","errorInfo","createTimer","duration","startTime","highPrecisionStartTime","timeStampNow","relativeNow","elapsed","addDurationVital","name","options","_","rumPublicApi","UNSTABLE_ReactComponentTracker","componentName","children","isFirstRender","React.useRef","renderTimer","effectTimer","layoutEffectTimer","onEffectEnd","_b","_c","renderDuration","effectDuration","layoutEffectDuration","totalRenderTime","React.createElement","React.Fragment","LifeCycle","onRender","onLayoutEffect","onEffect","React.useLayoutEffect","React.useEffect"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5]}