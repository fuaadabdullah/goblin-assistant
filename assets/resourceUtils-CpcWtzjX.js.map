{"version":3,"file":"resourceUtils-CpcWtzjX.js","sources":["../../node_modules/@datadog/browser-core/esm/tools/display.js","../../node_modules/@datadog/browser-core/esm/tools/catchUserErrors.js","../../node_modules/@datadog/browser-core/esm/tools/utils/numberUtils.js","../../node_modules/@datadog/browser-core/esm/tools/utils/objectUtils.js","../../node_modules/@datadog/browser-core/esm/tools/globalObject.js","../../node_modules/@datadog/browser-core/esm/tools/getZoneJsOriginalValue.js","../../node_modules/@datadog/browser-core/esm/tools/monitor.js","../../node_modules/@datadog/browser-core/esm/tools/timer.js","../../node_modules/@datadog/browser-core/esm/tools/queueMicrotask.js","../../node_modules/@datadog/browser-core/esm/tools/observable.js","../../node_modules/@datadog/browser-core/esm/tools/utils/timeUtils.js","../../node_modules/@datadog/browser-core/esm/tools/utils/functionUtils.js","../../node_modules/@datadog/browser-core/esm/tools/utils/stringUtils.js","../../node_modules/@datadog/browser-core/esm/tools/utils/browserDetection.js","../../node_modules/@datadog/browser-core/esm/tools/utils/urlPolyfill.js","../../node_modules/@datadog/browser-core/esm/browser/cookie.js","../../node_modules/@datadog/browser-core/esm/domain/session/storeStrategies/sessionStoreStrategy.js","../../node_modules/@datadog/browser-core/esm/tools/utils/polyfills.js","../../node_modules/@datadog/browser-core/esm/domain/session/sessionConstants.js","../../node_modules/@datadog/browser-core/esm/domain/session/sessionStateValidation.js","../../node_modules/@datadog/browser-core/esm/domain/session/sessionState.js","../../node_modules/@datadog/browser-core/esm/domain/session/oldCookiesMigration.js","../../node_modules/@datadog/browser-core/esm/domain/session/storeStrategies/sessionInCookie.js","../../node_modules/@datadog/browser-core/esm/domain/session/storeStrategies/sessionInLocalStorage.js","../../node_modules/@datadog/browser-core/esm/domain/session/sessionStoreOperations.js","../../node_modules/@datadog/browser-core/esm/domain/session/sessionStore.js","../../node_modules/@datadog/browser-core/esm/domain/trackingConsent.js","../../node_modules/@datadog/browser-core/esm/tools/utils/typeUtils.js","../../node_modules/@datadog/browser-core/esm/tools/matchOption.js","../../node_modules/@datadog/browser-core/esm/domain/extension/extensionUtils.js","../../node_modules/@datadog/browser-core/esm/domain/allowedTrackingOrigins.js","../../node_modules/@datadog/browser-core/esm/domain/intakeSites.js","../../node_modules/@datadog/browser-core/esm/domain/configuration/endpointBuilder.js","../../node_modules/@datadog/browser-core/esm/domain/configuration/transportConfiguration.js","../../node_modules/@datadog/browser-core/esm/domain/configuration/configuration.js","../../node_modules/@datadog/browser-core/esm/tools/experimentalFeatures.js","../../node_modules/@datadog/browser-core/esm/tools/stackTrace/computeStackTrace.js","../../node_modules/@datadog/browser-core/esm/tools/stackTrace/handlingStack.js","../../node_modules/@datadog/browser-core/esm/tools/utils/byteUtils.js","../../node_modules/@datadog/browser-core/esm/tools/serialisation/jsonStringify.js","../../node_modules/@datadog/browser-core/esm/tools/serialisation/sanitize.js","../../node_modules/@datadog/browser-core/esm/domain/error/error.js","../../node_modules/@datadog/browser-core/esm/domain/error/error.types.js","../../node_modules/@datadog/browser-core/esm/browser/addEventListener.js","../../node_modules/@datadog/browser-core/esm/domain/resourceUtils.js"],"sourcesContent":["/* eslint-disable local-rules/disallow-side-effects */\n/**\n * Keep references on console methods to avoid triggering patched behaviors\n *\n * NB: in some setup, console could already be patched by another SDK.\n * In this case, some display messages can be sent by the other SDK\n * but we should be safe from infinite loop nonetheless.\n */\nexport const ConsoleApiName = {\n    log: 'log',\n    debug: 'debug',\n    info: 'info',\n    warn: 'warn',\n    error: 'error',\n};\n/**\n * When building JS bundles, some users might use a plugin[1] or configuration[2] to remove\n * \"console.*\" references. This causes some issue as we expect `console.*` to be defined.\n * As a workaround, let's use a variable alias, so those expressions won't be taken into account by\n * simple static analysis.\n *\n * [1]: https://babeljs.io/docs/babel-plugin-transform-remove-console/\n * [2]: https://github.com/terser/terser#compress-options (look for drop_console)\n */\nexport const globalConsole = console;\nexport const originalConsoleMethods = {};\nObject.keys(ConsoleApiName).forEach((name) => {\n    originalConsoleMethods[name] = globalConsole[name];\n});\nconst PREFIX = 'Datadog Browser SDK:';\nexport const display = {\n    debug: originalConsoleMethods.debug.bind(globalConsole, PREFIX),\n    log: originalConsoleMethods.log.bind(globalConsole, PREFIX),\n    info: originalConsoleMethods.info.bind(globalConsole, PREFIX),\n    warn: originalConsoleMethods.warn.bind(globalConsole, PREFIX),\n    error: originalConsoleMethods.error.bind(globalConsole, PREFIX),\n};\nexport const DOCS_ORIGIN = 'https://docs.datadoghq.com';\nexport const DOCS_TROUBLESHOOTING = `${DOCS_ORIGIN}/real_user_monitoring/browser/troubleshooting`;\nexport const MORE_DETAILS = 'More details:';\n//# sourceMappingURL=display.js.map","import { display } from './display';\nexport function catchUserErrors(fn, errorMsg) {\n    return (...args) => {\n        try {\n            return fn(...args);\n        }\n        catch (err) {\n            display.error(errorMsg, err);\n        }\n    };\n}\n//# sourceMappingURL=catchUserErrors.js.map","/**\n * Return true if the draw is successful\n *\n * @param threshold - Threshold between 0 and 100\n */\nexport function performDraw(threshold) {\n    return threshold !== 0 && Math.random() * 100 <= threshold;\n}\nexport function round(num, decimals) {\n    return +num.toFixed(decimals);\n}\nexport function isPercentage(value) {\n    return isNumber(value) && value >= 0 && value <= 100;\n}\nexport function isNumber(value) {\n    return typeof value === 'number';\n}\n//# sourceMappingURL=numberUtils.js.map","export function shallowClone(object) {\n    return { ...object };\n}\nexport function objectHasValue(object, value) {\n    return Object.keys(object).some((key) => object[key] === value);\n}\nexport function isEmptyObject(object) {\n    return Object.keys(object).length === 0;\n}\nexport function mapValues(object, fn) {\n    const newObject = {};\n    for (const key of Object.keys(object)) {\n        newObject[key] = fn(object[key]);\n    }\n    return newObject;\n}\n//# sourceMappingURL=objectUtils.js.map","/**\n * inspired by https://mathiasbynens.be/notes/globalthis\n */\nexport function getGlobalObject() {\n    if (typeof globalThis === 'object') {\n        return globalThis;\n    }\n    Object.defineProperty(Object.prototype, '_dd_temp_', {\n        get() {\n            return this;\n        },\n        configurable: true,\n    });\n    // @ts-ignore _dd_temp is defined using defineProperty\n    let globalObject = _dd_temp_;\n    // @ts-ignore _dd_temp is defined using defineProperty\n    delete Object.prototype._dd_temp_;\n    if (typeof globalObject !== 'object') {\n        // on safari _dd_temp_ is available on window but not globally\n        // fallback on other browser globals check\n        if (typeof self === 'object') {\n            globalObject = self;\n        }\n        else if (typeof window === 'object') {\n            globalObject = window;\n        }\n        else {\n            globalObject = {};\n        }\n    }\n    return globalObject;\n}\n/**\n * Cached reference to the global object so it can be imported and re-used without\n * re-evaluating the heavyweight fallback logic in `getGlobalObject()`.\n */\n// eslint-disable-next-line local-rules/disallow-side-effects\nexport const globalObject = getGlobalObject();\nexport const isWorkerEnvironment = 'WorkerGlobalScope' in globalObject;\n//# sourceMappingURL=globalObject.js.map","import { getGlobalObject } from './globalObject';\n/**\n * Gets the original value for a DOM API that was potentially patched by Zone.js.\n *\n * Zone.js[1] is a library that patches a bunch of JS and DOM APIs. It usually stores the original\n * value of the patched functions/constructors/methods in a hidden property prefixed by\n * __zone_symbol__.\n *\n * In multiple occasions, we observed that Zone.js is the culprit of important issues leading to\n * browser resource exhaustion (memory leak, high CPU usage). This method is used as a workaround to\n * use the original DOM API instead of the one patched by Zone.js.\n *\n * [1]: https://github.com/angular/angular/tree/main/packages/zone.js\n */\nexport function getZoneJsOriginalValue(target, name) {\n    const browserWindow = getGlobalObject();\n    let original;\n    if (browserWindow.Zone && typeof browserWindow.Zone.__symbol__ === 'function') {\n        original = target[browserWindow.Zone.__symbol__(name)];\n    }\n    if (!original) {\n        original = target[name];\n    }\n    return original;\n}\n//# sourceMappingURL=getZoneJsOriginalValue.js.map","import { display } from './display';\nlet onMonitorErrorCollected;\nlet debugMode = false;\nexport function startMonitorErrorCollection(newOnMonitorErrorCollected) {\n    onMonitorErrorCollected = newOnMonitorErrorCollected;\n}\nexport function setDebugMode(newDebugMode) {\n    debugMode = newDebugMode;\n}\nexport function resetMonitor() {\n    onMonitorErrorCollected = undefined;\n    debugMode = false;\n}\nexport function monitored(_, __, descriptor) {\n    const originalMethod = descriptor.value;\n    descriptor.value = function (...args) {\n        const decorated = onMonitorErrorCollected ? monitor(originalMethod) : originalMethod;\n        return decorated.apply(this, args);\n    };\n}\nexport function monitor(fn) {\n    return function () {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return callMonitored(fn, this, arguments);\n    }; // consider output type has input type\n}\nexport function callMonitored(fn, context, args) {\n    try {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return fn.apply(context, args);\n    }\n    catch (e) {\n        monitorError(e);\n    }\n}\nexport function monitorError(e) {\n    displayIfDebugEnabled(e);\n    if (onMonitorErrorCollected) {\n        try {\n            onMonitorErrorCollected(e);\n        }\n        catch (e) {\n            displayIfDebugEnabled(e);\n        }\n    }\n}\nexport function displayIfDebugEnabled(...args) {\n    if (debugMode) {\n        display.error('[MONITOR]', ...args);\n    }\n}\n//# sourceMappingURL=monitor.js.map","import { getZoneJsOriginalValue } from './getZoneJsOriginalValue';\nimport { monitor } from './monitor';\nimport { getGlobalObject } from './globalObject';\nexport function setTimeout(callback, delay) {\n    return getZoneJsOriginalValue(getGlobalObject(), 'setTimeout')(monitor(callback), delay);\n}\nexport function clearTimeout(timeoutId) {\n    getZoneJsOriginalValue(getGlobalObject(), 'clearTimeout')(timeoutId);\n}\nexport function setInterval(callback, delay) {\n    return getZoneJsOriginalValue(getGlobalObject(), 'setInterval')(monitor(callback), delay);\n}\nexport function clearInterval(timeoutId) {\n    getZoneJsOriginalValue(getGlobalObject(), 'clearInterval')(timeoutId);\n}\n//# sourceMappingURL=timer.js.map","import { monitor } from './monitor';\nimport { globalObject } from './globalObject';\nexport function queueMicrotask(callback) {\n    var _a;\n    const nativeImplementation = (_a = globalObject.queueMicrotask) === null || _a === void 0 ? void 0 : _a.bind(globalObject);\n    if (typeof nativeImplementation === 'function') {\n        nativeImplementation(monitor(callback));\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises -- the callback is monitored, so it'll never throw\n        Promise.resolve().then(monitor(callback));\n    }\n}\n//# sourceMappingURL=queueMicrotask.js.map","import { queueMicrotask } from './queueMicrotask';\n// eslint-disable-next-line no-restricted-syntax\nexport class Observable {\n    constructor(onFirstSubscribe) {\n        this.onFirstSubscribe = onFirstSubscribe;\n        this.observers = [];\n    }\n    subscribe(observer) {\n        this.addObserver(observer);\n        return {\n            unsubscribe: () => this.removeObserver(observer),\n        };\n    }\n    notify(data) {\n        this.observers.forEach((observer) => observer(data));\n    }\n    addObserver(observer) {\n        this.observers.push(observer);\n        if (this.observers.length === 1 && this.onFirstSubscribe) {\n            this.onLastUnsubscribe = this.onFirstSubscribe(this) || undefined;\n        }\n    }\n    removeObserver(observer) {\n        this.observers = this.observers.filter((other) => observer !== other);\n        if (!this.observers.length && this.onLastUnsubscribe) {\n            this.onLastUnsubscribe();\n        }\n    }\n}\nexport function mergeObservables(...observables) {\n    return new Observable((globalObservable) => {\n        const subscriptions = observables.map((observable) => observable.subscribe((data) => globalObservable.notify(data)));\n        return () => subscriptions.forEach((subscription) => subscription.unsubscribe());\n    });\n}\n// eslint-disable-next-line no-restricted-syntax\nexport class BufferedObservable extends Observable {\n    constructor(maxBufferSize) {\n        super();\n        this.maxBufferSize = maxBufferSize;\n        this.buffer = [];\n    }\n    notify(data) {\n        this.buffer.push(data);\n        if (this.buffer.length > this.maxBufferSize) {\n            this.buffer.shift();\n        }\n        super.notify(data);\n    }\n    subscribe(observer) {\n        let closed = false;\n        const subscription = {\n            unsubscribe: () => {\n                closed = true;\n                this.removeObserver(observer);\n            },\n        };\n        queueMicrotask(() => {\n            for (const data of this.buffer) {\n                if (closed) {\n                    return;\n                }\n                observer(data);\n            }\n            if (!closed) {\n                this.addObserver(observer);\n            }\n        });\n        return subscription;\n    }\n    /**\n     * Drop buffered data and don't buffer future data. This is to avoid leaking memory when it's not\n     * needed anymore. This can be seen as a performance optimization, and things will work probably\n     * even if this method isn't called, but still useful to clarify our intent and lowering our\n     * memory impact.\n     */\n    unbuffer() {\n        queueMicrotask(() => {\n            this.maxBufferSize = this.buffer.length = 0;\n        });\n    }\n}\n//# sourceMappingURL=observable.js.map","import { isNumber, round } from './numberUtils';\nexport const ONE_SECOND = 1000;\nexport const ONE_MINUTE = 60 * ONE_SECOND;\nexport const ONE_HOUR = 60 * ONE_MINUTE;\nexport const ONE_DAY = 24 * ONE_HOUR;\nexport const ONE_YEAR = 365 * ONE_DAY;\nexport function relativeToClocks(relative) {\n    return { relative, timeStamp: getCorrectedTimeStamp(relative) };\n}\nexport function timeStampToClocks(timeStamp) {\n    return { relative: getRelativeTime(timeStamp), timeStamp };\n}\nfunction getCorrectedTimeStamp(relativeTime) {\n    const correctedOrigin = (dateNow() - performance.now());\n    // apply correction only for positive drift\n    if (correctedOrigin > getNavigationStart()) {\n        return Math.round(addDuration(correctedOrigin, relativeTime));\n    }\n    return getTimeStamp(relativeTime);\n}\nexport function currentDrift() {\n    return Math.round(dateNow() - addDuration(getNavigationStart(), performance.now()));\n}\nexport function toServerDuration(duration) {\n    if (!isNumber(duration)) {\n        return duration;\n    }\n    return round(duration * 1e6, 0);\n}\nexport function dateNow() {\n    // Do not use `Date.now` because sometimes websites are wrongly \"polyfilling\" it. For example, we\n    // had some users using a very old version of `datejs`, which patched `Date.now` to return a Date\n    // instance instead of a timestamp[1]. Those users are unlikely to fix this, so let's handle this\n    // case ourselves.\n    // [1]: https://github.com/datejs/Datejs/blob/97f5c7c58c5bc5accdab8aa7602b6ac56462d778/src/core-debug.js#L14-L16\n    return new Date().getTime();\n}\nexport function timeStampNow() {\n    return dateNow();\n}\nexport function relativeNow() {\n    return performance.now();\n}\nexport function clocksNow() {\n    return { relative: relativeNow(), timeStamp: timeStampNow() };\n}\nexport function clocksOrigin() {\n    return { relative: 0, timeStamp: getNavigationStart() };\n}\nexport function elapsed(start, end) {\n    return (end - start);\n}\nexport function addDuration(a, b) {\n    return a + b;\n}\n// Get the time since the navigation was started.\nexport function getRelativeTime(timestamp) {\n    return (timestamp - getNavigationStart());\n}\nexport function getTimeStamp(relativeTime) {\n    return Math.round(addDuration(getNavigationStart(), relativeTime));\n}\nexport function looksLikeRelativeTime(time) {\n    return time < ONE_YEAR;\n}\n/**\n * Navigation start slightly change on some rare cases\n */\nlet navigationStart;\n/**\n * Notes: this does not use `performance.timeOrigin` because:\n * - It doesn't seem to reflect the actual time on which the navigation has started: it may be much farther in the past,\n * at least in Firefox 71. (see: https://bugzilla.mozilla.org/show_bug.cgi?id=1429926)\n * - It is not supported in Safari <15\n */\nfunction getNavigationStart() {\n    var _a, _b;\n    if (navigationStart === undefined) {\n        // ServiceWorkers do not support navigationStart (it's deprecated), so we fallback to timeOrigin\n        navigationStart = ((_b = (_a = performance.timing) === null || _a === void 0 ? void 0 : _a.navigationStart) !== null && _b !== void 0 ? _b : performance.timeOrigin);\n    }\n    return navigationStart;\n}\n//# sourceMappingURL=timeUtils.js.map","import { setTimeout, clearTimeout } from '../timer';\n// use lodash API\nexport function throttle(fn, wait, options) {\n    const needLeadingExecution = options && options.leading !== undefined ? options.leading : true;\n    const needTrailingExecution = options && options.trailing !== undefined ? options.trailing : true;\n    let inWaitPeriod = false;\n    let pendingExecutionWithParameters;\n    let pendingTimeoutId;\n    return {\n        throttled: (...parameters) => {\n            if (inWaitPeriod) {\n                pendingExecutionWithParameters = parameters;\n                return;\n            }\n            if (needLeadingExecution) {\n                fn(...parameters);\n            }\n            else {\n                pendingExecutionWithParameters = parameters;\n            }\n            inWaitPeriod = true;\n            pendingTimeoutId = setTimeout(() => {\n                if (needTrailingExecution && pendingExecutionWithParameters) {\n                    fn(...pendingExecutionWithParameters);\n                }\n                inWaitPeriod = false;\n                pendingExecutionWithParameters = undefined;\n            }, wait);\n        },\n        cancel: () => {\n            clearTimeout(pendingTimeoutId);\n            inWaitPeriod = false;\n            pendingExecutionWithParameters = undefined;\n        },\n    };\n}\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport function noop() { }\n//# sourceMappingURL=functionUtils.js.map","/**\n * UUID v4\n * from https://gist.github.com/jed/982883\n */\nexport function generateUUID(placeholder) {\n    return placeholder\n        ? // eslint-disable-next-line  no-bitwise\n            (parseInt(placeholder, 10) ^ ((Math.random() * 16) >> (parseInt(placeholder, 10) / 4))).toString(16)\n        : `${1e7}-${1e3}-${4e3}-${8e3}-${1e11}`.replace(/[018]/g, generateUUID);\n}\nconst COMMA_SEPARATED_KEY_VALUE = /([\\w-]+)\\s*=\\s*([^;]+)/g;\n/**\n * Returns the value of the key with the given name\n * If there are multiple values with the same key, returns the first one\n */\nexport function findCommaSeparatedValue(rawString, name) {\n    COMMA_SEPARATED_KEY_VALUE.lastIndex = 0;\n    while (true) {\n        const match = COMMA_SEPARATED_KEY_VALUE.exec(rawString);\n        if (match) {\n            if (match[1] === name) {\n                return match[2];\n            }\n        }\n        else {\n            break;\n        }\n    }\n}\n/**\n * Returns a map of all the values with the given key\n * If there are multiple values with the same key, returns all the values\n */\nexport function findAllCommaSeparatedValues(rawString) {\n    const result = new Map();\n    COMMA_SEPARATED_KEY_VALUE.lastIndex = 0;\n    while (true) {\n        const match = COMMA_SEPARATED_KEY_VALUE.exec(rawString);\n        if (match) {\n            const key = match[1];\n            const value = match[2];\n            if (result.has(key)) {\n                result.get(key).push(value);\n            }\n            else {\n                result.set(key, [value]);\n            }\n        }\n        else {\n            break;\n        }\n    }\n    return result;\n}\n/**\n * Returns a map of the values with the given key\n * ⚠️ If there are multiple values with the same key, returns the LAST one\n *\n * @deprecated use `findAllCommaSeparatedValues()` instead\n */\nexport function findCommaSeparatedValues(rawString) {\n    const result = new Map();\n    COMMA_SEPARATED_KEY_VALUE.lastIndex = 0;\n    while (true) {\n        const match = COMMA_SEPARATED_KEY_VALUE.exec(rawString);\n        if (match) {\n            result.set(match[1], match[2]);\n        }\n        else {\n            break;\n        }\n    }\n    return result;\n}\nexport function safeTruncate(candidate, length, suffix = '') {\n    const lastChar = candidate.charCodeAt(length - 1);\n    const isLastCharSurrogatePair = lastChar >= 0xd800 && lastChar <= 0xdbff;\n    const correctedLength = isLastCharSurrogatePair ? length + 1 : length;\n    if (candidate.length <= correctedLength) {\n        return candidate;\n    }\n    return `${candidate.slice(0, correctedLength)}${suffix}`;\n}\n//# sourceMappingURL=stringUtils.js.map","export function isChromium() {\n    return detectBrowserCached() === 0 /* Browser.CHROMIUM */;\n}\nexport function isSafari() {\n    return detectBrowserCached() === 1 /* Browser.SAFARI */;\n}\nlet browserCache;\nfunction detectBrowserCached() {\n    return browserCache !== null && browserCache !== void 0 ? browserCache : (browserCache = detectBrowser());\n}\n// Exported only for tests\nexport function detectBrowser(browserWindow = window) {\n    var _a;\n    const userAgent = browserWindow.navigator.userAgent;\n    if (browserWindow.chrome || /HeadlessChrome/.test(userAgent)) {\n        return 0 /* Browser.CHROMIUM */;\n    }\n    if (\n    // navigator.vendor is deprecated, but it is the most resilient way we found to detect\n    // \"Apple maintained browsers\" (AKA Safari). If one day it gets removed, we still have the\n    // useragent test as a semi-working fallback.\n    ((_a = browserWindow.navigator.vendor) === null || _a === void 0 ? void 0 : _a.indexOf('Apple')) === 0 ||\n        (/safari/i.test(userAgent) && !/chrome|android/i.test(userAgent))) {\n        return 1 /* Browser.SAFARI */;\n    }\n    return 2 /* Browser.OTHER */;\n}\n//# sourceMappingURL=browserDetection.js.map","import { globalObject } from '../globalObject';\nexport function normalizeUrl(url) {\n    return buildUrl(url, location.href).href;\n}\nexport function isValidUrl(url) {\n    try {\n        return !!buildUrl(url);\n    }\n    catch (_a) {\n        return false;\n    }\n}\nexport function getPathName(url) {\n    const pathname = buildUrl(url).pathname;\n    return pathname[0] === '/' ? pathname : `/${pathname}`;\n}\nexport function buildUrl(url, base) {\n    const { URL } = getPristineWindow();\n    try {\n        return base !== undefined ? new URL(url, base) : new URL(url);\n    }\n    catch (error) {\n        throw new Error(`Failed to construct URL: ${String(error)}`);\n    }\n}\n/**\n * Get native URL constructor from a clean iframe\n * This avoids polyfill issues by getting the native implementation from a fresh iframe context\n * Falls back to the original URL constructor if iframe approach fails\n */\nlet getPristineGlobalObjectCache;\nexport function getPristineWindow() {\n    if (!getPristineGlobalObjectCache) {\n        let iframe;\n        let pristineWindow;\n        try {\n            iframe = document.createElement('iframe');\n            iframe.style.display = 'none';\n            document.body.appendChild(iframe);\n            pristineWindow = iframe.contentWindow;\n        }\n        catch (_a) {\n            pristineWindow = globalObject;\n        }\n        getPristineGlobalObjectCache = {\n            URL: pristineWindow.URL,\n        };\n        iframe === null || iframe === void 0 ? void 0 : iframe.remove();\n    }\n    return getPristineGlobalObjectCache;\n}\n//# sourceMappingURL=urlPolyfill.js.map","import { display } from '../tools/display';\nimport { ONE_MINUTE, ONE_SECOND } from '../tools/utils/timeUtils';\nimport { findAllCommaSeparatedValues, findCommaSeparatedValue, findCommaSeparatedValues, generateUUID, } from '../tools/utils/stringUtils';\nimport { buildUrl } from '../tools/utils/urlPolyfill';\nexport function setCookie(name, value, expireDelay = 0, options) {\n    const date = new Date();\n    date.setTime(date.getTime() + expireDelay);\n    const expires = `expires=${date.toUTCString()}`;\n    const sameSite = options && options.crossSite ? 'none' : 'strict';\n    const domain = options && options.domain ? `;domain=${options.domain}` : '';\n    const secure = options && options.secure ? ';secure' : '';\n    const partitioned = options && options.partitioned ? ';partitioned' : '';\n    document.cookie = `${name}=${value};${expires};path=/;samesite=${sameSite}${domain}${secure}${partitioned}`;\n}\n/**\n * Returns the value of the cookie with the given name\n * If there are multiple cookies with the same name, returns the first one\n */\nexport function getCookie(name) {\n    return findCommaSeparatedValue(document.cookie, name);\n}\n/**\n * Returns all the values of the cookies with the given name\n */\nexport function getCookies(name) {\n    return findAllCommaSeparatedValues(document.cookie).get(name) || [];\n}\nlet initCookieParsed;\n/**\n * Returns a cached value of the cookie. Use this during SDK initialization (and whenever possible)\n * to avoid accessing document.cookie multiple times.\n *\n * ⚠️ If there are multiple cookies with the same name, returns the LAST one (unlike `getCookie()`)\n */\nexport function getInitCookie(name) {\n    if (!initCookieParsed) {\n        initCookieParsed = findCommaSeparatedValues(document.cookie);\n    }\n    return initCookieParsed.get(name);\n}\nexport function resetInitCookies() {\n    initCookieParsed = undefined;\n}\nexport function deleteCookie(name, options) {\n    setCookie(name, '', 0, options);\n}\nexport function areCookiesAuthorized(options) {\n    if (document.cookie === undefined || document.cookie === null) {\n        return false;\n    }\n    try {\n        // Use a unique cookie name to avoid issues when the SDK is initialized multiple times during\n        // the test cookie lifetime\n        const testCookieName = `dd_cookie_test_${generateUUID()}`;\n        const testCookieValue = 'test';\n        setCookie(testCookieName, testCookieValue, ONE_MINUTE, options);\n        const isCookieCorrectlySet = getCookie(testCookieName) === testCookieValue;\n        deleteCookie(testCookieName, options);\n        return isCookieCorrectlySet;\n    }\n    catch (error) {\n        display.error(error);\n        return false;\n    }\n}\n/**\n * No API to retrieve it, number of levels for subdomain and suffix are unknown\n * strategy: find the minimal domain on which cookies are allowed to be set\n * https://web.dev/same-site-same-origin/#site\n */\nlet getCurrentSiteCache;\nexport function getCurrentSite(hostname = location.hostname, referrer = document.referrer) {\n    if (getCurrentSiteCache === undefined) {\n        const defaultHostName = getCookieDefaultHostName(hostname, referrer);\n        if (defaultHostName) {\n            // Use a unique cookie name to avoid issues when the SDK is initialized multiple times during\n            // the test cookie lifetime\n            const testCookieName = `dd_site_test_${generateUUID()}`;\n            const testCookieValue = 'test';\n            const domainLevels = defaultHostName.split('.');\n            let candidateDomain = domainLevels.pop();\n            while (domainLevels.length && !getCookie(testCookieName)) {\n                candidateDomain = `${domainLevels.pop()}.${candidateDomain}`;\n                setCookie(testCookieName, testCookieValue, ONE_SECOND, { domain: candidateDomain });\n            }\n            deleteCookie(testCookieName, { domain: candidateDomain });\n            getCurrentSiteCache = candidateDomain;\n        }\n    }\n    return getCurrentSiteCache;\n}\nfunction getCookieDefaultHostName(hostname, referrer) {\n    try {\n        return hostname || buildUrl(referrer).hostname;\n    }\n    catch (_a) {\n        // Ignore\n    }\n}\nexport function resetGetCurrentSite() {\n    getCurrentSiteCache = undefined;\n}\n//# sourceMappingURL=cookie.js.map","export const SESSION_STORE_KEY = '_dd_s';\n//# sourceMappingURL=sessionStoreStrategy.js.map","export function findLast(array, predicate) {\n    for (let i = array.length - 1; i >= 0; i -= 1) {\n        const item = array[i];\n        if (predicate(item, i, array)) {\n            return item;\n        }\n    }\n    return undefined;\n}\n// Keep the following wrapper functions as it can be mangled and will result in smaller bundle size that using\n// the native Object.values and Object.entries directly\nexport function objectValues(object) {\n    return Object.values(object);\n}\nexport function objectEntries(object) {\n    return Object.entries(object);\n}\n//# sourceMappingURL=polyfills.js.map","import { ONE_HOUR, ONE_MINUTE, ONE_YEAR } from '../../tools/utils/timeUtils';\nexport const SESSION_TIME_OUT_DELAY = 4 * ONE_HOUR;\nexport const SESSION_EXPIRATION_DELAY = 15 * ONE_MINUTE;\nexport const SESSION_COOKIE_EXPIRATION_DELAY = ONE_YEAR;\nexport const SESSION_NOT_TRACKED = '0';\n/**\n * @internal\n */\nexport const SessionPersistence = {\n    COOKIE: 'cookie',\n    LOCAL_STORAGE: 'local-storage',\n};\n//# sourceMappingURL=sessionConstants.js.map","export const SESSION_ENTRY_REGEXP = /^([a-zA-Z]+)=([a-z0-9-]+)$/;\nexport const SESSION_ENTRY_SEPARATOR = '&';\nexport function isValidSessionString(sessionString) {\n    return (!!sessionString &&\n        (sessionString.indexOf(SESSION_ENTRY_SEPARATOR) !== -1 || SESSION_ENTRY_REGEXP.test(sessionString)));\n}\n//# sourceMappingURL=sessionStateValidation.js.map","import { isEmptyObject } from '../../tools/utils/objectUtils';\nimport { objectEntries } from '../../tools/utils/polyfills';\nimport { dateNow } from '../../tools/utils/timeUtils';\nimport { SESSION_EXPIRATION_DELAY, SESSION_TIME_OUT_DELAY } from './sessionConstants';\nimport { isValidSessionString, SESSION_ENTRY_REGEXP, SESSION_ENTRY_SEPARATOR } from './sessionStateValidation';\nexport const EXPIRED = '1';\nexport function getExpiredSessionState(previousSessionState, configuration) {\n    const expiredSessionState = {\n        isExpired: EXPIRED,\n    };\n    if (configuration.trackAnonymousUser && (previousSessionState === null || previousSessionState === void 0 ? void 0 : previousSessionState.anonymousId)) {\n        expiredSessionState.anonymousId = previousSessionState === null || previousSessionState === void 0 ? void 0 : previousSessionState.anonymousId;\n    }\n    return expiredSessionState;\n}\nexport function isSessionInNotStartedState(session) {\n    return isEmptyObject(session);\n}\nexport function isSessionStarted(session) {\n    return !isSessionInNotStartedState(session);\n}\nexport function isSessionInExpiredState(session) {\n    return session.isExpired !== undefined || !isActiveSession(session);\n}\n// An active session is a session in either `Tracked` or `NotTracked` state\nfunction isActiveSession(sessionState) {\n    // created and expire can be undefined for versions which was not storing them\n    // these checks could be removed when older versions will not be available/live anymore\n    return ((sessionState.created === undefined || dateNow() - Number(sessionState.created) < SESSION_TIME_OUT_DELAY) &&\n        (sessionState.expire === undefined || dateNow() < Number(sessionState.expire)));\n}\nexport function expandSessionState(session) {\n    session.expire = String(dateNow() + SESSION_EXPIRATION_DELAY);\n}\nexport function toSessionString(session) {\n    return (objectEntries(session)\n        // we use `aid` as a key for anonymousId\n        .map(([key, value]) => (key === 'anonymousId' ? `aid=${value}` : `${key}=${value}`))\n        .join(SESSION_ENTRY_SEPARATOR));\n}\nexport function toSessionState(sessionString) {\n    const session = {};\n    if (isValidSessionString(sessionString)) {\n        sessionString.split(SESSION_ENTRY_SEPARATOR).forEach((entry) => {\n            const matches = SESSION_ENTRY_REGEXP.exec(entry);\n            if (matches !== null) {\n                const [, key, value] = matches;\n                if (key === 'aid') {\n                    // we use `aid` as a key for anonymousId\n                    session.anonymousId = value;\n                }\n                else {\n                    session[key] = value;\n                }\n            }\n        });\n    }\n    return session;\n}\n//# sourceMappingURL=sessionState.js.map","import { getInitCookie } from '../../browser/cookie';\nimport { SESSION_STORE_KEY } from './storeStrategies/sessionStoreStrategy';\nimport { expandSessionState, isSessionStarted } from './sessionState';\nexport const OLD_SESSION_COOKIE_NAME = '_dd';\nexport const OLD_RUM_COOKIE_NAME = '_dd_r';\nexport const OLD_LOGS_COOKIE_NAME = '_dd_l';\n// duplicate values to avoid dependency issues\nexport const RUM_SESSION_KEY = 'rum';\nexport const LOGS_SESSION_KEY = 'logs';\n/**\n * This migration should remain in the codebase as long as older versions are available/live\n * to allow older sdk versions to be upgraded to newer versions without compatibility issues.\n */\nexport function tryOldCookiesMigration(cookieStoreStrategy) {\n    const sessionString = getInitCookie(SESSION_STORE_KEY);\n    if (!sessionString) {\n        const oldSessionId = getInitCookie(OLD_SESSION_COOKIE_NAME);\n        const oldRumType = getInitCookie(OLD_RUM_COOKIE_NAME);\n        const oldLogsType = getInitCookie(OLD_LOGS_COOKIE_NAME);\n        const session = {};\n        if (oldSessionId) {\n            session.id = oldSessionId;\n        }\n        if (oldLogsType && /^[01]$/.test(oldLogsType)) {\n            session[LOGS_SESSION_KEY] = oldLogsType;\n        }\n        if (oldRumType && /^[012]$/.test(oldRumType)) {\n            session[RUM_SESSION_KEY] = oldRumType;\n        }\n        if (isSessionStarted(session)) {\n            expandSessionState(session);\n            cookieStoreStrategy.persistSession(session);\n        }\n    }\n}\n//# sourceMappingURL=oldCookiesMigration.js.map","import { isEmptyObject } from '../../../tools/utils/objectUtils';\nimport { isChromium } from '../../../tools/utils/browserDetection';\nimport { getCurrentSite, areCookiesAuthorized, getCookies, setCookie, getCookie } from '../../../browser/cookie';\nimport { tryOldCookiesMigration } from '../oldCookiesMigration';\nimport { SESSION_COOKIE_EXPIRATION_DELAY, SESSION_EXPIRATION_DELAY, SESSION_TIME_OUT_DELAY, SessionPersistence, } from '../sessionConstants';\nimport { toSessionString, toSessionState, getExpiredSessionState } from '../sessionState';\nimport { SESSION_STORE_KEY } from './sessionStoreStrategy';\nconst SESSION_COOKIE_VERSION = 0;\nexport function selectCookieStrategy(initConfiguration) {\n    const cookieOptions = buildCookieOptions(initConfiguration);\n    return cookieOptions && areCookiesAuthorized(cookieOptions)\n        ? { type: SessionPersistence.COOKIE, cookieOptions }\n        : undefined;\n}\nexport function initCookieStrategy(configuration, cookieOptions) {\n    const cookieStore = {\n        /**\n         * Lock strategy allows mitigating issues due to concurrent access to cookie.\n         * This issue concerns only chromium browsers and enabling this on firefox increases cookie write failures.\n         */\n        isLockEnabled: isChromium(),\n        persistSession: (sessionState) => storeSessionCookie(cookieOptions, configuration, sessionState, SESSION_EXPIRATION_DELAY),\n        retrieveSession: () => retrieveSessionCookie(cookieOptions, configuration),\n        expireSession: (sessionState) => storeSessionCookie(cookieOptions, configuration, getExpiredSessionState(sessionState, configuration), SESSION_TIME_OUT_DELAY),\n    };\n    tryOldCookiesMigration(cookieStore);\n    return cookieStore;\n}\nfunction storeSessionCookie(options, configuration, sessionState, defaultTimeout) {\n    let sessionStateString = toSessionString(sessionState);\n    if (configuration.betaEncodeCookieOptions) {\n        sessionStateString = toSessionString({\n            ...sessionState,\n            // deleting a cookie is writing a new cookie with an empty value\n            // we don't want to store the cookie options in this case otherwise the cookie will not be deleted\n            ...(!isEmptyObject(sessionState) ? { c: encodeCookieOptions(options) } : {}),\n        });\n    }\n    setCookie(SESSION_STORE_KEY, sessionStateString, configuration.trackAnonymousUser ? SESSION_COOKIE_EXPIRATION_DELAY : defaultTimeout, options);\n}\n/**\n * Retrieve the session state from the cookie that was set with the same cookie options\n * If there is no match, return the first cookie, because that's how `getCookie()` works\n */\nexport function retrieveSessionCookie(cookieOptions, configuration) {\n    if (configuration.betaEncodeCookieOptions) {\n        return retrieveSessionCookieFromEncodedCookie(cookieOptions);\n    }\n    const sessionString = getCookie(SESSION_STORE_KEY);\n    const sessionState = toSessionState(sessionString);\n    return sessionState;\n}\nexport function buildCookieOptions(initConfiguration) {\n    const cookieOptions = {};\n    cookieOptions.secure =\n        !!initConfiguration.useSecureSessionCookie || !!initConfiguration.usePartitionedCrossSiteSessionCookie;\n    cookieOptions.crossSite = !!initConfiguration.usePartitionedCrossSiteSessionCookie;\n    cookieOptions.partitioned = !!initConfiguration.usePartitionedCrossSiteSessionCookie;\n    if (initConfiguration.trackSessionAcrossSubdomains) {\n        const currentSite = getCurrentSite();\n        if (!currentSite) {\n            return;\n        }\n        cookieOptions.domain = currentSite;\n    }\n    return cookieOptions;\n}\nfunction encodeCookieOptions(cookieOptions) {\n    const domainCount = cookieOptions.domain ? cookieOptions.domain.split('.').length - 1 : 0;\n    /* eslint-disable no-bitwise */\n    let byte = 0;\n    byte |= SESSION_COOKIE_VERSION << 5; // Store version in upper 3 bits\n    byte |= domainCount << 1; // Store domain count in next 4 bits\n    byte |= cookieOptions.crossSite ? 1 : 0; // Store useCrossSiteScripting in next bit\n    /* eslint-enable no-bitwise */\n    return byte.toString(16); // Convert to hex string\n}\n/**\n * Retrieve the session state from the cookie that was set with the same cookie options.\n * If there is no match, fallback to the first cookie, (because that's how `getCookie()` works)\n * and this allows to keep the current session id when we release this feature.\n */\nfunction retrieveSessionCookieFromEncodedCookie(cookieOptions) {\n    const cookies = getCookies(SESSION_STORE_KEY);\n    const opts = encodeCookieOptions(cookieOptions);\n    let sessionState;\n    // reverse the cookies so that if there is no match, the cookie returned is the first one\n    for (const cookie of cookies.reverse()) {\n        sessionState = toSessionState(cookie);\n        if (sessionState.c === opts) {\n            break;\n        }\n    }\n    // remove the cookie options from the session state as this is not part of the session state\n    sessionState === null || sessionState === void 0 ? true : delete sessionState.c;\n    return sessionState !== null && sessionState !== void 0 ? sessionState : {};\n}\n//# sourceMappingURL=sessionInCookie.js.map","import { generateUUID } from '../../../tools/utils/stringUtils';\nimport { SessionPersistence } from '../sessionConstants';\nimport { toSessionString, toSessionState, getExpiredSessionState } from '../sessionState';\nimport { SESSION_STORE_KEY } from './sessionStoreStrategy';\nconst LOCAL_STORAGE_TEST_KEY = '_dd_test_';\nexport function selectLocalStorageStrategy() {\n    try {\n        const id = generateUUID();\n        const testKey = `${LOCAL_STORAGE_TEST_KEY}${id}`;\n        localStorage.setItem(testKey, id);\n        const retrievedId = localStorage.getItem(testKey);\n        localStorage.removeItem(testKey);\n        return id === retrievedId ? { type: SessionPersistence.LOCAL_STORAGE } : undefined;\n    }\n    catch (_a) {\n        return undefined;\n    }\n}\nexport function initLocalStorageStrategy(configuration) {\n    return {\n        isLockEnabled: false,\n        persistSession: persistInLocalStorage,\n        retrieveSession: retrieveSessionFromLocalStorage,\n        expireSession: (sessionState) => expireSessionFromLocalStorage(sessionState, configuration),\n    };\n}\nfunction persistInLocalStorage(sessionState) {\n    localStorage.setItem(SESSION_STORE_KEY, toSessionString(sessionState));\n}\nexport function retrieveSessionFromLocalStorage() {\n    const sessionString = localStorage.getItem(SESSION_STORE_KEY);\n    return toSessionState(sessionString);\n}\nfunction expireSessionFromLocalStorage(previousSessionState, configuration) {\n    persistInLocalStorage(getExpiredSessionState(previousSessionState, configuration));\n}\n//# sourceMappingURL=sessionInLocalStorage.js.map","import { setTimeout } from '../../tools/timer';\nimport { generateUUID } from '../../tools/utils/stringUtils';\nimport { elapsed, ONE_SECOND, timeStampNow } from '../../tools/utils/timeUtils';\nimport { expandSessionState, isSessionInExpiredState } from './sessionState';\nexport const LOCK_RETRY_DELAY = 10;\nexport const LOCK_MAX_TRIES = 100;\n// Locks should be hold for a few milliseconds top, just the time it takes to read and write a\n// cookie. Using one second should be enough in most situations.\nexport const LOCK_EXPIRATION_DELAY = ONE_SECOND;\nconst LOCK_SEPARATOR = '--';\nconst bufferedOperations = [];\nlet ongoingOperations;\nexport function processSessionStoreOperations(operations, sessionStoreStrategy, numberOfRetries = 0) {\n    var _a;\n    const { isLockEnabled, persistSession, expireSession } = sessionStoreStrategy;\n    const persistWithLock = (session) => persistSession({ ...session, lock: currentLock });\n    const retrieveStore = () => {\n        const { lock, ...session } = sessionStoreStrategy.retrieveSession();\n        return {\n            session,\n            lock: lock && !isLockExpired(lock) ? lock : undefined,\n        };\n    };\n    if (!ongoingOperations) {\n        ongoingOperations = operations;\n    }\n    if (operations !== ongoingOperations) {\n        bufferedOperations.push(operations);\n        return;\n    }\n    if (isLockEnabled && numberOfRetries >= LOCK_MAX_TRIES) {\n        next(sessionStoreStrategy);\n        return;\n    }\n    let currentLock;\n    let currentStore = retrieveStore();\n    if (isLockEnabled) {\n        // if someone has lock, retry later\n        if (currentStore.lock) {\n            retryLater(operations, sessionStoreStrategy, numberOfRetries);\n            return;\n        }\n        // acquire lock\n        currentLock = createLock();\n        persistWithLock(currentStore.session);\n        // if lock is not acquired, retry later\n        currentStore = retrieveStore();\n        if (currentStore.lock !== currentLock) {\n            retryLater(operations, sessionStoreStrategy, numberOfRetries);\n            return;\n        }\n    }\n    let processedSession = operations.process(currentStore.session);\n    if (isLockEnabled) {\n        // if lock corrupted after process, retry later\n        currentStore = retrieveStore();\n        if (currentStore.lock !== currentLock) {\n            retryLater(operations, sessionStoreStrategy, numberOfRetries);\n            return;\n        }\n    }\n    if (processedSession) {\n        if (isSessionInExpiredState(processedSession)) {\n            expireSession(processedSession);\n        }\n        else {\n            expandSessionState(processedSession);\n            if (isLockEnabled) {\n                persistWithLock(processedSession);\n            }\n            else {\n                persistSession(processedSession);\n            }\n        }\n    }\n    if (isLockEnabled) {\n        // correctly handle lock around expiration would require to handle this case properly at several levels\n        // since we don't have evidence of lock issues around expiration, let's just not do the corruption check for it\n        if (!(processedSession && isSessionInExpiredState(processedSession))) {\n            // if lock corrupted after persist, retry later\n            currentStore = retrieveStore();\n            if (currentStore.lock !== currentLock) {\n                retryLater(operations, sessionStoreStrategy, numberOfRetries);\n                return;\n            }\n            persistSession(currentStore.session);\n            processedSession = currentStore.session;\n        }\n    }\n    // call after even if session is not persisted in order to perform operations on\n    // up-to-date session state value => the value could have been modified by another tab\n    (_a = operations.after) === null || _a === void 0 ? void 0 : _a.call(operations, processedSession || currentStore.session);\n    next(sessionStoreStrategy);\n}\nfunction retryLater(operations, sessionStore, currentNumberOfRetries) {\n    setTimeout(() => {\n        processSessionStoreOperations(operations, sessionStore, currentNumberOfRetries + 1);\n    }, LOCK_RETRY_DELAY);\n}\nfunction next(sessionStore) {\n    ongoingOperations = undefined;\n    const nextOperations = bufferedOperations.shift();\n    if (nextOperations) {\n        processSessionStoreOperations(nextOperations, sessionStore);\n    }\n}\nexport function createLock() {\n    return generateUUID() + LOCK_SEPARATOR + timeStampNow();\n}\nfunction isLockExpired(lock) {\n    const [, timeStamp] = lock.split(LOCK_SEPARATOR);\n    return !timeStamp || elapsed(Number(timeStamp), timeStampNow()) > LOCK_EXPIRATION_DELAY;\n}\n//# sourceMappingURL=sessionStoreOperations.js.map","import { clearInterval, setInterval } from '../../tools/timer';\nimport { Observable } from '../../tools/observable';\nimport { ONE_SECOND, dateNow } from '../../tools/utils/timeUtils';\nimport { throttle } from '../../tools/utils/functionUtils';\nimport { generateUUID } from '../../tools/utils/stringUtils';\nimport { display } from '../../tools/display';\nimport { selectCookieStrategy, initCookieStrategy } from './storeStrategies/sessionInCookie';\nimport { getExpiredSessionState, isSessionInExpiredState, isSessionInNotStartedState, isSessionStarted, } from './sessionState';\nimport { initLocalStorageStrategy, selectLocalStorageStrategy } from './storeStrategies/sessionInLocalStorage';\nimport { processSessionStoreOperations } from './sessionStoreOperations';\nimport { SESSION_NOT_TRACKED, SessionPersistence } from './sessionConstants';\n/**\n * Every second, the storage will be polled to check for any change that can occur\n * to the session state in another browser tab, or another window.\n * This value has been determined from our previous cookie-only implementation.\n */\nexport const STORAGE_POLL_DELAY = ONE_SECOND;\n/**\n * Selects the correct session store strategy type based on the configuration and storage\n * availability.\n */\nexport function selectSessionStoreStrategyType(initConfiguration) {\n    switch (initConfiguration.sessionPersistence) {\n        case SessionPersistence.COOKIE:\n            return selectCookieStrategy(initConfiguration);\n        case SessionPersistence.LOCAL_STORAGE:\n            return selectLocalStorageStrategy();\n        case undefined: {\n            let sessionStoreStrategyType = selectCookieStrategy(initConfiguration);\n            if (!sessionStoreStrategyType && initConfiguration.allowFallbackToLocalStorage) {\n                sessionStoreStrategyType = selectLocalStorageStrategy();\n            }\n            return sessionStoreStrategyType;\n        }\n        default:\n            display.error(`Invalid session persistence '${String(initConfiguration.sessionPersistence)}'`);\n    }\n}\nexport function getSessionStoreStrategy(sessionStoreStrategyType, configuration) {\n    return sessionStoreStrategyType.type === SessionPersistence.COOKIE\n        ? initCookieStrategy(configuration, sessionStoreStrategyType.cookieOptions)\n        : initLocalStorageStrategy(configuration);\n}\n/**\n * Different session concepts:\n * - tracked, the session has an id and is updated along the user navigation\n * - not tracked, the session does not have an id but it is updated along the user navigation\n * - inactive, no session in store or session expired, waiting for a renew session\n */\nexport function startSessionStore(sessionStoreStrategyType, configuration, productKey, computeTrackingType, sessionStoreStrategy = getSessionStoreStrategy(sessionStoreStrategyType, configuration)) {\n    const renewObservable = new Observable();\n    const expireObservable = new Observable();\n    const sessionStateUpdateObservable = new Observable();\n    const watchSessionTimeoutId = setInterval(watchSession, STORAGE_POLL_DELAY);\n    let sessionCache;\n    startSession();\n    const { throttled: throttledExpandOrRenewSession, cancel: cancelExpandOrRenewSession } = throttle(() => {\n        processSessionStoreOperations({\n            process: (sessionState) => {\n                if (isSessionInNotStartedState(sessionState)) {\n                    return;\n                }\n                const synchronizedSession = synchronizeSession(sessionState);\n                expandOrRenewSessionState(synchronizedSession);\n                return synchronizedSession;\n            },\n            after: (sessionState) => {\n                if (isSessionStarted(sessionState) && !hasSessionInCache()) {\n                    renewSessionInCache(sessionState);\n                }\n                sessionCache = sessionState;\n            },\n        }, sessionStoreStrategy);\n    }, STORAGE_POLL_DELAY);\n    function expandSession() {\n        processSessionStoreOperations({\n            process: (sessionState) => (hasSessionInCache() ? synchronizeSession(sessionState) : undefined),\n        }, sessionStoreStrategy);\n    }\n    /**\n     * allows two behaviors:\n     * - if the session is active, synchronize the session cache without updating the session store\n     * - if the session is not active, clear the session store and expire the session cache\n     */\n    function watchSession() {\n        const sessionState = sessionStoreStrategy.retrieveSession();\n        if (isSessionInExpiredState(sessionState)) {\n            processSessionStoreOperations({\n                process: (sessionState) => isSessionInExpiredState(sessionState) ? getExpiredSessionState(sessionState, configuration) : undefined,\n                after: synchronizeSession,\n            }, sessionStoreStrategy);\n        }\n        else {\n            synchronizeSession(sessionState);\n        }\n    }\n    function synchronizeSession(sessionState) {\n        if (isSessionInExpiredState(sessionState)) {\n            sessionState = getExpiredSessionState(sessionState, configuration);\n        }\n        if (hasSessionInCache()) {\n            if (isSessionInCacheOutdated(sessionState)) {\n                expireSessionInCache();\n            }\n            else {\n                sessionStateUpdateObservable.notify({ previousState: sessionCache, newState: sessionState });\n                sessionCache = sessionState;\n            }\n        }\n        return sessionState;\n    }\n    function startSession() {\n        processSessionStoreOperations({\n            process: (sessionState) => {\n                if (isSessionInNotStartedState(sessionState)) {\n                    sessionState.anonymousId = generateUUID();\n                    return getExpiredSessionState(sessionState, configuration);\n                }\n            },\n            after: (sessionState) => {\n                sessionCache = sessionState;\n            },\n        }, sessionStoreStrategy);\n    }\n    function expandOrRenewSessionState(sessionState) {\n        if (isSessionInNotStartedState(sessionState)) {\n            return false;\n        }\n        const trackingType = computeTrackingType(sessionState[productKey]);\n        sessionState[productKey] = trackingType;\n        delete sessionState.isExpired;\n        if (trackingType !== SESSION_NOT_TRACKED && !sessionState.id) {\n            sessionState.id = generateUUID();\n            sessionState.created = String(dateNow());\n        }\n    }\n    function hasSessionInCache() {\n        return (sessionCache === null || sessionCache === void 0 ? void 0 : sessionCache[productKey]) !== undefined;\n    }\n    function isSessionInCacheOutdated(sessionState) {\n        return sessionCache.id !== sessionState.id || sessionCache[productKey] !== sessionState[productKey];\n    }\n    function expireSessionInCache() {\n        sessionCache = getExpiredSessionState(sessionCache, configuration);\n        expireObservable.notify();\n    }\n    function renewSessionInCache(sessionState) {\n        sessionCache = sessionState;\n        renewObservable.notify();\n    }\n    function updateSessionState(partialSessionState) {\n        processSessionStoreOperations({\n            process: (sessionState) => ({ ...sessionState, ...partialSessionState }),\n            after: synchronizeSession,\n        }, sessionStoreStrategy);\n    }\n    return {\n        expandOrRenewSession: throttledExpandOrRenewSession,\n        expandSession,\n        getSession: () => sessionCache,\n        renewObservable,\n        expireObservable,\n        sessionStateUpdateObservable,\n        restartSession: startSession,\n        expire: (hasConsent) => {\n            cancelExpandOrRenewSession();\n            if (hasConsent === false && sessionCache) {\n                delete sessionCache.anonymousId;\n            }\n            sessionStoreStrategy.expireSession(sessionCache);\n            synchronizeSession(getExpiredSessionState(sessionCache, configuration));\n        },\n        stop: () => {\n            clearInterval(watchSessionTimeoutId);\n        },\n        updateSessionState,\n    };\n}\n//# sourceMappingURL=sessionStore.js.map","import { Observable } from '../tools/observable';\nexport const TrackingConsent = {\n    GRANTED: 'granted',\n    NOT_GRANTED: 'not-granted',\n};\nexport function createTrackingConsentState(currentConsent) {\n    const observable = new Observable();\n    return {\n        tryToInit(trackingConsent) {\n            if (!currentConsent) {\n                currentConsent = trackingConsent;\n            }\n        },\n        update(trackingConsent) {\n            currentConsent = trackingConsent;\n            observable.notify();\n        },\n        isGranted() {\n            return currentConsent === TrackingConsent.GRANTED;\n        },\n        observable,\n    };\n}\n//# sourceMappingURL=trackingConsent.js.map","/**\n * Similar to `typeof`, but distinguish plain objects from `null` and arrays\n */\nexport function getType(value) {\n    if (value === null) {\n        return 'null';\n    }\n    if (Array.isArray(value)) {\n        return 'array';\n    }\n    return typeof value;\n}\n//# sourceMappingURL=typeUtils.js.map","import { display } from './display';\nimport { getType } from './utils/typeUtils';\nexport function isMatchOption(item) {\n    const itemType = getType(item);\n    return itemType === 'string' || itemType === 'function' || item instanceof RegExp;\n}\n/**\n * Returns true if value can be matched by at least one of the provided MatchOptions.\n * When comparing strings, setting useStartsWith to true will compare the value with the start of\n * the option, instead of requiring an exact match.\n */\nexport function matchList(list, value, useStartsWith = false) {\n    return list.some((item) => {\n        try {\n            if (typeof item === 'function') {\n                return item(value);\n            }\n            else if (item instanceof RegExp) {\n                return item.test(value);\n            }\n            else if (typeof item === 'string') {\n                return useStartsWith ? value.startsWith(item) : item === value;\n            }\n        }\n        catch (e) {\n            display.error(e);\n        }\n        return false;\n    });\n}\n//# sourceMappingURL=matchOption.js.map","export const EXTENSION_PREFIXES = ['chrome-extension://', 'moz-extension://'];\nexport function containsExtensionUrl(str) {\n    return EXTENSION_PREFIXES.some((prefix) => str.includes(prefix));\n}\n/**\n * Utility function to detect if the SDK is being initialized in an unsupported browser extension environment.\n *\n * @param windowLocation - The current window location to check\n * @param stack - The error stack to check for extension URLs\n * @returns true if running in an unsupported browser extension environment\n */\nexport function isUnsupportedExtensionEnvironment(windowLocation, stack = '') {\n    // If the page itself is an extension page.\n    if (containsExtensionUrl(windowLocation)) {\n        return false;\n    }\n    // Since we generate the error on the init, we check the 2nd frame line.\n    const frameLines = stack.split('\\n').filter((line) => {\n        const trimmedLine = line.trim();\n        return trimmedLine.length && /^at\\s+|@/.test(trimmedLine);\n    });\n    const target = frameLines[1] || '';\n    return containsExtensionUrl(target);\n}\n//# sourceMappingURL=extensionUtils.js.map","import { display } from '../tools/display';\nimport { matchList } from '../tools/matchOption';\nimport { isUnsupportedExtensionEnvironment } from './extension/extensionUtils';\nexport const ERROR_DOES_NOT_HAVE_ALLOWED_TRACKING_ORIGIN = 'Running the Browser SDK in a Web extension content script is forbidden unless the `allowedTrackingOrigins` option is provided.';\nexport const ERROR_NOT_ALLOWED_TRACKING_ORIGIN = 'SDK initialized on a non-allowed domain.';\nexport function isAllowedTrackingOrigins(configuration, errorStack, windowOrigin = typeof location !== 'undefined' ? location.origin : '') {\n    const allowedTrackingOrigins = configuration.allowedTrackingOrigins;\n    if (!allowedTrackingOrigins) {\n        if (isUnsupportedExtensionEnvironment(windowOrigin, errorStack)) {\n            display.error(ERROR_DOES_NOT_HAVE_ALLOWED_TRACKING_ORIGIN);\n            return false;\n        }\n        return true;\n    }\n    const isAllowed = matchList(allowedTrackingOrigins, windowOrigin);\n    if (!isAllowed) {\n        display.error(ERROR_NOT_ALLOWED_TRACKING_ORIGIN);\n    }\n    return isAllowed;\n}\n//# sourceMappingURL=allowedTrackingOrigins.js.map","export const INTAKE_SITE_STAGING = 'datad0g.com';\nexport const INTAKE_SITE_FED_STAGING = 'dd0g-gov.com';\nexport const INTAKE_SITE_US1 = 'datadoghq.com';\nexport const INTAKE_SITE_EU1 = 'datadoghq.eu';\nexport const INTAKE_SITE_US1_FED = 'ddog-gov.com';\nexport const PCI_INTAKE_HOST_US1 = 'pci.browser-intake-datadoghq.com';\nexport const INTAKE_URL_PARAMETERS = ['ddsource', 'dd-api-key', 'dd-request-id'];\n//# sourceMappingURL=intakeSites.js.map","import { timeStampNow } from '../../tools/utils/timeUtils';\nimport { normalizeUrl } from '../../tools/utils/urlPolyfill';\nimport { generateUUID } from '../../tools/utils/stringUtils';\nimport { INTAKE_SITE_FED_STAGING, INTAKE_SITE_US1, PCI_INTAKE_HOST_US1 } from '../intakeSites';\nexport function createEndpointBuilder(initConfiguration, trackType, extraParameters) {\n    const buildUrlWithParameters = createEndpointUrlWithParametersBuilder(initConfiguration, trackType);\n    return {\n        build(api, payload) {\n            const parameters = buildEndpointParameters(initConfiguration, trackType, api, payload, extraParameters);\n            return buildUrlWithParameters(parameters);\n        },\n        trackType,\n    };\n}\n/**\n * Create a function used to build a full endpoint url from provided parameters. The goal of this\n * function is to pre-compute some parts of the URL to avoid re-computing everything on every\n * request, as only parameters are changing.\n */\nfunction createEndpointUrlWithParametersBuilder(initConfiguration, trackType) {\n    const path = `/api/v2/${trackType}`;\n    const proxy = initConfiguration.proxy;\n    if (typeof proxy === 'string') {\n        const normalizedProxyUrl = normalizeUrl(proxy);\n        return (parameters) => `${normalizedProxyUrl}?ddforward=${encodeURIComponent(`${path}?${parameters}`)}`;\n    }\n    if (typeof proxy === 'function') {\n        return (parameters) => proxy({ path, parameters });\n    }\n    const host = buildEndpointHost(trackType, initConfiguration);\n    return (parameters) => `https://${host}${path}?${parameters}`;\n}\nexport function buildEndpointHost(trackType, initConfiguration) {\n    const { site = INTAKE_SITE_US1, internalAnalyticsSubdomain } = initConfiguration;\n    if (trackType === 'logs' && initConfiguration.usePciIntake && site === INTAKE_SITE_US1) {\n        return PCI_INTAKE_HOST_US1;\n    }\n    if (internalAnalyticsSubdomain && site === INTAKE_SITE_US1) {\n        return `${internalAnalyticsSubdomain}.${INTAKE_SITE_US1}`;\n    }\n    if (site === INTAKE_SITE_FED_STAGING) {\n        return `http-intake.logs.${site}`;\n    }\n    const domainParts = site.split('.');\n    const extension = domainParts.pop();\n    return `browser-intake-${domainParts.join('-')}.${extension}`;\n}\n/**\n * Build parameters to be used for an intake request. Parameters should be re-built for each\n * request, as they change randomly.\n */\nfunction buildEndpointParameters({ clientToken, internalAnalyticsSubdomain, source = 'browser' }, trackType, api, { retry, encoding }, extraParameters = []) {\n    const parameters = [\n        `ddsource=${source}`,\n        `dd-api-key=${clientToken}`,\n        `dd-evp-origin-version=${encodeURIComponent(\"6.24.1\")}`,\n        'dd-evp-origin=browser',\n        `dd-request-id=${generateUUID()}`,\n    ].concat(extraParameters);\n    if (encoding) {\n        parameters.push(`dd-evp-encoding=${encoding}`);\n    }\n    if (trackType === 'rum') {\n        parameters.push(`batch_time=${timeStampNow()}`, `_dd.api=${api}`);\n        if (retry) {\n            parameters.push(`_dd.retry_count=${retry.count}`, `_dd.retry_after=${retry.lastFailureStatus}`);\n        }\n    }\n    if (internalAnalyticsSubdomain) {\n        parameters.reverse();\n    }\n    return parameters.join('&');\n}\n//# sourceMappingURL=endpointBuilder.js.map","import { INTAKE_SITE_US1, INTAKE_URL_PARAMETERS } from '../intakeSites';\nimport { createEndpointBuilder } from './endpointBuilder';\nexport function computeTransportConfiguration(initConfiguration) {\n    const site = initConfiguration.site || INTAKE_SITE_US1;\n    const source = validateSource(initConfiguration.source);\n    const endpointBuilders = computeEndpointBuilders({ ...initConfiguration, site, source });\n    const replicaConfiguration = computeReplicaConfiguration({ ...initConfiguration, site, source });\n    return {\n        replica: replicaConfiguration,\n        site,\n        source,\n        ...endpointBuilders,\n    };\n}\nfunction validateSource(source) {\n    if (source === 'flutter' || source === 'unity') {\n        return source;\n    }\n    return 'browser';\n}\nfunction computeEndpointBuilders(initConfiguration) {\n    return {\n        logsEndpointBuilder: createEndpointBuilder(initConfiguration, 'logs'),\n        rumEndpointBuilder: createEndpointBuilder(initConfiguration, 'rum'),\n        profilingEndpointBuilder: createEndpointBuilder(initConfiguration, 'profile'),\n        sessionReplayEndpointBuilder: createEndpointBuilder(initConfiguration, 'replay'),\n        exposuresEndpointBuilder: createEndpointBuilder(initConfiguration, 'exposures'),\n    };\n}\nfunction computeReplicaConfiguration(initConfiguration) {\n    if (!initConfiguration.replica) {\n        return;\n    }\n    const replicaConfiguration = {\n        ...initConfiguration,\n        site: INTAKE_SITE_US1,\n        clientToken: initConfiguration.replica.clientToken,\n    };\n    return {\n        logsEndpointBuilder: createEndpointBuilder(replicaConfiguration, 'logs'),\n        rumEndpointBuilder: createEndpointBuilder(replicaConfiguration, 'rum', [\n            `application.id=${initConfiguration.replica.applicationId}`,\n        ]),\n    };\n}\nexport function isIntakeUrl(url) {\n    // check if tags is present in the query string\n    return INTAKE_URL_PARAMETERS.every((param) => url.includes(param));\n}\n//# sourceMappingURL=transportConfiguration.js.map","import { catchUserErrors } from '../../tools/catchUserErrors';\nimport { DOCS_ORIGIN, MORE_DETAILS, display } from '../../tools/display';\nimport { isPercentage } from '../../tools/utils/numberUtils';\nimport { objectHasValue } from '../../tools/utils/objectUtils';\nimport { selectSessionStoreStrategyType } from '../session/sessionStore';\nimport { TrackingConsent } from '../trackingConsent';\nimport { isAllowedTrackingOrigins } from '../allowedTrackingOrigins';\nimport { isWorkerEnvironment } from '../../tools/globalObject';\nimport { computeTransportConfiguration } from './transportConfiguration';\n/**\n * Default privacy level for the browser SDK.\n *\n * [Replay Privacy Options](https://docs.datadoghq.com/real_user_monitoring/session_replay/browser/privacy_options) for further information.\n */\nexport const DefaultPrivacyLevel = {\n    ALLOW: 'allow',\n    MASK: 'mask',\n    MASK_USER_INPUT: 'mask-user-input',\n    MASK_UNLESS_ALLOWLISTED: 'mask-unless-allowlisted',\n};\n/**\n * Trace context injection option.\n *\n * See [Connect RUM and Traces](https://docs.datadoghq.com/real_user_monitoring/platform/connect_rum_and_traces/?tab=browserrum) for further information.\n */\nexport const TraceContextInjection = {\n    ALL: 'all',\n    SAMPLED: 'sampled',\n};\nfunction isString(tag, tagName) {\n    if (tag !== undefined && tag !== null && typeof tag !== 'string') {\n        display.error(`${tagName} must be defined as a string`);\n        return false;\n    }\n    return true;\n}\nfunction isDatadogSite(site) {\n    if (site && typeof site === 'string' && !/(datadog|ddog|datad0g|dd0g)/.test(site)) {\n        display.error(`Site should be a valid Datadog site. ${MORE_DETAILS} ${DOCS_ORIGIN}/getting_started/site/.`);\n        return false;\n    }\n    return true;\n}\nexport function isSampleRate(sampleRate, name) {\n    if (sampleRate !== undefined && !isPercentage(sampleRate)) {\n        display.error(`${name} Sample Rate should be a number between 0 and 100`);\n        return false;\n    }\n    return true;\n}\nexport function validateAndBuildConfiguration(initConfiguration, errorStack) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n    if (!initConfiguration || !initConfiguration.clientToken) {\n        display.error('Client Token is not configured, we will not send any data.');\n        return;\n    }\n    if (initConfiguration.allowedTrackingOrigins !== undefined &&\n        !Array.isArray(initConfiguration.allowedTrackingOrigins)) {\n        display.error('Allowed Tracking Origins must be an array');\n        return;\n    }\n    if (!isDatadogSite(initConfiguration.site) ||\n        !isSampleRate(initConfiguration.sessionSampleRate, 'Session') ||\n        !isSampleRate(initConfiguration.telemetrySampleRate, 'Telemetry') ||\n        !isSampleRate(initConfiguration.telemetryConfigurationSampleRate, 'Telemetry Configuration') ||\n        !isSampleRate(initConfiguration.telemetryUsageSampleRate, 'Telemetry Usage') ||\n        !isString(initConfiguration.version, 'Version') ||\n        !isString(initConfiguration.env, 'Env') ||\n        !isString(initConfiguration.service, 'Service') ||\n        !isAllowedTrackingOrigins(initConfiguration, errorStack !== null && errorStack !== void 0 ? errorStack : '')) {\n        return;\n    }\n    if (initConfiguration.trackingConsent !== undefined &&\n        !objectHasValue(TrackingConsent, initConfiguration.trackingConsent)) {\n        display.error('Tracking Consent should be either \"granted\" or \"not-granted\"');\n        return;\n    }\n    return {\n        beforeSend: initConfiguration.beforeSend && catchUserErrors(initConfiguration.beforeSend, 'beforeSend threw an error:'),\n        sessionStoreStrategyType: isWorkerEnvironment ? undefined : selectSessionStoreStrategyType(initConfiguration),\n        sessionSampleRate: (_a = initConfiguration.sessionSampleRate) !== null && _a !== void 0 ? _a : 100,\n        telemetrySampleRate: (_b = initConfiguration.telemetrySampleRate) !== null && _b !== void 0 ? _b : 20,\n        telemetryConfigurationSampleRate: (_c = initConfiguration.telemetryConfigurationSampleRate) !== null && _c !== void 0 ? _c : 5,\n        telemetryUsageSampleRate: (_d = initConfiguration.telemetryUsageSampleRate) !== null && _d !== void 0 ? _d : 5,\n        service: (_e = initConfiguration.service) !== null && _e !== void 0 ? _e : undefined,\n        env: (_f = initConfiguration.env) !== null && _f !== void 0 ? _f : undefined,\n        version: (_g = initConfiguration.version) !== null && _g !== void 0 ? _g : undefined,\n        datacenter: (_h = initConfiguration.datacenter) !== null && _h !== void 0 ? _h : undefined,\n        silentMultipleInit: !!initConfiguration.silentMultipleInit,\n        allowUntrustedEvents: !!initConfiguration.allowUntrustedEvents,\n        trackingConsent: (_j = initConfiguration.trackingConsent) !== null && _j !== void 0 ? _j : TrackingConsent.GRANTED,\n        trackAnonymousUser: (_k = initConfiguration.trackAnonymousUser) !== null && _k !== void 0 ? _k : true,\n        storeContextsAcrossPages: !!initConfiguration.storeContextsAcrossPages,\n        betaEncodeCookieOptions: !!initConfiguration.betaEncodeCookieOptions,\n        /**\n         * The source of the SDK, used for support plugins purposes.\n         */\n        variant: initConfiguration.variant,\n        sdkVersion: initConfiguration.sdkVersion,\n        ...computeTransportConfiguration(initConfiguration),\n    };\n}\nexport function serializeConfiguration(initConfiguration) {\n    return {\n        session_sample_rate: initConfiguration.sessionSampleRate,\n        telemetry_sample_rate: initConfiguration.telemetrySampleRate,\n        telemetry_configuration_sample_rate: initConfiguration.telemetryConfigurationSampleRate,\n        telemetry_usage_sample_rate: initConfiguration.telemetryUsageSampleRate,\n        use_before_send: !!initConfiguration.beforeSend,\n        use_partitioned_cross_site_session_cookie: initConfiguration.usePartitionedCrossSiteSessionCookie,\n        use_secure_session_cookie: initConfiguration.useSecureSessionCookie,\n        use_proxy: !!initConfiguration.proxy,\n        silent_multiple_init: initConfiguration.silentMultipleInit,\n        track_session_across_subdomains: initConfiguration.trackSessionAcrossSubdomains,\n        track_anonymous_user: initConfiguration.trackAnonymousUser,\n        session_persistence: initConfiguration.sessionPersistence,\n        allow_fallback_to_local_storage: !!initConfiguration.allowFallbackToLocalStorage,\n        store_contexts_across_pages: !!initConfiguration.storeContextsAcrossPages,\n        allow_untrusted_events: !!initConfiguration.allowUntrustedEvents,\n        tracking_consent: initConfiguration.trackingConsent,\n        use_allowed_tracking_origins: Array.isArray(initConfiguration.allowedTrackingOrigins),\n        beta_encode_cookie_options: initConfiguration.betaEncodeCookieOptions,\n        source: initConfiguration.source,\n        sdk_version: initConfiguration.sdkVersion,\n        variant: initConfiguration.variant,\n    };\n}\n//# sourceMappingURL=configuration.js.map","/**\n * LIMITATION:\n * For NPM setup, this feature flag singleton is shared between RUM and Logs product.\n * This means that an experimental flag set on the RUM product will be set on the Logs product.\n * So keep in mind that in certain configurations, your experimental feature flag may affect other products.\n *\n * FORMAT:\n * All feature flags should be snake_cased\n */\n// We want to use a real enum (i.e. not a const enum) here, to be able to check whether an arbitrary\n// string is an expected feature flag\nimport { objectHasValue } from './utils/objectUtils';\n// eslint-disable-next-line no-restricted-syntax\nexport var ExperimentalFeature;\n(function (ExperimentalFeature) {\n    ExperimentalFeature[\"TRACK_INTAKE_REQUESTS\"] = \"track_intake_requests\";\n    ExperimentalFeature[\"USE_TREE_WALKER_FOR_ACTION_NAME\"] = \"use_tree_walker_for_action_name\";\n    ExperimentalFeature[\"FEATURE_OPERATION_VITAL\"] = \"feature_operation_vital\";\n    ExperimentalFeature[\"SHORT_SESSION_INVESTIGATION\"] = \"short_session_investigation\";\n    ExperimentalFeature[\"AVOID_FETCH_KEEPALIVE\"] = \"avoid_fetch_keepalive\";\n})(ExperimentalFeature || (ExperimentalFeature = {}));\nconst enabledExperimentalFeatures = new Set();\nexport function initFeatureFlags(enableExperimentalFeatures) {\n    if (Array.isArray(enableExperimentalFeatures)) {\n        addExperimentalFeatures(enableExperimentalFeatures.filter((flag) => objectHasValue(ExperimentalFeature, flag)));\n    }\n}\nexport function addExperimentalFeatures(enabledFeatures) {\n    enabledFeatures.forEach((flag) => {\n        enabledExperimentalFeatures.add(flag);\n    });\n}\nexport function isExperimentalFeatureEnabled(featureName) {\n    return enabledExperimentalFeatures.has(featureName);\n}\nexport function resetExperimentalFeatures() {\n    enabledExperimentalFeatures.clear();\n}\nexport function getExperimentalFeatures() {\n    return enabledExperimentalFeatures;\n}\n//# sourceMappingURL=experimentalFeatures.js.map","/**\n * Cross-browser stack trace computation.\n *\n * Reference implementation: https://github.com/csnover/TraceKit/blob/04530298073c3823de72deb0b97e7b38ca7bcb59/tracekit.js\n */\nconst UNKNOWN_FUNCTION = '?';\nexport function computeStackTrace(ex) {\n    var _a, _b;\n    const stack = [];\n    let stackProperty = tryToGetString(ex, 'stack');\n    const exString = String(ex);\n    if (stackProperty && stackProperty.startsWith(exString)) {\n        stackProperty = stackProperty.slice(exString.length);\n    }\n    if (stackProperty) {\n        stackProperty.split('\\n').forEach((line) => {\n            const stackFrame = parseChromeLine(line) || parseChromeAnonymousLine(line) || parseWinLine(line) || parseGeckoLine(line);\n            if (stackFrame) {\n                if (!stackFrame.func && stackFrame.line) {\n                    stackFrame.func = UNKNOWN_FUNCTION;\n                }\n                stack.push(stackFrame);\n            }\n        });\n    }\n    if (stack.length > 0 && isWronglyReportingCustomErrors() && ex instanceof Error) {\n        // if we are wrongly reporting custom errors\n        const constructors = [];\n        // go through each inherited constructor\n        let currentPrototype = ex;\n        while ((currentPrototype = Object.getPrototypeOf(currentPrototype)) &&\n            isNonNativeClassPrototype(currentPrototype)) {\n            const constructorName = ((_a = currentPrototype.constructor) === null || _a === void 0 ? void 0 : _a.name) || UNKNOWN_FUNCTION;\n            constructors.push(constructorName);\n        }\n        // traverse the stacktrace in reverse order because the stacktrace starts with the last inherited constructor\n        // we check constructor names to ensure we remove the correct frame (and there isn't a weird unsupported environment behavior)\n        for (let i = constructors.length - 1; i >= 0 && ((_b = stack[0]) === null || _b === void 0 ? void 0 : _b.func) === constructors[i]; i--) {\n            // if the first stack frame is the custom error constructor\n            // null stack frames may represent frames that failed to be parsed because the error class did not have a constructor\n            stack.shift(); // remove it\n        }\n    }\n    return {\n        message: tryToGetString(ex, 'message'),\n        name: tryToGetString(ex, 'name'),\n        stack,\n    };\n}\nconst fileUrl = '((?:file|https?|blob|chrome-extension|electron|native|eval|webpack|snippet|<anonymous>|\\\\w+\\\\.|\\\\/).*?)';\nconst filePosition = '(?::(\\\\d+))';\nconst CHROME_LINE_RE = new RegExp(`^\\\\s*at (.*?) ?\\\\(${fileUrl}${filePosition}?${filePosition}?\\\\)?\\\\s*$`, 'i');\nconst CHROME_EVAL_RE = new RegExp(`\\\\((\\\\S*)${filePosition}${filePosition}\\\\)`);\nfunction parseChromeLine(line) {\n    const parts = CHROME_LINE_RE.exec(line);\n    if (!parts) {\n        return;\n    }\n    const isNative = parts[2] && parts[2].indexOf('native') === 0; // start of line\n    const isEval = parts[2] && parts[2].indexOf('eval') === 0; // start of line\n    const submatch = CHROME_EVAL_RE.exec(parts[2]);\n    if (isEval && submatch) {\n        // throw out eval line/column and use top-most line/column number\n        parts[2] = submatch[1]; // url\n        parts[3] = submatch[2]; // line\n        parts[4] = submatch[3]; // column\n    }\n    return {\n        args: isNative ? [parts[2]] : [],\n        column: parts[4] ? +parts[4] : undefined,\n        func: parts[1] || UNKNOWN_FUNCTION,\n        line: parts[3] ? +parts[3] : undefined,\n        url: !isNative ? parts[2] : undefined,\n    };\n}\nconst CHROME_ANONYMOUS_FUNCTION_RE = new RegExp(`^\\\\s*at ?${fileUrl}${filePosition}?${filePosition}??\\\\s*$`, 'i');\nfunction parseChromeAnonymousLine(line) {\n    const parts = CHROME_ANONYMOUS_FUNCTION_RE.exec(line);\n    if (!parts) {\n        return;\n    }\n    return {\n        args: [],\n        column: parts[3] ? +parts[3] : undefined,\n        func: UNKNOWN_FUNCTION,\n        line: parts[2] ? +parts[2] : undefined,\n        url: parts[1],\n    };\n}\nconst WINJS_LINE_RE = /^\\s*at (?:((?:\\[object object\\])?.+) )?\\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\\d+)(?::(\\d+))?\\)?\\s*$/i;\nfunction parseWinLine(line) {\n    const parts = WINJS_LINE_RE.exec(line);\n    if (!parts) {\n        return;\n    }\n    return {\n        args: [],\n        column: parts[4] ? +parts[4] : undefined,\n        func: parts[1] || UNKNOWN_FUNCTION,\n        line: +parts[3],\n        url: parts[2],\n    };\n}\nconst GECKO_LINE_RE = /^\\s*(.*?)(?:\\((.*?)\\))?(?:(?:(?:^|@)((?:file|https?|blob|chrome|webpack|resource|capacitor|\\[native).*?|[^@]*bundle|\\[wasm code\\])(?::(\\d+))?(?::(\\d+))?)|@)\\s*$/i;\nconst GECKO_EVAL_RE = /(\\S+) line (\\d+)(?: > eval line \\d+)* > eval/i;\nfunction parseGeckoLine(line) {\n    const parts = GECKO_LINE_RE.exec(line);\n    if (!parts) {\n        return;\n    }\n    const isEval = parts[3] && parts[3].indexOf(' > eval') > -1;\n    const submatch = GECKO_EVAL_RE.exec(parts[3]);\n    if (isEval && submatch) {\n        // throw out eval line/column and use top-most line number\n        parts[3] = submatch[1];\n        parts[4] = submatch[2];\n        parts[5] = undefined; // no column when eval\n    }\n    return {\n        args: parts[2] ? parts[2].split(',') : [],\n        column: parts[5] ? +parts[5] : undefined,\n        func: parts[1] || UNKNOWN_FUNCTION,\n        line: parts[4] ? +parts[4] : undefined,\n        url: parts[3],\n    };\n}\nfunction tryToGetString(candidate, property) {\n    if (typeof candidate !== 'object' || !candidate || !(property in candidate)) {\n        return undefined;\n    }\n    const value = candidate[property];\n    return typeof value === 'string' ? value : undefined;\n}\nexport function computeStackTraceFromOnErrorMessage(messageObj, url, line, column) {\n    if (url === undefined) {\n        return;\n    }\n    const { name, message } = tryToParseMessage(messageObj);\n    return {\n        name,\n        message,\n        stack: [{ url, column, line }],\n    };\n}\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Error_types\nconst ERROR_TYPES_RE = /^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?([\\s\\S]*)$/;\nfunction tryToParseMessage(messageObj) {\n    let name;\n    let message;\n    if ({}.toString.call(messageObj) === '[object String]') {\n        ;\n        [, name, message] = ERROR_TYPES_RE.exec(messageObj);\n    }\n    return { name, message };\n}\n// Custom error stacktrace fix\n// Some browsers (safari/firefox) add the error constructor as a frame in the stacktrace\n// In order to normalize the stacktrace, we need to remove it\nfunction isNonNativeClassPrototype(prototype) {\n    return String(prototype.constructor).startsWith('class ');\n}\nlet isWronglyReportingCustomErrorsCache;\nfunction isWronglyReportingCustomErrors() {\n    if (isWronglyReportingCustomErrorsCache !== undefined) {\n        return isWronglyReportingCustomErrorsCache;\n    }\n    /* eslint-disable no-restricted-syntax */\n    class DatadogTestCustomError extends Error {\n        constructor() {\n            super();\n            this.name = 'Error'; // set name to Error so that no browser would default to the constructor name\n        }\n    }\n    const [customError, nativeError] = [DatadogTestCustomError, Error].map((errConstructor) => new errConstructor()); // so that both errors should exactly have the same stacktrace\n    isWronglyReportingCustomErrorsCache =\n        // If customError is not a class, it means that this was built with ES5 as target, converting the class to a normal object.\n        // Thus, error constructors will be reported on all browsers, which is the expected behavior.\n        isNonNativeClassPrototype(Object.getPrototypeOf(customError)) &&\n            // If the browser is correctly reporting the stacktrace, the normal error stacktrace should be the same as the custom error stacktrace\n            nativeError.stack !== customError.stack;\n    return isWronglyReportingCustomErrorsCache;\n}\n//# sourceMappingURL=computeStackTrace.js.map","import { callMonitored } from '../monitor';\nimport { computeStackTrace } from './computeStackTrace';\n/**\n * Creates a stacktrace without SDK internal frames.\n * Constraints:\n * - Has to be called at the utmost position of the call stack.\n * - No monitored function should encapsulate it, that is why we need to use callMonitored inside it.\n */\nexport function createHandlingStack(type) {\n    /**\n     * Skip the two internal frames:\n     * - SDK API (console.error, ...)\n     * - this function\n     * in order to keep only the user calls\n     */\n    const internalFramesToSkip = 2;\n    const error = new Error(type);\n    error.name = 'HandlingStack';\n    let formattedStack;\n    callMonitored(() => {\n        const stackTrace = computeStackTrace(error);\n        stackTrace.stack = stackTrace.stack.slice(internalFramesToSkip);\n        formattedStack = toStackTraceString(stackTrace);\n    });\n    return formattedStack;\n}\nexport function toStackTraceString(stack) {\n    let result = formatErrorMessage(stack);\n    stack.stack.forEach((frame) => {\n        const func = frame.func === '?' ? '<anonymous>' : frame.func;\n        const args = frame.args && frame.args.length > 0 ? `(${frame.args.join(', ')})` : '';\n        const line = frame.line ? `:${frame.line}` : '';\n        const column = frame.line && frame.column ? `:${frame.column}` : '';\n        result += `\\n  at ${func}${args} @ ${frame.url}${line}${column}`;\n    });\n    return result;\n}\nexport function formatErrorMessage(stack) {\n    return `${stack.name || 'Error'}: ${stack.message}`;\n}\n//# sourceMappingURL=handlingStack.js.map","export const ONE_KIBI_BYTE = 1024;\nexport const ONE_MEBI_BYTE = 1024 * ONE_KIBI_BYTE;\n// eslint-disable-next-line no-control-regex\nconst HAS_MULTI_BYTES_CHARACTERS = /[^\\u0000-\\u007F]/;\nexport function computeBytesCount(candidate) {\n    // Accurate bytes count computations can degrade performances when there is a lot of events to process\n    if (!HAS_MULTI_BYTES_CHARACTERS.test(candidate)) {\n        return candidate.length;\n    }\n    if (window.TextEncoder !== undefined) {\n        return new TextEncoder().encode(candidate).length;\n    }\n    return new Blob([candidate]).size;\n}\nexport function concatBuffers(buffers) {\n    // Optimization: if there is a single buffer, no need to copy it\n    if (buffers.length === 1) {\n        return buffers[0];\n    }\n    const length = buffers.reduce((total, buffer) => total + buffer.length, 0);\n    const result = new Uint8Array(length);\n    let offset = 0;\n    for (const buffer of buffers) {\n        result.set(buffer, offset);\n        offset += buffer.length;\n    }\n    return result;\n}\n//# sourceMappingURL=byteUtils.js.map","import { noop } from '../utils/functionUtils';\n/**\n * Custom implementation of JSON.stringify that ignores some toJSON methods. We need to do that\n * because some sites badly override toJSON on certain objects. Removing all toJSON methods from\n * nested values would be too costly, so we just detach them from the root value, and native classes\n * used to build JSON values (Array and Object).\n *\n * Note: this still assumes that JSON.stringify is correct.\n */\nexport function jsonStringify(value, replacer, space) {\n    if (typeof value !== 'object' || value === null) {\n        return JSON.stringify(value);\n    }\n    // Note: The order matter here. We need to detach toJSON methods on parent classes before their\n    // subclasses.\n    const restoreObjectPrototypeToJson = detachToJsonMethod(Object.prototype);\n    const restoreArrayPrototypeToJson = detachToJsonMethod(Array.prototype);\n    const restoreValuePrototypeToJson = detachToJsonMethod(Object.getPrototypeOf(value));\n    const restoreValueToJson = detachToJsonMethod(value);\n    try {\n        return JSON.stringify(value, replacer, space);\n    }\n    catch (_a) {\n        return '<error: unable to serialize object>';\n    }\n    finally {\n        restoreObjectPrototypeToJson();\n        restoreArrayPrototypeToJson();\n        restoreValuePrototypeToJson();\n        restoreValueToJson();\n    }\n}\nexport function detachToJsonMethod(value) {\n    const object = value;\n    const objectToJson = object.toJSON;\n    if (objectToJson) {\n        delete object.toJSON;\n        return () => {\n            object.toJSON = objectToJson;\n        };\n    }\n    return noop;\n}\n//# sourceMappingURL=jsonStringify.js.map","import { display } from '../display';\nimport { ONE_KIBI_BYTE } from '../utils/byteUtils';\nimport { detachToJsonMethod } from './jsonStringify';\n// The maximum size of a single event is 256KiB. By default, we ensure that user-provided data\n// going through sanitize fits inside our events, while leaving room for other contexts, metadata, ...\nconst SANITIZE_DEFAULT_MAX_CHARACTER_COUNT = 220 * ONE_KIBI_BYTE;\n// Symbol for the root element of the JSONPath used for visited objects\nconst JSON_PATH_ROOT_ELEMENT = '$';\n// When serializing (using JSON.stringify) a key of an object, { key: 42 } gets wrapped in quotes as \"key\".\n// With the separator (:), we need to add 3 characters to the count.\nconst KEY_DECORATION_LENGTH = 3;\nexport function sanitize(source, maxCharacterCount = SANITIZE_DEFAULT_MAX_CHARACTER_COUNT) {\n    // Unbind any toJSON function we may have on [] or {} prototypes\n    const restoreObjectPrototypeToJson = detachToJsonMethod(Object.prototype);\n    const restoreArrayPrototypeToJson = detachToJsonMethod(Array.prototype);\n    // Initial call to sanitizeProcessor - will populate containerQueue if source is an Array or a plain Object\n    const containerQueue = [];\n    const visitedObjectsWithPath = new WeakMap();\n    const sanitizedData = sanitizeProcessor(source, JSON_PATH_ROOT_ELEMENT, undefined, containerQueue, visitedObjectsWithPath);\n    const serializedSanitizedData = JSON.stringify(sanitizedData);\n    let accumulatedCharacterCount = serializedSanitizedData ? serializedSanitizedData.length : 0;\n    if (accumulatedCharacterCount > maxCharacterCount) {\n        warnOverCharacterLimit(maxCharacterCount, 'discarded', source);\n        return undefined;\n    }\n    while (containerQueue.length > 0 && accumulatedCharacterCount < maxCharacterCount) {\n        const containerToProcess = containerQueue.shift();\n        let separatorLength = 0; // 0 for the first element, 1 for subsequent elements\n        // Arrays and Objects have to be handled distinctly to ensure\n        // we do not pick up non-numerical properties from Arrays\n        if (Array.isArray(containerToProcess.source)) {\n            for (let key = 0; key < containerToProcess.source.length; key++) {\n                const targetData = sanitizeProcessor(containerToProcess.source[key], containerToProcess.path, key, containerQueue, visitedObjectsWithPath);\n                if (targetData !== undefined) {\n                    accumulatedCharacterCount += JSON.stringify(targetData).length;\n                }\n                else {\n                    // When an element of an Array (targetData) is undefined, it is serialized as null:\n                    // JSON.stringify([undefined]) => '[null]' - This accounts for 4 characters\n                    accumulatedCharacterCount += 4;\n                }\n                accumulatedCharacterCount += separatorLength;\n                separatorLength = 1;\n                if (accumulatedCharacterCount > maxCharacterCount) {\n                    warnOverCharacterLimit(maxCharacterCount, 'truncated', source);\n                    break;\n                }\n                ;\n                containerToProcess.target[key] = targetData;\n            }\n        }\n        else {\n            for (const key in containerToProcess.source) {\n                if (Object.prototype.hasOwnProperty.call(containerToProcess.source, key)) {\n                    const targetData = sanitizeProcessor(containerToProcess.source[key], containerToProcess.path, key, containerQueue, visitedObjectsWithPath);\n                    // When a property of an object has an undefined value, it will be dropped during serialization:\n                    // JSON.stringify({a:undefined}) => '{}'\n                    if (targetData !== undefined) {\n                        accumulatedCharacterCount +=\n                            JSON.stringify(targetData).length + separatorLength + key.length + KEY_DECORATION_LENGTH;\n                        separatorLength = 1;\n                    }\n                    if (accumulatedCharacterCount > maxCharacterCount) {\n                        warnOverCharacterLimit(maxCharacterCount, 'truncated', source);\n                        break;\n                    }\n                    ;\n                    containerToProcess.target[key] = targetData;\n                }\n            }\n        }\n    }\n    // Rebind detached toJSON functions\n    restoreObjectPrototypeToJson();\n    restoreArrayPrototypeToJson();\n    return sanitizedData;\n}\n/**\n * Internal function to factorize the process common to the\n * initial call to sanitize, and iterations for Arrays and Objects\n *\n */\nfunction sanitizeProcessor(source, parentPath, key, queue, visitedObjectsWithPath) {\n    // Start by handling toJSON, as we want to sanitize its output\n    const sourceToSanitize = tryToApplyToJSON(source);\n    if (!sourceToSanitize || typeof sourceToSanitize !== 'object') {\n        return sanitizePrimitivesAndFunctions(sourceToSanitize);\n    }\n    const sanitizedSource = sanitizeObjects(sourceToSanitize);\n    if (sanitizedSource !== '[Object]' && sanitizedSource !== '[Array]' && sanitizedSource !== '[Error]') {\n        return sanitizedSource;\n    }\n    // Handle potential cyclic references\n    // We need to use source as sourceToSanitize could be a reference to a new object\n    // At this stage, we know the source is an object type\n    const sourceAsObject = source;\n    if (visitedObjectsWithPath.has(sourceAsObject)) {\n        return `[Reference seen at ${visitedObjectsWithPath.get(sourceAsObject)}]`;\n    }\n    // Add processed source to queue\n    const currentPath = key !== undefined ? `${parentPath}.${key}` : parentPath;\n    const target = Array.isArray(sourceToSanitize) ? [] : {};\n    visitedObjectsWithPath.set(sourceAsObject, currentPath);\n    queue.push({ source: sourceToSanitize, target, path: currentPath });\n    return target;\n}\n/**\n * Handles sanitization of simple, non-object types\n *\n */\nfunction sanitizePrimitivesAndFunctions(value) {\n    // BigInt cannot be serialized by JSON.stringify(), convert it to a string representation\n    if (typeof value === 'bigint') {\n        return `[BigInt] ${value.toString()}`;\n    }\n    // Functions cannot be serialized by JSON.stringify(). Moreover, if a faulty toJSON is present, it needs to be converted\n    // so it won't prevent stringify from serializing later\n    if (typeof value === 'function') {\n        return `[Function] ${value.name || 'unknown'}`;\n    }\n    // JSON.stringify() does not serialize symbols.\n    if (typeof value === 'symbol') {\n        return `[Symbol] ${value.description || value.toString()}`;\n    }\n    return value;\n}\n/**\n * Handles sanitization of object types\n *\n * LIMITATIONS\n * - If a class defines a toStringTag Symbol, it will fall in the catch-all method and prevent enumeration of properties.\n * To avoid this, a toJSON method can be defined.\n */\nfunction sanitizeObjects(value) {\n    try {\n        if (value instanceof Event) {\n            return sanitizeEvent(value);\n        }\n        if (value instanceof RegExp) {\n            return `[RegExp] ${value.toString()}`;\n        }\n        // Handle all remaining object types in a generic way\n        const result = Object.prototype.toString.call(value);\n        const match = result.match(/\\[object (.*)\\]/);\n        if (match && match[1]) {\n            return `[${match[1]}]`;\n        }\n    }\n    catch (_a) {\n        // If the previous serialization attempts failed, and we cannot convert using\n        // Object.prototype.toString, declare the value unserializable\n    }\n    return '[Unserializable]';\n}\nfunction sanitizeEvent(event) {\n    return {\n        type: event.type,\n        isTrusted: event.isTrusted,\n        currentTarget: event.currentTarget ? sanitizeObjects(event.currentTarget) : null,\n        target: event.target ? sanitizeObjects(event.target) : null,\n    };\n}\n/**\n * Checks if a toJSON function exists and tries to execute it\n *\n */\nfunction tryToApplyToJSON(value) {\n    const object = value;\n    if (object && typeof object.toJSON === 'function') {\n        try {\n            return object.toJSON();\n        }\n        catch (_a) {\n            // If toJSON fails, we continue by trying to serialize the value manually\n        }\n    }\n    return value;\n}\n/**\n * Helper function to display the warning when the accumulated character count is over the limit\n */\nfunction warnOverCharacterLimit(maxCharacterCount, changeType, source) {\n    display.warn(`The data provided has been ${changeType} as it is over the limit of ${maxCharacterCount} characters:`, source);\n}\n//# sourceMappingURL=sanitize.js.map","import { sanitize } from '../../tools/serialisation/sanitize';\nimport { jsonStringify } from '../../tools/serialisation/jsonStringify';\nimport { computeStackTrace } from '../../tools/stackTrace/computeStackTrace';\nimport { toStackTraceString } from '../../tools/stackTrace/handlingStack';\nexport const NO_ERROR_STACK_PRESENT_MESSAGE = 'No stack, consider using an instance of Error';\nexport function computeRawError({ stackTrace, originalError, handlingStack, componentStack, startClocks, nonErrorPrefix, useFallbackStack = true, source, handling, }) {\n    const isErrorInstance = isError(originalError);\n    if (!stackTrace && isErrorInstance) {\n        stackTrace = computeStackTrace(originalError);\n    }\n    return {\n        startClocks,\n        source,\n        handling,\n        handlingStack,\n        componentStack,\n        originalError,\n        type: stackTrace ? stackTrace.name : undefined,\n        message: computeMessage(stackTrace, isErrorInstance, nonErrorPrefix, originalError),\n        stack: stackTrace ? toStackTraceString(stackTrace) : useFallbackStack ? NO_ERROR_STACK_PRESENT_MESSAGE : undefined,\n        causes: isErrorInstance ? flattenErrorCauses(originalError, source) : undefined,\n        fingerprint: tryToGetFingerprint(originalError),\n        context: tryToGetErrorContext(originalError),\n    };\n}\nfunction computeMessage(stackTrace, isErrorInstance, nonErrorPrefix, originalError) {\n    // Favor stackTrace message only if tracekit has really been able to extract something meaningful (message + name)\n    // TODO rework tracekit integration to avoid scattering error building logic\n    return (stackTrace === null || stackTrace === void 0 ? void 0 : stackTrace.message) && (stackTrace === null || stackTrace === void 0 ? void 0 : stackTrace.name)\n        ? stackTrace.message\n        : !isErrorInstance\n            ? `${nonErrorPrefix} ${jsonStringify(sanitize(originalError))}`\n            : 'Empty message';\n}\nexport function tryToGetFingerprint(originalError) {\n    return isError(originalError) && 'dd_fingerprint' in originalError ? String(originalError.dd_fingerprint) : undefined;\n}\nexport function tryToGetErrorContext(originalError) {\n    if (originalError !== null && typeof originalError === 'object' && 'dd_context' in originalError) {\n        return originalError.dd_context;\n    }\n}\nexport function getFileFromStackTraceString(stack) {\n    var _a;\n    return (_a = /@ (.+)/.exec(stack)) === null || _a === void 0 ? void 0 : _a[1];\n}\nexport function isError(error) {\n    return error instanceof Error || Object.prototype.toString.call(error) === '[object Error]';\n}\nexport function flattenErrorCauses(error, parentSource) {\n    let currentError = error;\n    const causes = [];\n    while (isError(currentError === null || currentError === void 0 ? void 0 : currentError.cause) && causes.length < 10) {\n        const stackTrace = computeStackTrace(currentError.cause);\n        causes.push({\n            message: currentError.cause.message,\n            source: parentSource,\n            type: stackTrace === null || stackTrace === void 0 ? void 0 : stackTrace.name,\n            stack: stackTrace && toStackTraceString(stackTrace),\n        });\n        currentError = currentError.cause;\n    }\n    return causes.length ? causes : undefined;\n}\n//# sourceMappingURL=error.js.map","export const ErrorSource = {\n    AGENT: 'agent',\n    CONSOLE: 'console',\n    CUSTOM: 'custom',\n    LOGGER: 'logger',\n    NETWORK: 'network',\n    SOURCE: 'source',\n    REPORT: 'report',\n};\n//# sourceMappingURL=error.types.js.map","import { monitor } from '../tools/monitor';\nimport { getZoneJsOriginalValue } from '../tools/getZoneJsOriginalValue';\n/**\n * Add an event listener to an event target object (Window, Element, mock object...).  This provides\n * a few conveniences compared to using `element.addEventListener` directly:\n *\n * * supports IE11 by: using an option object only if needed and emulating the `once` option\n *\n * * wraps the listener with a `monitor` function\n *\n * * returns a `stop` function to remove the listener\n */\nexport function addEventListener(configuration, eventTarget, eventName, listener, options) {\n    return addEventListeners(configuration, eventTarget, [eventName], listener, options);\n}\n/**\n * Add event listeners to an event target object (Window, Element, mock object...).  This provides\n * a few conveniences compared to using `element.addEventListener` directly:\n *\n * * supports IE11 by: using an option object only if needed and emulating the `once` option\n *\n * * wraps the listener with a `monitor` function\n *\n * * returns a `stop` function to remove the listener\n *\n * * with `once: true`, the listener will be called at most once, even if different events are listened\n */\nexport function addEventListeners(configuration, eventTarget, eventNames, listener, { once, capture, passive } = {}) {\n    const listenerWithMonitor = monitor((event) => {\n        if (!event.isTrusted && !event.__ddIsTrusted && !configuration.allowUntrustedEvents) {\n            return;\n        }\n        if (once) {\n            stop();\n        }\n        listener(event);\n    });\n    const options = passive ? { capture, passive } : capture;\n    // Use the window.EventTarget.prototype when possible to avoid wrong overrides (e.g: https://github.com/salesforce/lwc/issues/1824)\n    const listenerTarget = window.EventTarget && eventTarget instanceof EventTarget ? window.EventTarget.prototype : eventTarget;\n    const add = getZoneJsOriginalValue(listenerTarget, 'addEventListener');\n    eventNames.forEach((eventName) => add.call(eventTarget, eventName, listenerWithMonitor, options));\n    function stop() {\n        const remove = getZoneJsOriginalValue(listenerTarget, 'removeEventListener');\n        eventNames.forEach((eventName) => remove.call(eventTarget, eventName, listenerWithMonitor, options));\n    }\n    return {\n        stop,\n    };\n}\n//# sourceMappingURL=addEventListener.js.map","export const ResourceType = {\n    DOCUMENT: 'document',\n    XHR: 'xhr',\n    BEACON: 'beacon',\n    FETCH: 'fetch',\n    CSS: 'css',\n    JS: 'js',\n    IMAGE: 'image',\n    FONT: 'font',\n    MEDIA: 'media',\n    OTHER: 'other',\n};\nexport const RequestType = {\n    FETCH: ResourceType.FETCH,\n    XHR: ResourceType.XHR,\n};\n//# sourceMappingURL=resourceUtils.js.map"],"names":["ConsoleApiName","globalConsole","originalConsoleMethods","name","PREFIX","display","DOCS_ORIGIN","DOCS_TROUBLESHOOTING","MORE_DETAILS","catchUserErrors","fn","errorMsg","args","err","performDraw","threshold","round","num","decimals","isPercentage","value","isNumber","shallowClone","object","objectHasValue","key","isEmptyObject","mapValues","newObject","getGlobalObject","globalObject","isWorkerEnvironment","getZoneJsOriginalValue","target","browserWindow","original","onMonitorErrorCollected","debugMode","startMonitorErrorCollection","newOnMonitorErrorCollected","setDebugMode","newDebugMode","monitored","_","__","descriptor","originalMethod","monitor","callMonitored","context","e","monitorError","displayIfDebugEnabled","setTimeout","callback","delay","clearTimeout","timeoutId","setInterval","clearInterval","queueMicrotask","_a","nativeImplementation","Observable","onFirstSubscribe","observer","data","other","mergeObservables","observables","globalObservable","subscriptions","observable","subscription","BufferedObservable","maxBufferSize","closed","ONE_SECOND","ONE_MINUTE","ONE_HOUR","ONE_DAY","ONE_YEAR","relativeToClocks","relative","getCorrectedTimeStamp","timeStampToClocks","timeStamp","getRelativeTime","relativeTime","correctedOrigin","dateNow","getNavigationStart","addDuration","getTimeStamp","currentDrift","toServerDuration","duration","timeStampNow","relativeNow","clocksNow","clocksOrigin","elapsed","start","end","a","b","timestamp","looksLikeRelativeTime","time","navigationStart","_b","throttle","wait","options","needLeadingExecution","needTrailingExecution","inWaitPeriod","pendingExecutionWithParameters","pendingTimeoutId","parameters","noop","generateUUID","placeholder","COMMA_SEPARATED_KEY_VALUE","findCommaSeparatedValue","rawString","match","findAllCommaSeparatedValues","result","findCommaSeparatedValues","safeTruncate","candidate","length","suffix","lastChar","correctedLength","isChromium","detectBrowserCached","isSafari","browserCache","detectBrowser","userAgent","normalizeUrl","url","buildUrl","isValidUrl","getPathName","pathname","base","URL","getPristineWindow","error","getPristineGlobalObjectCache","iframe","pristineWindow","setCookie","expireDelay","date","expires","sameSite","domain","secure","partitioned","getCookie","getCookies","initCookieParsed","getInitCookie","deleteCookie","areCookiesAuthorized","testCookieName","testCookieValue","isCookieCorrectlySet","getCurrentSiteCache","getCurrentSite","hostname","referrer","defaultHostName","getCookieDefaultHostName","domainLevels","candidateDomain","SESSION_STORE_KEY","findLast","array","predicate","i","item","objectValues","objectEntries","SESSION_TIME_OUT_DELAY","SESSION_EXPIRATION_DELAY","SESSION_COOKIE_EXPIRATION_DELAY","SESSION_NOT_TRACKED","SessionPersistence","SESSION_ENTRY_REGEXP","SESSION_ENTRY_SEPARATOR","isValidSessionString","sessionString","EXPIRED","getExpiredSessionState","previousSessionState","configuration","expiredSessionState","isSessionInNotStartedState","session","isSessionStarted","isSessionInExpiredState","isActiveSession","sessionState","expandSessionState","toSessionString","toSessionState","entry","matches","OLD_SESSION_COOKIE_NAME","OLD_RUM_COOKIE_NAME","OLD_LOGS_COOKIE_NAME","RUM_SESSION_KEY","LOGS_SESSION_KEY","tryOldCookiesMigration","cookieStoreStrategy","oldSessionId","oldRumType","oldLogsType","SESSION_COOKIE_VERSION","selectCookieStrategy","initConfiguration","cookieOptions","buildCookieOptions","initCookieStrategy","cookieStore","storeSessionCookie","retrieveSessionCookie","defaultTimeout","sessionStateString","encodeCookieOptions","retrieveSessionCookieFromEncodedCookie","currentSite","domainCount","byte","cookies","opts","cookie","LOCAL_STORAGE_TEST_KEY","selectLocalStorageStrategy","id","testKey","retrievedId","initLocalStorageStrategy","persistInLocalStorage","retrieveSessionFromLocalStorage","expireSessionFromLocalStorage","LOCK_RETRY_DELAY","LOCK_MAX_TRIES","LOCK_EXPIRATION_DELAY","LOCK_SEPARATOR","bufferedOperations","ongoingOperations","processSessionStoreOperations","operations","sessionStoreStrategy","numberOfRetries","isLockEnabled","persistSession","expireSession","persistWithLock","currentLock","retrieveStore","lock","isLockExpired","next","currentStore","retryLater","createLock","processedSession","sessionStore","currentNumberOfRetries","nextOperations","STORAGE_POLL_DELAY","selectSessionStoreStrategyType","sessionStoreStrategyType","getSessionStoreStrategy","startSessionStore","productKey","computeTrackingType","renewObservable","expireObservable","sessionStateUpdateObservable","watchSessionTimeoutId","watchSession","sessionCache","startSession","throttledExpandOrRenewSession","cancelExpandOrRenewSession","synchronizedSession","synchronizeSession","expandOrRenewSessionState","hasSessionInCache","renewSessionInCache","expandSession","isSessionInCacheOutdated","expireSessionInCache","trackingType","updateSessionState","partialSessionState","hasConsent","TrackingConsent","createTrackingConsentState","currentConsent","trackingConsent","getType","isMatchOption","itemType","matchList","list","useStartsWith","EXTENSION_PREFIXES","containsExtensionUrl","str","prefix","isUnsupportedExtensionEnvironment","windowLocation","stack","line","trimmedLine","ERROR_DOES_NOT_HAVE_ALLOWED_TRACKING_ORIGIN","ERROR_NOT_ALLOWED_TRACKING_ORIGIN","isAllowedTrackingOrigins","errorStack","windowOrigin","allowedTrackingOrigins","isAllowed","INTAKE_SITE_STAGING","INTAKE_SITE_FED_STAGING","INTAKE_SITE_US1","INTAKE_SITE_EU1","INTAKE_SITE_US1_FED","PCI_INTAKE_HOST_US1","INTAKE_URL_PARAMETERS","createEndpointBuilder","trackType","extraParameters","buildUrlWithParameters","createEndpointUrlWithParametersBuilder","api","payload","buildEndpointParameters","path","proxy","normalizedProxyUrl","host","buildEndpointHost","site","internalAnalyticsSubdomain","domainParts","extension","clientToken","source","retry","encoding","computeTransportConfiguration","validateSource","endpointBuilders","computeEndpointBuilders","computeReplicaConfiguration","replicaConfiguration","isIntakeUrl","param","DefaultPrivacyLevel","TraceContextInjection","isString","tag","tagName","isDatadogSite","isSampleRate","sampleRate","validateAndBuildConfiguration","_c","_d","_e","_f","_g","_h","_j","_k","serializeConfiguration","ExperimentalFeature","enabledExperimentalFeatures","initFeatureFlags","enableExperimentalFeatures","addExperimentalFeatures","flag","enabledFeatures","isExperimentalFeatureEnabled","featureName","getExperimentalFeatures","UNKNOWN_FUNCTION","computeStackTrace","ex","stackProperty","tryToGetString","exString","stackFrame","parseChromeLine","parseChromeAnonymousLine","parseWinLine","parseGeckoLine","isWronglyReportingCustomErrors","constructors","currentPrototype","isNonNativeClassPrototype","constructorName","fileUrl","filePosition","CHROME_LINE_RE","CHROME_EVAL_RE","parts","isNative","isEval","submatch","CHROME_ANONYMOUS_FUNCTION_RE","WINJS_LINE_RE","GECKO_LINE_RE","GECKO_EVAL_RE","property","computeStackTraceFromOnErrorMessage","messageObj","column","message","tryToParseMessage","ERROR_TYPES_RE","prototype","isWronglyReportingCustomErrorsCache","DatadogTestCustomError","customError","nativeError","errConstructor","createHandlingStack","type","formattedStack","stackTrace","toStackTraceString","formatErrorMessage","frame","func","ONE_KIBI_BYTE","ONE_MEBI_BYTE","HAS_MULTI_BYTES_CHARACTERS","computeBytesCount","concatBuffers","buffers","total","buffer","offset","jsonStringify","replacer","space","restoreObjectPrototypeToJson","detachToJsonMethod","restoreArrayPrototypeToJson","restoreValuePrototypeToJson","restoreValueToJson","objectToJson","SANITIZE_DEFAULT_MAX_CHARACTER_COUNT","JSON_PATH_ROOT_ELEMENT","KEY_DECORATION_LENGTH","sanitize","maxCharacterCount","containerQueue","visitedObjectsWithPath","sanitizedData","sanitizeProcessor","serializedSanitizedData","accumulatedCharacterCount","warnOverCharacterLimit","containerToProcess","separatorLength","targetData","parentPath","queue","sourceToSanitize","tryToApplyToJSON","sanitizePrimitivesAndFunctions","sanitizedSource","sanitizeObjects","sourceAsObject","currentPath","sanitizeEvent","event","changeType","NO_ERROR_STACK_PRESENT_MESSAGE","computeRawError","originalError","handlingStack","componentStack","startClocks","nonErrorPrefix","useFallbackStack","handling","isErrorInstance","isError","computeMessage","flattenErrorCauses","tryToGetFingerprint","tryToGetErrorContext","getFileFromStackTraceString","parentSource","currentError","causes","ErrorSource","addEventListener","eventTarget","eventName","listener","addEventListeners","eventNames","once","capture","passive","listenerWithMonitor","stop","listenerTarget","add","remove","ResourceType","RequestType"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]}