{"version":3,"mappings":"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","names":["runOnReadyState","configuration","expectedReadyState","callback","noop","addEventListener","asyncRunOnReadyState","resolve","requestIdleCallback","opts","id","monitor","requestIdleCallbackShim","MAX_TASK_TIME","start","dateNow","timeoutId","setTimeout","clearTimeout","IDLE_CALLBACK_TIMEOUT","ONE_SECOND","MAX_EXECUTION_TIME_ON_TIMEOUT","createTaskQueue","pendingTasks","run","deadline","executionTimeRemaining","scheduleNextRun","task","getTimeZone","createCustomVitalsState","startVitalCollection","lifeCycle","pageStateHistory","customVitalsState","isValid","vital","addDurationVital","processVital","addOperationStepVital","name","stepType","options","failureReason","isExperimentalFeatureEnabled","ExperimentalFeature","operationKey","context","description","VitalType","clocksNow","sanitize","startDurationVital","nameOrRef","stopDurationVital","vitalsByName","vitalsByReference","reference","stopCallback","vitalStart","buildDurationVital","startClocks","stopOptions","stopClocks","_a","elapsed","combine","type","vitalData","generateUUID","toServerDuration","RumEventType","callPluginsMethod","plugins","methodName","parameter","plugin","method","sampleDecisionCache","isSampled","sessionId","sampleRate","cachedDecision","decision","sampleUsingKnuthFactor","performDraw","identifier","knuthFactor","twoPow64","hash","createTraceIdentifier","createIdentifier","createSpanIdentifier","bits","buffer","radix","high","low","str","mod","toPaddedHexadecimalString","isTracingOption","item","expectedItem","getType","isMatchOption","clearTracingIfNeeded","startTracer","sessionManager","userContext","accountContext","injectHeadersIfTracingAllowed","tracingHeaders","key","shallowClone","headers","value","header","objectEntries","xhr","inject","session","tracingOption","matchList","traceSampled","TraceContextInjection","makeTracingHeaders","traceId","spanId","propagatorTypes","propagatorType","baggageItems","userId","accountId","baggageHeader","DEFAULT_PROPAGATOR_TYPES","validateAndBuildRumConfiguration","initConfiguration","errorStack","_b","_c","_d","_e","_f","_g","display","isSampleRate","allowedTracingUrls","validateAndBuildTracingOptions","baseConfiguration","validateAndBuildConfiguration","allowedGraphQlUrls","validateAndBuildGraphQlOptions","sessionReplaySampleRate","isNumber","objectHasValue","DefaultPrivacyLevel","tracingOptions","option","getSelectedTracingPropagators","usedTracingPropagators","isNonEmptyArray","graphQlOptions","hasGraphQlPayloadTracking","hasGraphQlResponseErrorsTracking","serializeRumConfiguration","baseSerializedConfiguration","serializeConfiguration","parseJsonPath","path","selectors","previousToken","currentToken","parsingContext","currentSelector","char","ALLOWED_NEXT_TOKENS","token","TOKEN_PREDICATE","isValidEscapeSequence","resolveEscapeSequence","ALLOWED_SELECTOR_TOKENS","ALLOWED_SELECTOR_DELIMITER_TOKENS","NAME_SHORTHAND_FIRST_CHAR_REGEX","NAME_SHORTHAND_CHAR_REGEX","DIGIT_REGEX","UNICODE_CHAR_REGEX","QUOTE_CHARS","escapeSequence","ESCAPED_CHARS","REMOTE_CONFIGURATION_VERSION","SUPPORTED_FIELDS","fetchAndApplyRemoteConfiguration","supportedContextManagers","rumInitConfiguration","metrics","initMetrics","fetchResult","fetchRemoteConfiguration","applyRemoteConfiguration","addTelemetryMetrics","rumRemoteConfiguration","appliedConfiguration","resolveConfigurationProperty","resolveContextProperty","property","isObject","isSerializedOption","resolveRegex","resolveDynamicOption","mapValues","contextManager","contextItems","strategy","resolvedValue","resolveCookieValue","resolveDomValue","resolveJsValue","extractor","extractValue","getCookie","selector","attribute","element","isForbidden","domValue","current","pathParts","pathPart","e","metricName","pattern","candidate","resolvedExtractor","regexResult","match","capture","response","buildEndpoint","remoteConfiguration","buildEndpointHost","createPreStartStrategy","ignoreInitIfSyntheticsWillInjectRum","startDeflateWorker","trackingConsentState","doStartRum","bufferApiCalls","createBoundedBuffer","globalContext","buildGlobalContextManager","bufferContextCalls","CustomerContextKey","buildUserContextManager","buildAccountContextManager","firstStartViewCall","deflateWorker","cachedInitConfiguration","cachedConfiguration","trackingConsentStateSubscription","tryStartRum","emptyContext","initialViewOptions","startRumResult","doInit","eventBridgeAvailable","canUseEventBridge","overrideInitConfigurationForBridge","addTelemetryConfiguration","displayAlreadyInitializedError","initFetchObservable","publicApi","initFeatureFlags","willSyntheticsInjectRum","monitorError","time","timeStampNow","action","providedError","getEventBridge","preStartContextManager","makeRumPublicApi","startRumImpl","recorderApi","profilerApi","createTrackingConsentState","bufferedDataObservable","startBufferingData","createEncoder","streamId","createIdentityEncoder","createPostStartStrategy","getStrategy","startView","sanitizedOptions","addTelemetryUsage","rumPublicApi","makePublicApi","callMonitored","trackingConsent","startTime","deepClone","handlingStack","createHandlingStack","ActionType","error","defineContextMethod","ContextManagerMethod","timeStampToClocks","preStartStrategy","createDOMMutationObservable","MutationObserver","getMutationObserverConstructor","Observable","observable","observer","records","constructor","browserWindow","getZoneJsOriginalValue","patchedInstance","originalInstance","createWindowOpenObservable","stop","instrumentMethod","startInternalContext","applicationId","viewHistory","actionContexts","urlContexts","viewContext","urlContext","actionId","LifeCycle","AbstractLifeCycle","VIEW_CONTEXT_TIME_OUT_DELAY","SESSION_TIME_OUT_DELAY","startViewHistory","viewValueHistory","createValueHistory","view","buildViewHistoryEntry","endClocks","viewUpdate","currentView","GRAPHQL_PAYLOAD_LIMIT","ONE_KIBI_BYTE","extractGraphQlMetadata","request","graphQlConfig","metadata","extractGraphQlRequestMetadata","responseErrors","parseGraphQlResponse","responseText","responseObj","findGraphQlConfiguration","url","graphQlOption","requestBody","trackPayload","graphqlBody","query","operationType","getOperationType","operationName","variables","safeTruncate","nextRequestIndex","startRequestCollection","tracer","trackXhr","trackFetch","subscription","initXhrObservable","rawContext","isAllowedRequestUrl","getNextRequestIndex","RequestType","result","discardNegativeDuration","duration","trackEventCounts","isChildEvent","eventCounts","event","isTextNode","node","isCommentNode","isElementNode","isNodeShadowHost","isNodeShadowRoot","shadowRoot","hasChildNodes","forEachChildNodes","child","getParentNode","PAGE_ACTIVITY_VALIDATION_DELAY","PAGE_ACTIVITY_END_DELAY","EXCLUDED_MUTATIONS_ATTRIBUTE","waitPageActivityEnd","domMutationObservable","windowOpenObservable","pageActivityEndCallback","maxDuration","pageActivityObservable","createPageActivityObservable","doWaitPageActivityEnd","pageActivityEndTimeoutId","hasCompleted","validationTimeoutId","complete","maxDurationTimeoutId","pageActivitySubscription","isBusy","lastChangeTime","subscriptions","firstRequestIndex","pendingRequestsCount","mutations","isExcludedMutation","notifyPageActivity","createPerformanceObservable","RumPerformanceEntryType","entries","entry","isExcludedUrl","startEvent","s","requestUrl","mutation","targetElement","DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE","ACTION_NAME_PLACEHOLDER","STABLE_ATTRIBUTES","GLOBALLY_UNIQUE_SELECTOR_GETTERS","getStableAttributeSelector","getIDSelector","UNIQUE_AMONG_CHILDREN_SELECTOR_GETTERS","getClassSelector","getTagNameSelector","getSelectorFromElement","actionNameAttribute","targetElementSelector","currentElement","globallyUniqueSelector","findSelector","isSelectorUniqueGlobally","isSelectorUniqueAmongSiblings","combineSelector","getPositionSelector","isGeneratedValue","classList","i","className","getAttributeSelector","attributeName","sibling","elementIndex","selectorGetters","predicate","childSelector","selectorGetter","elementSelector","currentElementSelector","isSiblingMatching","scopedSelector","parent","getNodePrivacyLevel","defaultPrivacyLevel","cache","parentNode","parentNodePrivacyLevel","selfNodePrivacyLevel","getNodeSelfPrivacyLevel","nodePrivacyLevel","reducePrivacyLevel","childPrivacyLevel","NodePrivacyLevel","inputElement","autocomplete","getPrivacySelector","shouldIgnoreElement","shouldMaskNode","privacyLevel","isFormElement","isAllowlisted","shouldMaskAttribute","tagName","attributeValue","PRIVACY_ATTR_NAME","FORM_PRIVATE_TAG_NAMES","censorText","text","TEXT_MASKING_CHAR","getTextContent","textNode","parentTagName","textContent","CENSORED_STRING_MARK","maskDisallowedTextContent","relAttribute","getLowerCaseAttribute","nameAttribute","propertyAttribute","fixedMask","MAX_DURATION_BETWEEN_CLICKS","MAX_DISTANCE_BETWEEN_CLICKS","createClickChain","firstClick","onFinalize","bufferedClicks","status","maxDurationBetweenClicksTimeoutId","appendClick","click","tryFinalize","dontAcceptMoreClick","areEventsSimilar","first","second","mouseEventDistance","origin","other","getActionNameFromElement","rumConfiguration","nodePrivacyLevelCache","userProgrammaticAttribute","defaultActionName","getActionNameFromElementProgrammatically","getActionNameFromElementForStrategies","priorityStrategies","fallbackStrategies","programmaticAttribute","elementWithAttribute","truncate","normalizeWhitespace","getActionNameFromTextualContent","input","getActionNameFromStandardAttribute","labelledByAttribute","getElementById","label","getTextualContent","MAX_PARENTS_TO_CONSIDER","strategies","recursionCounter","actionName","nameSource","trimmedName","refElement","enablePrivacyForActionName","getTextualContentWithTreeWalker","removeTextFromElements","list","index","textToReplace","privacyEnabledActionName","walker","rejectInvisibleOrMaskedElementsFilter","nodeSelfPrivacyLevel","style","listenActionEvents","onPointerDown","onPointerUp","selectionEmptyAtPointerDown","userActivity","clickContext","listeners","isValidPointerEvent","isSelectionEmpty","localUserActivity","listener","selection","MIN_CLICKS_PER_SECOND_TO_CONSIDER_RAGE","computeFrustration","clicks","rageClick","isRage","FrustrationType","isDead","hasSelectionChanged","DEAD_CLICK_EXCLUDE_SELECTOR","target","CLICK_ACTION_MAX_DURATION","interactionSelectorCache","getInteractionSelector","relativeTimestamp","updateInteractionSelector","_","relativeNow","ACTION_CONTEXT_TIME_OUT_DELAY","ONE_MINUTE","trackClickActions","history","stopObservable","currentClickChain","stopClickChain","PageExitReason","stopActionEventsListener","pointerDownEvent","processPointerDown","clickActionBase","hadActivityOnPointerDown","getUserActivity","startClickAction","appendClickToClickChain","finalizeClicks","computeClickActionBase","pageActivityEndEvent","newClick","stopWaitPageActivityEnd","viewEndedSubscription","stopSubscription","rect","historyEntry","eventCountsSubscription","activityEndTime","frustrationTypes","newActivityEndTime","getRelativeTime","frustrationType","domEvents","resourceCount","errorCount","longTaskCount","clickAction","startActionCollection","hooks","unsubscribeAutoAction","processAction","eventType","SKIPPED","autoActionProperties","isAutoAction","actionEvent","domainContext","trackConsoleError","errorObservable","initConsoleObservable","ConsoleApiName","consoleLog","trackReportError","initReportObservable","RawReportType","rawError","startErrorCollection","bufferedData","doStartErrorCollection","processError","componentStack","computeRawError","ErrorSource","rawRumEvent","alreadyMatchedEntries","matchRequestResourceEntry","sameNameEntries","candidates","hasValidResourceEntryDuration","hasValidResourceEntryTimings","isBetween","endTime","timing","addDuration","end","INITIAL_DOCUMENT_OUTDATED_TRACE_ID_THRESHOLD","getDocumentTraceId","document","data","getDocumentTraceDataFromMeta","getDocumentTraceDataFromComment","traceIdMeta","traceTimeMeta","createDocumentTraceData","comment","findTraceComment","findCommaSeparatedValue","rawTraceTime","traceTime","getTraceCommentFromNode","getNavigationEntry","supportPerformanceTimingEvent","navigationEntry","timings","computeTimingsFromDeprecatedPerformanceTiming","numberKey","timingElement","retrieveInitialDocumentResourceTiming","getNavigationEntryImpl","FAKE_INITIAL_DOCUMENT","MAX_REQUESTS","createRequestRegistry","requests","addTelemetryDebug","minTimeDifference","closestRequest","timeDifference","startResourceCollection","taskQueue","retrieveInitialDocumentResourceTimingImpl","requestRegistry","isEarlyRequestCollectionEnabled","handleResource","processRequest","performanceResourceSubscription","isResourceEntryRequestType","processResourceEntry","computeRawEvent","rawEvent","matchingTiming","assembleResource","matchingRequest","tracingInfo","computeRequestTracingInfo","computeResourceEntryTracingInfo","relativeToClocks","computeResourceEntryDuration","computeRequestDuration","graphql","computeGraphQlMetaData","resourceEvent","ResourceType","computeResourceEntryType","discardZeroStatus","sanitizeIfLongDataUrl","computeResourceEntryProtocol","computeResourceEntryDeliveryType","computeResourceEntryMetrics","getResourceDomainContext","baseDomainContext","renderBlockingStatus","computeResourceEntrySize","computeResourceEntryDetails","statusCode","trackViewEventCounts","viewId","onChange","FCP_MAXIMUM_DELAY","trackFirstContentfulPaint","firstHidden","fcpEntry","trackRestoredFirstContentfulPaint","viewStartRelative","trackFirstInput","performanceFirstInputSubscription","firstInputEntry","firstInputDelay","firstInputTargetSelector","trackNavigationTimings","waitAfterLoadEvent","isIncompleteNavigation","processNavigationEntry","stopOnReadyState","LCP_MAXIMUM_DELAY","trackLargestContentfulPaint","eventTarget","firstInteractionTimestamp","stopEventListener","addEventListeners","biggestLcpSize","performanceLcpSubscription","lcpEntry","findLast","lcpTargetSelector","computeLcpEntryUrl","trackFirstHidden","viewStart","firstHiddenEntry","timeStamp","trackInitialViewMetrics","setLoadEvent","scheduleViewUpdate","initialViewMetrics","stopNavigationTracking","navigationTimings","stopFCPTracking","firstContentfulPaint","stopLCPTracking","largestContentfulPaint","stopFIDTracking","firstInput","calculateArea","width","height","calculateIntersectionArea","rect1","rect2","left","top","right","bottom","getClsAttributionImpactedArea","source","previousArea","currentArea","intersectionArea","trackCumulativeLayoutShift","isLayoutShiftSupported","maxClsValue","biggestShift","slidingWindow","slidingSessionWindow","performanceSubscription","cumulatedValue","isMaxValue","attribution","getTopImpactedElement","round","asRumRect","sources","topImpactedSource","currentImpactedArea","x","y","MAX_WINDOW_DURATION","MAX_UPDATE_GAP","maxValue","shouldCreateNewWindow","interactionCountEstimate","minKnownInteractionId","maxKnownInteractionId","initInteractionCountPolyfill","getInteractionCount","MAX_INTERACTION_ENTRIES","MAX_INP_VALUE","trackInteractionToNextPaint","viewLoadingType","isInteractionToNextPaintSupported","getViewInteractionCount","stopViewInteractionCount","trackViewInteractionCount","viewEnd","longestInteractions","trackLongestInteractions","interactionToNextPaint","interactionToNextPaintTargetSelector","interactionToNextPaintStartTime","handleEntries","newInteraction","firstInputSubscription","eventSubscription","viewEndTime","sortAndTrimLongestInteractions","a","b","interactionIndex","interaction","minLongestInteraction","previousInteractionCount","ViewLoadingType","state","computeViewInteractionCount","trackLoadingTime","loadType","isWaitingForLoadEvent","isWaitingForActivityLoadingTime","loadingTimeCandidates","invokeCallbackIfAllCandidatesAreReceived","loadingTime","loadEvent","getScrollX","scrollX","visual","getScrollY","scrollY","viewportObservable","initViewportObservable","createViewportObservable","updateDimension","throttle","getViewportDimension","THROTTLE_SCROLL_DURATION","trackScrollMetrics","scrollValues","createScrollValuesObservable","maxScrollDepth","maxScrollHeight","maxScrollHeightTime","scrollDepth","scrollTop","scrollHeight","shouldUpdate","now","computeScrollValues","throttleDuration","notify","throttledNotify","observerTarget","resizeObserver","eventListener","trackCommonViewMetrics","loadingType","commonViewMetrics","stopLoadingTimeTracking","newLoadingTime","stopScrollMetricsTracking","newScrollMetrics","stopCLSTracking","cumulativeLayoutShift","stopINPTracking","getInteractionToNextPaint","setViewEnd","onBFCacheRestore","trackBfcacheMetrics","paintTime","THROTTLE_VIEW_UPDATE_PERIOD","SESSION_KEEP_ALIVE_INTERVAL","KEEP_TRACKING_AFTER_VIEW_DELAY","trackViews","location","locationChangeObservable","areViewsTrackedAutomatically","activeViews","startNewView","clocksOrigin","stopOnBFCacheRestore","startViewLifeCycle","locationChangeSubscription","renewViewOnLocationChange","pageshowEvent","viewOptions","newlyCreatedView","newView","oldLocation","newLocation","areDifferentLocation","initialLocation","customTimings","documentVersion","createContextManager","sessionIsActive","service","version","viewCreatedEvent","throttled","cancelScheduleViewUpdate","triggerViewUpdate","stopCommonViewMetricsTracking","getCommonViewMetrics","stopInitialViewMetricsTracking","stopEventCountsTracking","keepAliveIntervalId","setInterval","pageMayExitSubscription","pageMayExitEvent","triggerBeforeViewUpdate","currentEnd","clearInterval","relativeTime","looksLikeRelativeTime","sanitizeTiming","updatedName","sanitized","currentLocation","otherLocation","isHashAnAnchor","getPathFromHash","correspondingId","startViewCollection","pageOpenObservable","processViewUpdate","DISCARDED","_h","_j","_k","_l","_m","_o","_p","_q","_r","_s","_t","replayStats","clsDevicePixelRatio","viewEvent","computeViewPerformanceData","isEmptyObject","RUM_SESSION_KEY","startRumSessionManager","startSessionManager","rawTrackingType","computeTrackingType","previousState","newState","sessionEntity","startRumSessionManagerStub","bridgeSupports","hasValidRumSession","trackingType","startRumBatch","reportError","pageMayExitObservable","sessionExpireObservable","endpoints","batch","createBatch","createHttpRequest","createFlushController","serverRumEvent","startRumEventBridge","bridge","URL_CONTEXT_TIME_OUT_DELAY","startUrlContexts","urlContextHistory","previousViewUrl","viewUrl","buildUrlContext","changeTime","referrer","createLocationChangeObservable","stopHistoryTracking","trackHistory","onLocationChange","stopHashTracking","trackHash","onHistoryChange","stopInstrumentingPushState","getHistoryInstrumentationTarget","onPostCall","stopInstrumentingReplaceState","removeListener","onHashChange","FEATURE_FLAG_CONTEXT_TIME_OUT_DELAY","startFeatureFlagContexts","featureFlagContexts","featureFlagContext","currentContext","MEASURES_PERIOD_DURATION","currentPeriodMeasures","batchHasRumEvent","startCustomerDataTelemetry","telemetry","batchFlushObservable","initCurrentPeriodMeasures","bytesCount","messagesCount","updateMeasure","sendCurrentPeriodMeasures","createMeasure","measure","MAX_PAGE_STATE_ENTRIES","MAX_PAGE_STATE_ENTRIES_SELECTABLE","PAGE_STATE_CONTEXT_TIME_OUT_DELAY","startPageStateHistory","maxPageStateEntriesSelectable","pageStateEntryHistory","currentPageState","addPageState","getPageState","stopEventListeners","computePageState","nextPageState","wasInPageStateDuringPeriod","pageState","pageStates","processPageStates","pageStateEntries","eventStartTime","startDisplayContext","viewport","animationFrameId","unsubscribeViewport","viewportDimension","createCookieObservable","cookieName","detectCookieChangeStrategy","listenToCookieStoreChange","watchCookieFallback","changeEvent","WATCH_COOKIE_INTERVAL_DELAY","previousCookieValue","watchCookieIntervalId","cookieValue","CI_VISIBILITY_TEST_ID_COOKIE_NAME","startCiVisibilityContext","cookieObservable","testExecutionId","getInitCookie","cookieObservableSubscription","startLongAnimationFrameCollection","RumLongTaskEntryType","script","startLongTaskCollection","performanceLongTaskSubscription","startSyntheticsContext","isSyntheticsTest","testId","getSyntheticsTestId","resultId","getSyntheticsResultId","limitModification","object","modifiableFieldPaths","modifier","clone","fieldPath","fieldType","setValueAtPath","pathSegments","field","restPathSegments","isValidObject","setNestedValue","newType","VIEW_MODIFIABLE_FIELD_PATHS","USER_CUSTOMIZABLE_FIELD_PATHS","ROOT_MODIFIABLE_FIELD_PATHS","modifiableFieldPathsByEvent","startRumAssembly","eventRateLimit","eventRateLimiters","createEventRateLimiter","defaultRumEventAttributes","buildTags","shouldSend","beforeSend","startSessionContext","hasReplay","sampledForReplay","isActive","startConnectivityContext","getConnectivity","startDefaultContext","sdkName","currentDrift","startTrackingConsentContext","createHooks","abstractHooks","allowedEventTypes","startEventCollection","startInitialViewMetricsTelemetry","unsubscribe","createCoreInitialViewMetrics","lcp","navigation","startRum","cleanupTasks","sendToExtension","createPageMayExitObservable","startTelemetry","stopWindowOpen","startGlobalContext","startUserContext","startAccountContext","addAction","addEvent","stopRumEventCollection","startRumEventCollection","addTiming","setViewName","setViewContext","setViewContextProperty","getViewContext","stopViewCollection","stopInitialViewMetricsTelemetry","stopResourceCollection","stopLongAnimationFrameCollection","addError","vitalCollection","internalContext","actionCollection","eventCollection","displayContext","ciVisibilityContext","getSessionReplayUrl","errorType","parameters","getDatadogSiteUrl","site","subdomain","getSiteDefaultSubdomain","INTAKE_SITE_US1","INTAKE_SITE_EU1","INTAKE_SITE_STAGING","MAX_STATS_HISTORY","statsPerView","getSegmentsCount","getOrCreateReplayStats","addSegment","addRecord","addWroteData","additionalBytesCount","getReplayStats","deleteOldestStats","toDelete","createDeflateEncoder","worker","rawBytesCount","compressedData","compressedDataTrailer","isEmpty","nextWriteActionId","pendingWriteActions","removeMessageListener","workerResponse","nextPendingAction","consumeResult","output","concatBuffers","sendResetIfNeeded","pendingWriteAction","pendingData","reportScriptLoadingError","configuredUrl","scriptType","isMessageCspRelated","baseMessage","DOCS_ORIGIN","addTelemetryError","message","INITIALIZATION_TIME_OUT_DELAY","createDeflateWorker","onInitializationFailure","createDeflateWorkerImpl","doStartDeflateWorker","getDeflateWorkerStatus","removeErrorListener","onError","onInitialized","onTimeout","isBrowserSupported","getSessionReplayLink","isRecordingStarted","getErrorType","startRecorderInitTelemetry","startContext","documentReadyDuration","recorderSettledDuration","createRecorderInitMetrics","forced","loadRecorderModuleDuration","recorderInitDuration","waitForDocReadyDuration","loadRecorder","getOrCreateDeflateEncoder","stopRecording","doStart","startRecordingImpl","notifyWhenSettled","deflateEncoder","canStartRecording","isRecordingInProgress","shouldForceReplay","promise","makeRecorderApi","shouldStartImmediately","onRumStart","getReplayStatsImpl","cachedDeflateEncoder","lazyLoadRecorder","importRecorderImpl","importRecorder","__vitePreload","isProfilingSupported","getGlobalObject","startProfilingContext","newContext","lazyLoadProfiler","importProfilerImpl","importProfiler","makeProfilerApi","profiler","profilingContextManager","createRumProfiler","datadogRum","defineGlobal"],"ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104],"sources":["../../node_modules/@datadog/browser-core/esm/browser/runOnReadyState.js","../../node_modules/@datadog/browser-core/esm/tools/requestIdleCallback.js","../../node_modules/@datadog/browser-core/esm/tools/taskQueue.js","../../node_modules/@datadog/browser-core/esm/tools/utils/timezone.js","../../node_modules/@datadog/browser-rum-core/esm/domain/vital/vitalCollection.js","../../node_modules/@datadog/browser-rum-core/esm/domain/plugins.js","../../node_modules/@datadog/browser-rum-core/esm/domain/sampler/sampler.js","../../node_modules/@datadog/browser-rum-core/esm/domain/tracing/identifier.js","../../node_modules/@datadog/browser-rum-core/esm/domain/tracing/tracer.js","../../node_modules/@datadog/browser-rum-core/esm/domain/configuration/configuration.js","../../node_modules/@datadog/browser-rum-core/esm/domain/configuration/jsonPathParser.js","../../node_modules/@datadog/browser-rum-core/esm/domain/configuration/remoteConfiguration.js","../../node_modules/@datadog/browser-rum-core/esm/boot/preStartRum.js","../../node_modules/@datadog/browser-rum-core/esm/boot/rumPublicApi.js","../../node_modules/@datadog/browser-rum-core/esm/browser/domMutationObservable.js","../../node_modules/@datadog/browser-rum-core/esm/browser/windowOpenObservable.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/internalContext.js","../../node_modules/@datadog/browser-rum-core/esm/domain/lifeCycle.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/viewHistory.js","../../node_modules/@datadog/browser-rum-core/esm/domain/resource/graphql.js","../../node_modules/@datadog/browser-rum-core/esm/domain/requestCollection.js","../../node_modules/@datadog/browser-rum-core/esm/domain/discardNegativeDuration.js","../../node_modules/@datadog/browser-rum-core/esm/domain/trackEventCounts.js","../../node_modules/@datadog/browser-rum-core/esm/browser/htmlDomUtils.js","../../node_modules/@datadog/browser-rum-core/esm/domain/waitPageActivityEnd.js","../../node_modules/@datadog/browser-rum-core/esm/domain/action/actionNameConstants.js","../../node_modules/@datadog/browser-rum-core/esm/domain/getSelectorFromElement.js","../../node_modules/@datadog/browser-rum-core/esm/domain/privacy.js","../../node_modules/@datadog/browser-rum-core/esm/domain/action/clickChain.js","../../node_modules/@datadog/browser-rum-core/esm/domain/action/getActionNameFromElement.js","../../node_modules/@datadog/browser-rum-core/esm/domain/action/listenActionEvents.js","../../node_modules/@datadog/browser-rum-core/esm/domain/action/computeFrustration.js","../../node_modules/@datadog/browser-rum-core/esm/domain/action/interactionSelectorCache.js","../../node_modules/@datadog/browser-rum-core/esm/domain/action/trackClickActions.js","../../node_modules/@datadog/browser-rum-core/esm/domain/action/actionCollection.js","../../node_modules/@datadog/browser-rum-core/esm/domain/error/trackConsoleError.js","../../node_modules/@datadog/browser-rum-core/esm/domain/error/trackReportError.js","../../node_modules/@datadog/browser-rum-core/esm/domain/error/errorCollection.js","../../node_modules/@datadog/browser-rum-core/esm/domain/resource/matchRequestResourceEntry.js","../../node_modules/@datadog/browser-rum-core/esm/domain/tracing/getDocumentTraceId.js","../../node_modules/@datadog/browser-rum-core/esm/browser/performanceUtils.js","../../node_modules/@datadog/browser-rum-core/esm/domain/resource/retrieveInitialDocumentResourceTiming.js","../../node_modules/@datadog/browser-rum-core/esm/domain/resource/requestRegistry.js","../../node_modules/@datadog/browser-rum-core/esm/domain/resource/resourceCollection.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/trackViewEventCounts.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackFirstContentfulPaint.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackFirstInput.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackNavigationTimings.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackLargestContentfulPaint.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackFirstHidden.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackInitialViewMetrics.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/getClsAttributionImpactedArea.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackCumulativeLayoutShift.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/interactionCountPolyfill.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackInteractionToNextPaint.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackLoadingTime.js","../../node_modules/@datadog/browser-rum-core/esm/browser/scroll.js","../../node_modules/@datadog/browser-rum-core/esm/browser/viewportObservable.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackScrollMetrics.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackCommonViewMetrics.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/bfCacheSupport.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/trackBfcacheMetrics.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/trackViews.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewCollection.js","../../node_modules/@datadog/browser-rum-core/esm/domain/rumSessionManager.js","../../node_modules/@datadog/browser-rum-core/esm/transport/startRumBatch.js","../../node_modules/@datadog/browser-rum-core/esm/transport/startRumEventBridge.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/urlContexts.js","../../node_modules/@datadog/browser-rum-core/esm/browser/locationChangeObservable.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/featureFlagContext.js","../../node_modules/@datadog/browser-rum-core/esm/domain/startCustomerDataTelemetry.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/pageStateHistory.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/displayContext.js","../../node_modules/@datadog/browser-rum-core/esm/browser/cookieObservable.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/ciVisibilityContext.js","../../node_modules/@datadog/browser-rum-core/esm/domain/longAnimationFrame/longAnimationFrameCollection.js","../../node_modules/@datadog/browser-rum-core/esm/domain/longTask/longTaskCollection.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/syntheticsContext.js","../../node_modules/@datadog/browser-rum-core/esm/domain/limitModification.js","../../node_modules/@datadog/browser-rum-core/esm/domain/assembly.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/sessionContext.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/connectivityContext.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/defaultContext.js","../../node_modules/@datadog/browser-rum-core/esm/domain/contexts/trackingConsentContext.js","../../node_modules/@datadog/browser-rum-core/esm/domain/hooks.js","../../node_modules/@datadog/browser-rum-core/esm/domain/event/eventCollection.js","../../node_modules/@datadog/browser-rum-core/esm/domain/view/viewMetrics/startInitialViewMetricsTelemetry.js","../../node_modules/@datadog/browser-rum-core/esm/boot/startRum.js","../../node_modules/@datadog/browser-rum-core/esm/domain/getSessionReplayUrl.js","../../node_modules/@datadog/browser-rum/esm/domain/replayStats.js","../../node_modules/@datadog/browser-rum/esm/domain/deflate/deflateEncoder.js","../../node_modules/@datadog/browser-rum/esm/domain/scriptLoadingError.js","../../node_modules/@datadog/browser-rum/esm/domain/deflate/deflateWorker.js","../../node_modules/@datadog/browser-rum/esm/boot/isBrowserSupported.js","../../node_modules/@datadog/browser-rum/esm/domain/getSessionReplayLink.js","../../node_modules/@datadog/browser-rum/esm/domain/startRecorderInitTelemetry.js","../../node_modules/@datadog/browser-rum/esm/boot/postStartStrategy.js","../../node_modules/@datadog/browser-rum/esm/boot/preStartStrategy.js","../../node_modules/@datadog/browser-rum/esm/boot/recorderApi.js","../../node_modules/@datadog/browser-rum/esm/boot/lazyLoadRecorder.js","../../node_modules/@datadog/browser-rum/esm/domain/profiling/profilingSupported.js","../../node_modules/@datadog/browser-rum/esm/domain/profiling/profilingContext.js","../../node_modules/@datadog/browser-rum/esm/boot/lazyLoadProfiler.js","../../node_modules/@datadog/browser-rum/esm/boot/profilerApi.js","../../node_modules/@datadog/browser-rum/esm/entries/main.js"],"sourcesContent":["import { noop } from '../tools/utils/functionUtils';\nimport { addEventListener } from './addEventListener';\nexport function runOnReadyState(configuration, expectedReadyState, callback) {\n    if (document.readyState === expectedReadyState || document.readyState === 'complete') {\n        callback();\n        return { stop: noop };\n    }\n    const eventName = expectedReadyState === 'complete' ? \"load\" /* DOM_EVENT.LOAD */ : \"DOMContentLoaded\" /* DOM_EVENT.DOM_CONTENT_LOADED */;\n    return addEventListener(configuration, window, eventName, callback, { once: true });\n}\nexport function asyncRunOnReadyState(configuration, expectedReadyState) {\n    return new Promise((resolve) => {\n        runOnReadyState(configuration, expectedReadyState, resolve);\n    });\n}\n//# sourceMappingURL=runOnReadyState.js.map","import { setTimeout, clearTimeout } from './timer';\nimport { monitor } from './monitor';\nimport { dateNow } from './utils/timeUtils';\n/**\n * 'requestIdleCallback' with a shim.\n */\nexport function requestIdleCallback(callback, opts) {\n    // Note: check both 'requestIdleCallback' and 'cancelIdleCallback' existence because some polyfills only implement 'requestIdleCallback'.\n    if (window.requestIdleCallback && window.cancelIdleCallback) {\n        const id = window.requestIdleCallback(monitor(callback), opts);\n        return () => window.cancelIdleCallback(id);\n    }\n    return requestIdleCallbackShim(callback);\n}\nexport const MAX_TASK_TIME = 50;\n/*\n * Shim from https://developer.chrome.com/blog/using-requestidlecallback#checking_for_requestidlecallback\n * Note: there is no simple way to support the \"timeout\" option, so we ignore it.\n */\nexport function requestIdleCallbackShim(callback) {\n    const start = dateNow();\n    const timeoutId = setTimeout(() => {\n        callback({\n            didTimeout: false,\n            timeRemaining: () => Math.max(0, MAX_TASK_TIME - (dateNow() - start)),\n        });\n    }, 0);\n    return () => clearTimeout(timeoutId);\n}\n//# sourceMappingURL=requestIdleCallback.js.map","import { ONE_SECOND } from './utils/timeUtils';\nimport { requestIdleCallback } from './requestIdleCallback';\n/**\n * Maximum delay before starting to execute tasks in the queue. We don't want to wait too long\n * before running tasks, as it might hurt reliability (ex: if the user navigates away, we might lose\n * the opportunity to send some data). We also don't want to run tasks too often, as it might hurt\n * performance.\n */\nconst IDLE_CALLBACK_TIMEOUT = ONE_SECOND;\n/**\n * Maximum amount of time allocated to running tasks when a timeout (`IDLE_CALLBACK_TIMEOUT`) is\n * reached. We should not run tasks for too long as it will hurt performance, but we should still\n * run some tasks to avoid postponing them forever.\n *\n * Rational: Running tasks for 30ms every second (IDLE_CALLBACK_TIMEOUT) should be acceptable.\n */\nexport const MAX_EXECUTION_TIME_ON_TIMEOUT = 30;\nexport function createTaskQueue() {\n    const pendingTasks = [];\n    function run(deadline) {\n        let executionTimeRemaining;\n        if (deadline.didTimeout) {\n            const start = performance.now();\n            executionTimeRemaining = () => MAX_EXECUTION_TIME_ON_TIMEOUT - (performance.now() - start);\n        }\n        else {\n            executionTimeRemaining = deadline.timeRemaining.bind(deadline);\n        }\n        while (executionTimeRemaining() > 0 && pendingTasks.length) {\n            pendingTasks.shift()();\n        }\n        if (pendingTasks.length) {\n            scheduleNextRun();\n        }\n    }\n    function scheduleNextRun() {\n        requestIdleCallback(run, { timeout: IDLE_CALLBACK_TIMEOUT });\n    }\n    return {\n        push(task) {\n            if (pendingTasks.push(task) === 1) {\n                scheduleNextRun();\n            }\n        },\n        stop() {\n            pendingTasks.length = 0;\n        },\n    };\n}\n//# sourceMappingURL=taskQueue.js.map","export function getTimeZone() {\n    try {\n        const intl = new Intl.DateTimeFormat();\n        return intl.resolvedOptions().timeZone;\n    }\n    catch (_a) {\n        return undefined;\n    }\n}\n//# sourceMappingURL=timezone.js.map","import { clocksNow, combine, elapsed, ExperimentalFeature, generateUUID, isExperimentalFeatureEnabled, sanitize, toServerDuration, } from '@datadog/browser-core';\nimport { RumEventType, VitalType } from '../../rawRumEvent.types';\nexport function createCustomVitalsState() {\n    const vitalsByName = new Map();\n    const vitalsByReference = new WeakMap();\n    return { vitalsByName, vitalsByReference };\n}\nexport function startVitalCollection(lifeCycle, pageStateHistory, customVitalsState) {\n    function isValid(vital) {\n        return !pageStateHistory.wasInPageStateDuringPeriod(\"frozen\" /* PageState.FROZEN */, vital.startClocks.relative, vital.duration);\n    }\n    function addDurationVital(vital) {\n        if (isValid(vital)) {\n            lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, processVital(vital));\n        }\n    }\n    function addOperationStepVital(name, stepType, options, failureReason) {\n        if (!isExperimentalFeatureEnabled(ExperimentalFeature.FEATURE_OPERATION_VITAL)) {\n            return;\n        }\n        const { operationKey, context, description } = options || {};\n        const vital = {\n            name,\n            type: VitalType.OPERATION_STEP,\n            operationKey,\n            failureReason,\n            stepType,\n            startClocks: clocksNow(),\n            context: sanitize(context),\n            description,\n        };\n        lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, processVital(vital));\n    }\n    return {\n        addOperationStepVital,\n        addDurationVital,\n        startDurationVital: (name, options = {}) => startDurationVital(customVitalsState, name, options),\n        stopDurationVital: (nameOrRef, options = {}) => {\n            stopDurationVital(addDurationVital, customVitalsState, nameOrRef, options);\n        },\n    };\n}\nexport function startDurationVital({ vitalsByName, vitalsByReference }, name, options = {}) {\n    const vital = {\n        name,\n        startClocks: clocksNow(),\n        ...options,\n    };\n    // To avoid leaking implementation details of the vital, we return a reference to it.\n    const reference = { __dd_vital_reference: true };\n    vitalsByName.set(name, vital);\n    // To avoid memory leaks caused by the creation of numerous references (e.g., from improper useEffect implementations), we use a WeakMap.\n    vitalsByReference.set(reference, vital);\n    return reference;\n}\nexport function stopDurationVital(stopCallback, { vitalsByName, vitalsByReference }, nameOrRef, options = {}) {\n    const vitalStart = typeof nameOrRef === 'string' ? vitalsByName.get(nameOrRef) : vitalsByReference.get(nameOrRef);\n    if (!vitalStart) {\n        return;\n    }\n    stopCallback(buildDurationVital(vitalStart, vitalStart.startClocks, options, clocksNow()));\n    if (typeof nameOrRef === 'string') {\n        vitalsByName.delete(nameOrRef);\n    }\n    else {\n        vitalsByReference.delete(nameOrRef);\n    }\n}\nfunction buildDurationVital(vitalStart, startClocks, stopOptions, stopClocks) {\n    var _a;\n    return {\n        name: vitalStart.name,\n        type: VitalType.DURATION,\n        startClocks,\n        duration: elapsed(startClocks.timeStamp, stopClocks.timeStamp),\n        context: combine(vitalStart.context, stopOptions.context),\n        description: (_a = stopOptions.description) !== null && _a !== void 0 ? _a : vitalStart.description,\n    };\n}\nfunction processVital(vital) {\n    const { startClocks, type, name, description, context } = vital;\n    const vitalData = {\n        id: generateUUID(),\n        type,\n        name,\n        description,\n        ...(type === VitalType.DURATION\n            ? { duration: toServerDuration(vital.duration) }\n            : {\n                step_type: vital.stepType,\n                operation_key: vital.operationKey,\n                failure_reason: vital.failureReason,\n            }),\n    };\n    return {\n        rawRumEvent: {\n            date: startClocks.timeStamp,\n            vital: vitalData,\n            type: RumEventType.VITAL,\n            context,\n        },\n        startTime: startClocks.relative,\n        duration: type === VitalType.DURATION ? vital.duration : undefined,\n        domainContext: {},\n    };\n}\n//# sourceMappingURL=vitalCollection.js.map","export function callPluginsMethod(plugins, methodName, parameter) {\n    if (!plugins) {\n        return;\n    }\n    for (const plugin of plugins) {\n        const method = plugin[methodName];\n        if (method) {\n            method(parameter);\n        }\n    }\n}\n//# sourceMappingURL=plugins.js.map","import { performDraw } from '@datadog/browser-core';\nconst sampleDecisionCache = new Map();\nexport function isSampled(sessionId, sampleRate) {\n    // Shortcuts for common cases. This is not strictly necessary, but it makes the code faster for\n    // customers willing to ingest all traces.\n    if (sampleRate === 100) {\n        return true;\n    }\n    if (sampleRate === 0) {\n        return false;\n    }\n    const cachedDecision = sampleDecisionCache.get(sampleRate);\n    if (cachedDecision && sessionId === cachedDecision.sessionId) {\n        return cachedDecision.decision;\n    }\n    let decision;\n    // @ts-expect-error BigInt might not be defined in every browser we support\n    if (window.BigInt) {\n        decision = sampleUsingKnuthFactor(BigInt(`0x${sessionId.split('-')[4]}`), sampleRate);\n    }\n    else {\n        // For simplicity, we don't use consistent sampling for browser without BigInt support\n        // TODO: remove this when all browser we support have BigInt support\n        decision = performDraw(sampleRate);\n    }\n    sampleDecisionCache.set(sampleRate, { sessionId, decision });\n    return decision;\n}\n// Exported for tests\nexport function resetSampleDecisionCache() {\n    sampleDecisionCache.clear();\n}\n/**\n * Perform sampling using the Knuth factor method. This method offer consistent sampling result\n * based on the provided identifier.\n *\n * @param identifier - The identifier to use for sampling.\n * @param sampleRate - The sample rate in percentage between 0 and 100.\n */\nexport function sampleUsingKnuthFactor(identifier, sampleRate) {\n    // The formula is:\n    //\n    //   (identifier * knuthFactor) % 2^64 < sampleRate * 2^64\n    //\n    // Because JavaScript numbers are 64-bit floats, we can't represent 64-bit integers, and the\n    // modulo would be incorrect. Thus, we are using BigInts here.\n    //\n    // Implementation in other languages:\n    // * Go     https://github.com/DataDog/dd-trace-go/blob/ec6fbb1f2d517b7b8e69961052adf7136f3af773/ddtrace/tracer/sampler.go#L86-L91\n    // * Python https://github.com/DataDog/dd-trace-py/blob/0cee2f066fb6e79aa15947c1514c0f406dea47c5/ddtrace/sampling_rule.py#L197\n    // * Ruby   https://github.com/DataDog/dd-trace-rb/blob/1a6e255cdcb7e7e22235ea5955f90f6dfa91045d/lib/datadog/tracing/sampling/rate_sampler.rb#L42\n    // * C++    https://github.com/DataDog/dd-trace-cpp/blob/159629edc438ae45f2bb318eb7bd51abd05e94b5/src/datadog/trace_sampler.cpp#L58\n    // * Java   https://github.com/DataDog/dd-trace-java/blob/896dd6b380533216e0bdee59614606c8272d313e/dd-trace-core/src/main/java/datadog/trace/common/sampling/DeterministicSampler.java#L48\n    //\n    // Note: All implementations have slight variations. Some of them use '<=' instead of '<', and\n    // use `sampleRate * 2^64 - 1` instead of `sampleRate * 2^64`. The following implementation\n    // should adhere to the spec and is a bit simpler than using a 2^64-1 limit as there are less\n    // BigInt arithmetic to write. In practice this does not matter, as we are using floating point\n    // numbers in the end, and Number(2n**64n-1n) === Number(2n**64n).\n    const knuthFactor = BigInt('1111111111111111111');\n    const twoPow64 = BigInt('0x10000000000000000'); // 2n ** 64n\n    const hash = (identifier * knuthFactor) % twoPow64;\n    return Number(hash) <= (sampleRate / 100) * Number(twoPow64);\n}\n//# sourceMappingURL=sampler.js.map","export function createTraceIdentifier() {\n    return createIdentifier(64);\n}\nexport function createSpanIdentifier() {\n    return createIdentifier(63);\n}\nfunction createIdentifier(bits) {\n    const buffer = crypto.getRandomValues(new Uint32Array(2));\n    if (bits === 63) {\n        // eslint-disable-next-line no-bitwise\n        buffer[buffer.length - 1] >>>= 1; // force 63-bit\n    }\n    // The `.toString` function is intentionally similar to Number and BigInt `.toString` method.\n    //\n    // JavaScript numbers can represent integers up to 48 bits, this is why we need two of them to\n    // represent a 64 bits identifier. But BigInts don't have this limitation and can represent larger\n    // integer values.\n    //\n    // In the future, when we drop browsers without BigInts support, we could use BigInts directly\n    // represent identifiers by simply returning a BigInt from this function (as all we need is a\n    // value with a `.toString` method).\n    //\n    // Examples:\n    //   const buffer = getCrypto().getRandomValues(new Uint32Array(2))\n    //   return BigInt(buffer[0]) + BigInt(buffer[1]) << 32n\n    //\n    //   // Alternative with BigUint64Array (different Browser support than plain bigints!):\n    //   return crypto.getRandomValues(new BigUint64Array(1))[0]\n    //\n    // For now, let's keep using two plain numbers as having two different implementations (one for\n    // browsers with BigInt support and one for older browsers) don't bring much value.\n    return {\n        toString(radix = 10) {\n            let high = buffer[1];\n            let low = buffer[0];\n            let str = '';\n            do {\n                const mod = (high % radix) * 4294967296 + low;\n                high = Math.floor(high / radix);\n                low = Math.floor(mod / radix);\n                str = (mod % radix).toString(radix) + str;\n            } while (high || low);\n            return str;\n        },\n    };\n}\nexport function toPaddedHexadecimalString(id) {\n    return id.toString(16).padStart(16, '0');\n}\n//# sourceMappingURL=identifier.js.map","import { objectEntries, shallowClone, getType, isMatchOption, matchList, TraceContextInjection, } from '@datadog/browser-core';\nimport { isSampled } from '../sampler/sampler';\nimport { createSpanIdentifier, createTraceIdentifier, toPaddedHexadecimalString } from './identifier';\nexport function isTracingOption(item) {\n    const expectedItem = item;\n    return (getType(expectedItem) === 'object' &&\n        isMatchOption(expectedItem.match) &&\n        Array.isArray(expectedItem.propagatorTypes));\n}\n/**\n * Clear tracing information to avoid incomplete traces. Ideally, we should do it when the\n * request did not reach the server, but the browser does not expose this. So, we clear tracing\n * information if the request ended with status 0 without being aborted by the application.\n *\n * Reasoning:\n *\n * * Applications are usually aborting requests after a bit of time, for example when the user is\n * typing (autocompletion) or navigating away (in a SPA). With a performant device and good\n * network conditions, the request is likely to reach the server before being canceled.\n *\n * * Requests aborted otherwise (ex: lack of internet, CORS issue, blocked by a privacy extension)\n * are likely to finish quickly and without reaching the server.\n *\n * Of course, it might not be the case every time, but it should limit having incomplete traces a\n * bit.\n * */\nexport function clearTracingIfNeeded(context) {\n    if (context.status === 0 && !context.isAborted) {\n        context.traceId = undefined;\n        context.spanId = undefined;\n        context.traceSampled = undefined;\n    }\n}\nexport function startTracer(configuration, sessionManager, userContext, accountContext) {\n    return {\n        clearTracingIfNeeded,\n        traceFetch: (context) => injectHeadersIfTracingAllowed(configuration, context, sessionManager, userContext, accountContext, (tracingHeaders) => {\n            var _a;\n            if (context.input instanceof Request && !((_a = context.init) === null || _a === void 0 ? void 0 : _a.headers)) {\n                context.input = new Request(context.input);\n                Object.keys(tracingHeaders).forEach((key) => {\n                    ;\n                    context.input.headers.append(key, tracingHeaders[key]);\n                });\n            }\n            else {\n                context.init = shallowClone(context.init);\n                const headers = [];\n                if (context.init.headers instanceof Headers) {\n                    context.init.headers.forEach((value, key) => {\n                        headers.push([key, value]);\n                    });\n                }\n                else if (Array.isArray(context.init.headers)) {\n                    context.init.headers.forEach((header) => {\n                        headers.push(header);\n                    });\n                }\n                else if (context.init.headers) {\n                    Object.keys(context.init.headers).forEach((key) => {\n                        headers.push([key, context.init.headers[key]]);\n                    });\n                }\n                context.init.headers = headers.concat(objectEntries(tracingHeaders));\n            }\n        }),\n        traceXhr: (context, xhr) => injectHeadersIfTracingAllowed(configuration, context, sessionManager, userContext, accountContext, (tracingHeaders) => {\n            Object.keys(tracingHeaders).forEach((name) => {\n                xhr.setRequestHeader(name, tracingHeaders[name]);\n            });\n        }),\n    };\n}\nfunction injectHeadersIfTracingAllowed(configuration, context, sessionManager, userContext, accountContext, inject) {\n    const session = sessionManager.findTrackedSession();\n    if (!session) {\n        return;\n    }\n    const tracingOption = configuration.allowedTracingUrls.find((tracingOption) => matchList([tracingOption.match], context.url, true));\n    if (!tracingOption) {\n        return;\n    }\n    const traceSampled = isSampled(session.id, configuration.traceSampleRate);\n    const shouldInjectHeaders = traceSampled || configuration.traceContextInjection === TraceContextInjection.ALL;\n    if (!shouldInjectHeaders) {\n        return;\n    }\n    context.traceSampled = traceSampled;\n    context.traceId = createTraceIdentifier();\n    context.spanId = createSpanIdentifier();\n    inject(makeTracingHeaders(context.traceId, context.spanId, context.traceSampled, session.id, tracingOption.propagatorTypes, userContext, accountContext, configuration));\n}\n/**\n * When trace is not sampled, set priority to '0' instead of not adding the tracing headers\n * to prepare the implementation for sampling delegation.\n */\nfunction makeTracingHeaders(traceId, spanId, traceSampled, sessionId, propagatorTypes, userContext, accountContext, configuration) {\n    const tracingHeaders = {};\n    propagatorTypes.forEach((propagatorType) => {\n        switch (propagatorType) {\n            case 'datadog': {\n                Object.assign(tracingHeaders, {\n                    'x-datadog-origin': 'rum',\n                    'x-datadog-parent-id': spanId.toString(),\n                    'x-datadog-sampling-priority': traceSampled ? '1' : '0',\n                    'x-datadog-trace-id': traceId.toString(),\n                });\n                break;\n            }\n            // https://www.w3.org/TR/trace-context/\n            case 'tracecontext': {\n                Object.assign(tracingHeaders, {\n                    traceparent: `00-0000000000000000${toPaddedHexadecimalString(traceId)}-${toPaddedHexadecimalString(spanId)}-0${traceSampled ? '1' : '0'}`,\n                    tracestate: `dd=s:${traceSampled ? '1' : '0'};o:rum`,\n                });\n                break;\n            }\n            // https://github.com/openzipkin/b3-propagation\n            case 'b3': {\n                Object.assign(tracingHeaders, {\n                    b3: `${toPaddedHexadecimalString(traceId)}-${toPaddedHexadecimalString(spanId)}-${traceSampled ? '1' : '0'}`,\n                });\n                break;\n            }\n            case 'b3multi': {\n                Object.assign(tracingHeaders, {\n                    'X-B3-TraceId': toPaddedHexadecimalString(traceId),\n                    'X-B3-SpanId': toPaddedHexadecimalString(spanId),\n                    'X-B3-Sampled': traceSampled ? '1' : '0',\n                });\n                break;\n            }\n        }\n    });\n    if (configuration.propagateTraceBaggage) {\n        const baggageItems = {\n            'session.id': sessionId,\n        };\n        const userId = userContext.getContext().id;\n        if (typeof userId === 'string') {\n            baggageItems['user.id'] = userId;\n        }\n        const accountId = accountContext.getContext().id;\n        if (typeof accountId === 'string') {\n            baggageItems['account.id'] = accountId;\n        }\n        const baggageHeader = Object.entries(baggageItems)\n            .map(([key, value]) => `${key}=${encodeURIComponent(value)}`)\n            .join(',');\n        if (baggageHeader) {\n            tracingHeaders['baggage'] = baggageHeader;\n        }\n    }\n    return tracingHeaders;\n}\n//# sourceMappingURL=tracer.js.map","import { getType, isMatchOption, serializeConfiguration, DefaultPrivacyLevel, TraceContextInjection, display, objectHasValue, validateAndBuildConfiguration, isSampleRate, isNumber, isNonEmptyArray, } from '@datadog/browser-core';\nimport { isTracingOption } from '../tracing/tracer';\nexport const DEFAULT_PROPAGATOR_TYPES = ['tracecontext', 'datadog'];\nexport function validateAndBuildRumConfiguration(initConfiguration, errorStack) {\n    var _a, _b, _c, _d, _e, _f, _g;\n    if (initConfiguration.trackFeatureFlagsForEvents !== undefined &&\n        !Array.isArray(initConfiguration.trackFeatureFlagsForEvents)) {\n        display.warn('trackFeatureFlagsForEvents should be an array');\n    }\n    if (!initConfiguration.applicationId) {\n        display.error('Application ID is not configured, no RUM data will be collected.');\n        return;\n    }\n    if (!isSampleRate(initConfiguration.sessionReplaySampleRate, 'Session Replay') ||\n        !isSampleRate(initConfiguration.traceSampleRate, 'Trace')) {\n        return;\n    }\n    if (initConfiguration.excludedActivityUrls !== undefined && !Array.isArray(initConfiguration.excludedActivityUrls)) {\n        display.error('Excluded Activity Urls should be an array');\n        return;\n    }\n    const allowedTracingUrls = validateAndBuildTracingOptions(initConfiguration);\n    if (!allowedTracingUrls) {\n        return;\n    }\n    const baseConfiguration = validateAndBuildConfiguration(initConfiguration, errorStack);\n    const allowedGraphQlUrls = validateAndBuildGraphQlOptions(initConfiguration);\n    if (!baseConfiguration) {\n        return;\n    }\n    const sessionReplaySampleRate = (_a = initConfiguration.sessionReplaySampleRate) !== null && _a !== void 0 ? _a : 0;\n    return {\n        applicationId: initConfiguration.applicationId,\n        actionNameAttribute: initConfiguration.actionNameAttribute,\n        sessionReplaySampleRate,\n        startSessionReplayRecordingManually: initConfiguration.startSessionReplayRecordingManually !== undefined\n            ? !!initConfiguration.startSessionReplayRecordingManually\n            : sessionReplaySampleRate === 0,\n        traceSampleRate: (_b = initConfiguration.traceSampleRate) !== null && _b !== void 0 ? _b : 100,\n        rulePsr: isNumber(initConfiguration.traceSampleRate) ? initConfiguration.traceSampleRate / 100 : undefined,\n        allowedTracingUrls,\n        excludedActivityUrls: (_c = initConfiguration.excludedActivityUrls) !== null && _c !== void 0 ? _c : [],\n        workerUrl: initConfiguration.workerUrl,\n        compressIntakeRequests: !!initConfiguration.compressIntakeRequests,\n        trackUserInteractions: !!((_d = initConfiguration.trackUserInteractions) !== null && _d !== void 0 ? _d : true),\n        trackViewsManually: !!initConfiguration.trackViewsManually,\n        trackResources: !!((_e = initConfiguration.trackResources) !== null && _e !== void 0 ? _e : true),\n        trackLongTasks: !!((_f = initConfiguration.trackLongTasks) !== null && _f !== void 0 ? _f : true),\n        trackBfcacheViews: !!initConfiguration.trackBfcacheViews,\n        trackEarlyRequests: !!initConfiguration.trackEarlyRequests,\n        subdomain: initConfiguration.subdomain,\n        defaultPrivacyLevel: objectHasValue(DefaultPrivacyLevel, initConfiguration.defaultPrivacyLevel)\n            ? initConfiguration.defaultPrivacyLevel\n            : DefaultPrivacyLevel.MASK,\n        enablePrivacyForActionName: !!initConfiguration.enablePrivacyForActionName,\n        traceContextInjection: objectHasValue(TraceContextInjection, initConfiguration.traceContextInjection)\n            ? initConfiguration.traceContextInjection\n            : TraceContextInjection.SAMPLED,\n        plugins: initConfiguration.plugins || [],\n        trackFeatureFlagsForEvents: initConfiguration.trackFeatureFlagsForEvents || [],\n        profilingSampleRate: (_g = initConfiguration.profilingSampleRate) !== null && _g !== void 0 ? _g : 0,\n        propagateTraceBaggage: !!initConfiguration.propagateTraceBaggage,\n        allowedGraphQlUrls,\n        ...baseConfiguration,\n    };\n}\n/**\n * Validates allowedTracingUrls and converts match options to tracing options\n */\nfunction validateAndBuildTracingOptions(initConfiguration) {\n    if (initConfiguration.allowedTracingUrls === undefined) {\n        return [];\n    }\n    if (!Array.isArray(initConfiguration.allowedTracingUrls)) {\n        display.error('Allowed Tracing URLs should be an array');\n        return;\n    }\n    if (initConfiguration.allowedTracingUrls.length !== 0 && initConfiguration.service === undefined) {\n        display.error('Service needs to be configured when tracing is enabled');\n        return;\n    }\n    // Convert from (MatchOption | TracingOption) to TracingOption, remove unknown properties\n    const tracingOptions = [];\n    initConfiguration.allowedTracingUrls.forEach((option) => {\n        if (isMatchOption(option)) {\n            tracingOptions.push({ match: option, propagatorTypes: DEFAULT_PROPAGATOR_TYPES });\n        }\n        else if (isTracingOption(option)) {\n            tracingOptions.push(option);\n        }\n        else {\n            display.warn('Allowed Tracing Urls parameters should be a string, RegExp, function, or an object. Ignoring parameter', option);\n        }\n    });\n    return tracingOptions;\n}\n/**\n * Combines the selected tracing propagators from the different options in allowedTracingUrls\n */\nfunction getSelectedTracingPropagators(configuration) {\n    const usedTracingPropagators = new Set();\n    if (isNonEmptyArray(configuration.allowedTracingUrls)) {\n        configuration.allowedTracingUrls.forEach((option) => {\n            if (isMatchOption(option)) {\n                DEFAULT_PROPAGATOR_TYPES.forEach((propagatorType) => usedTracingPropagators.add(propagatorType));\n            }\n            else if (getType(option) === 'object' && Array.isArray(option.propagatorTypes)) {\n                // Ensure we have an array, as we cannot rely on types yet (configuration is provided by users)\n                option.propagatorTypes.forEach((propagatorType) => usedTracingPropagators.add(propagatorType));\n            }\n        });\n    }\n    return Array.from(usedTracingPropagators);\n}\n/**\n * Build GraphQL options from configuration\n */\nfunction validateAndBuildGraphQlOptions(initConfiguration) {\n    if (!initConfiguration.allowedGraphQlUrls) {\n        return [];\n    }\n    if (!Array.isArray(initConfiguration.allowedGraphQlUrls)) {\n        display.warn('allowedGraphQlUrls should be an array');\n        return [];\n    }\n    const graphQlOptions = [];\n    initConfiguration.allowedGraphQlUrls.forEach((option) => {\n        if (isMatchOption(option)) {\n            graphQlOptions.push({ match: option, trackPayload: false, trackResponseErrors: false });\n        }\n        else if (option && typeof option === 'object' && 'match' in option && isMatchOption(option.match)) {\n            graphQlOptions.push({\n                match: option.match,\n                trackPayload: !!option.trackPayload,\n                trackResponseErrors: !!option.trackResponseErrors,\n            });\n        }\n    });\n    return graphQlOptions;\n}\nfunction hasGraphQlPayloadTracking(allowedGraphQlUrls) {\n    return (isNonEmptyArray(allowedGraphQlUrls) &&\n        allowedGraphQlUrls.some((option) => {\n            if (typeof option === 'object' && 'trackPayload' in option) {\n                return !!option.trackPayload;\n            }\n            return false;\n        }));\n}\nfunction hasGraphQlResponseErrorsTracking(allowedGraphQlUrls) {\n    return (isNonEmptyArray(allowedGraphQlUrls) &&\n        allowedGraphQlUrls.some((option) => {\n            if (typeof option === 'object' && 'trackResponseErrors' in option) {\n                return !!option.trackResponseErrors;\n            }\n            return false;\n        }));\n}\nexport function serializeRumConfiguration(configuration) {\n    var _a;\n    const baseSerializedConfiguration = serializeConfiguration(configuration);\n    return {\n        session_replay_sample_rate: configuration.sessionReplaySampleRate,\n        start_session_replay_recording_manually: configuration.startSessionReplayRecordingManually,\n        trace_sample_rate: configuration.traceSampleRate,\n        trace_context_injection: configuration.traceContextInjection,\n        propagate_trace_baggage: configuration.propagateTraceBaggage,\n        action_name_attribute: configuration.actionNameAttribute,\n        use_allowed_tracing_urls: isNonEmptyArray(configuration.allowedTracingUrls),\n        use_allowed_graph_ql_urls: isNonEmptyArray(configuration.allowedGraphQlUrls),\n        use_track_graph_ql_payload: hasGraphQlPayloadTracking(configuration.allowedGraphQlUrls),\n        use_track_graph_ql_response_errors: hasGraphQlResponseErrorsTracking(configuration.allowedGraphQlUrls),\n        selected_tracing_propagators: getSelectedTracingPropagators(configuration),\n        default_privacy_level: configuration.defaultPrivacyLevel,\n        enable_privacy_for_action_name: configuration.enablePrivacyForActionName,\n        use_excluded_activity_urls: isNonEmptyArray(configuration.excludedActivityUrls),\n        use_worker_url: !!configuration.workerUrl,\n        compress_intake_requests: configuration.compressIntakeRequests,\n        track_views_manually: configuration.trackViewsManually,\n        track_user_interactions: configuration.trackUserInteractions,\n        track_resources: configuration.trackResources,\n        track_long_task: configuration.trackLongTasks,\n        track_bfcache_views: configuration.trackBfcacheViews,\n        track_early_requests: configuration.trackEarlyRequests,\n        plugins: (_a = configuration.plugins) === null || _a === void 0 ? void 0 : _a.map((plugin) => {\n            var _a;\n            return ({\n                name: plugin.name,\n                ...(_a = plugin.getConfigurationTelemetry) === null || _a === void 0 ? void 0 : _a.call(plugin),\n            });\n        }),\n        track_feature_flags_for_events: configuration.trackFeatureFlagsForEvents,\n        remote_configuration_id: configuration.remoteConfigurationId,\n        profiling_sample_rate: configuration.profilingSampleRate,\n        use_remote_configuration_proxy: !!configuration.remoteConfigurationProxy,\n        ...baseSerializedConfiguration,\n    };\n}\n//# sourceMappingURL=configuration.js.map","/**\n * Terminology inspired from https://www.rfc-editor.org/rfc/rfc9535.html\n *\n * jsonpath-query      = segment*\n * segment             = .name-shorthand / bracketed-selection\n * bracketed-selection = ['name-selector'] / [\"name-selector\"] / [index-selector]\n *\n * Useful references:\n * - https://goessner.net/articles/JsonPath/\n * - https://jsonpath.com/\n * - https://github.com/jsonpath-standard\n */\n/**\n * Extract selectors from a simple JSON path expression, return [] for an invalid path\n *\n * Supports:\n * - Dot notation: `foo.bar.baz`\n * - Bracket notation: `['foo'][\"bar\"]`\n * - Array indices: `items[0]`, `data['users'][1]`\n *\n * Examples:\n * parseJsonPath(\"['foo'].bar[12]\")\n * => ['foo', 'bar', '12']\n *\n * parseJsonPath(\"['foo\")\n * => []\n */\nexport function parseJsonPath(path) {\n    const selectors = [];\n    let previousToken = 0 /* Token.START */;\n    let currentToken;\n    const parsingContext = { quote: undefined, escapeSequence: undefined };\n    let currentSelector = '';\n    for (const char of path) {\n        // find which kind of token is this char\n        currentToken = ALLOWED_NEXT_TOKENS[previousToken].find((token) => TOKEN_PREDICATE[token](char, parsingContext));\n        if (!currentToken) {\n            return [];\n        }\n        if (parsingContext.escapeSequence !== undefined && currentToken !== 12 /* Token.ESCAPE_SEQUENCE_CHAR */) {\n            if (!isValidEscapeSequence(parsingContext.escapeSequence)) {\n                return [];\n            }\n            currentSelector += resolveEscapeSequence(parsingContext.escapeSequence);\n            parsingContext.escapeSequence = undefined;\n        }\n        if (ALLOWED_SELECTOR_TOKENS.includes(currentToken)) {\n            // buffer the char if it belongs to the selector\n            // ex: foo['bar']\n            //      ^    ^\n            currentSelector += char;\n        }\n        else if (ALLOWED_SELECTOR_DELIMITER_TOKENS.includes(currentToken) && currentSelector !== '') {\n            // close the current path part if we have reach a path part delimiter\n            // ex: foo.bar['qux']\n            //        ^   ^     ^\n            selectors.push(currentSelector);\n            currentSelector = '';\n        }\n        else if (currentToken === 12 /* Token.ESCAPE_SEQUENCE_CHAR */) {\n            parsingContext.escapeSequence = parsingContext.escapeSequence ? `${parsingContext.escapeSequence}${char}` : char;\n        }\n        else if (currentToken === 8 /* Token.QUOTE_START */) {\n            parsingContext.quote = char;\n        }\n        else if (currentToken === 9 /* Token.QUOTE_END */) {\n            parsingContext.quote = undefined;\n        }\n        previousToken = currentToken;\n    }\n    if (!ALLOWED_NEXT_TOKENS[previousToken].includes(1 /* Token.END */)) {\n        return [];\n    }\n    if (currentSelector !== '') {\n        selectors.push(currentSelector);\n    }\n    return selectors;\n}\nconst NAME_SHORTHAND_FIRST_CHAR_REGEX = /[a-zA-Z_$]/;\nconst NAME_SHORTHAND_CHAR_REGEX = /[a-zA-Z0-9_$]/;\nconst DIGIT_REGEX = /[0-9]/;\nconst UNICODE_CHAR_REGEX = /[a-fA-F0-9]/;\nconst QUOTE_CHARS = '\\'\"';\nconst TOKEN_PREDICATE = {\n    // no char should match to START or END\n    [0 /* Token.START */]: () => false,\n    [1 /* Token.END */]: () => false,\n    [2 /* Token.NAME_SHORTHAND_FIRST_CHAR */]: (char) => NAME_SHORTHAND_FIRST_CHAR_REGEX.test(char),\n    [3 /* Token.NAME_SHORTHAND_CHAR */]: (char) => NAME_SHORTHAND_CHAR_REGEX.test(char),\n    [4 /* Token.DOT */]: (char) => char === '.',\n    [5 /* Token.BRACKET_START */]: (char) => char === '[',\n    [6 /* Token.BRACKET_END */]: (char) => char === ']',\n    [7 /* Token.DIGIT */]: (char) => DIGIT_REGEX.test(char),\n    [8 /* Token.QUOTE_START */]: (char) => QUOTE_CHARS.includes(char),\n    [9 /* Token.QUOTE_END */]: (char, parsingContext) => char === parsingContext.quote,\n    [10 /* Token.NAME_SELECTOR_CHAR */]: () => true, // any char can be used in name selector\n    [11 /* Token.ESCAPE */]: (char) => char === '\\\\',\n    [12 /* Token.ESCAPE_SEQUENCE_CHAR */]: (char, parsingContext) => {\n        if (parsingContext.escapeSequence === undefined) {\n            // see https://www.rfc-editor.org/rfc/rfc9535.html#name-semantics-3\n            return `${parsingContext.quote}/\\\\bfnrtu`.includes(char);\n        }\n        else if (parsingContext.escapeSequence.startsWith('u') && parsingContext.escapeSequence.length < 5) {\n            return UNICODE_CHAR_REGEX.test(char);\n        }\n        return false;\n    },\n};\nconst ALLOWED_NEXT_TOKENS = {\n    [0 /* Token.START */]: [2 /* Token.NAME_SHORTHAND_FIRST_CHAR */, 5 /* Token.BRACKET_START */],\n    [1 /* Token.END */]: [],\n    [2 /* Token.NAME_SHORTHAND_FIRST_CHAR */]: [3 /* Token.NAME_SHORTHAND_CHAR */, 4 /* Token.DOT */, 5 /* Token.BRACKET_START */, 1 /* Token.END */],\n    [3 /* Token.NAME_SHORTHAND_CHAR */]: [3 /* Token.NAME_SHORTHAND_CHAR */, 4 /* Token.DOT */, 5 /* Token.BRACKET_START */, 1 /* Token.END */],\n    [4 /* Token.DOT */]: [2 /* Token.NAME_SHORTHAND_FIRST_CHAR */],\n    [5 /* Token.BRACKET_START */]: [8 /* Token.QUOTE_START */, 7 /* Token.DIGIT */],\n    [6 /* Token.BRACKET_END */]: [4 /* Token.DOT */, 5 /* Token.BRACKET_START */, 1 /* Token.END */],\n    [7 /* Token.DIGIT */]: [7 /* Token.DIGIT */, 6 /* Token.BRACKET_END */],\n    [8 /* Token.QUOTE_START */]: [11 /* Token.ESCAPE */, 9 /* Token.QUOTE_END */, 10 /* Token.NAME_SELECTOR_CHAR */],\n    [9 /* Token.QUOTE_END */]: [6 /* Token.BRACKET_END */],\n    [10 /* Token.NAME_SELECTOR_CHAR */]: [11 /* Token.ESCAPE */, 9 /* Token.QUOTE_END */, 10 /* Token.NAME_SELECTOR_CHAR */],\n    [11 /* Token.ESCAPE */]: [12 /* Token.ESCAPE_SEQUENCE_CHAR */],\n    [12 /* Token.ESCAPE_SEQUENCE_CHAR */]: [12 /* Token.ESCAPE_SEQUENCE_CHAR */, 11 /* Token.ESCAPE */, 9 /* Token.QUOTE_END */, 10 /* Token.NAME_SELECTOR_CHAR */],\n};\n// foo['bar\\n'][12]\n// ^^    ^ ^^   ^\nconst ALLOWED_SELECTOR_TOKENS = [\n    2 /* Token.NAME_SHORTHAND_FIRST_CHAR */,\n    3 /* Token.NAME_SHORTHAND_CHAR */,\n    7 /* Token.DIGIT */,\n    10 /* Token.NAME_SELECTOR_CHAR */,\n];\n// foo.bar['qux']\n//    ^   ^     ^\nconst ALLOWED_SELECTOR_DELIMITER_TOKENS = [4 /* Token.DOT */, 5 /* Token.BRACKET_START */, 6 /* Token.BRACKET_END */];\nfunction isValidEscapeSequence(escapeSequence) {\n    return '\"\\'/\\\\bfnrt'.includes(escapeSequence) || (escapeSequence.startsWith('u') && escapeSequence.length === 5);\n}\nconst ESCAPED_CHARS = {\n    '\"': '\"',\n    \"'\": \"'\",\n    '/': '/',\n    '\\\\': '\\\\',\n    b: '\\b',\n    f: '\\f',\n    n: '\\n',\n    r: '\\r',\n    t: '\\t',\n};\nfunction resolveEscapeSequence(escapeSequence) {\n    if (escapeSequence.startsWith('u')) {\n        // build Unicode char from code\n        return String.fromCharCode(parseInt(escapeSequence.slice(1), 16));\n    }\n    return ESCAPED_CHARS[escapeSequence];\n}\n//# sourceMappingURL=jsonPathParser.js.map","import { display, buildEndpointHost, mapValues, getCookie, addTelemetryMetrics, } from '@datadog/browser-core';\nimport { parseJsonPath } from './jsonPathParser';\nconst REMOTE_CONFIGURATION_VERSION = 'v1';\nconst SUPPORTED_FIELDS = [\n    'applicationId',\n    'service',\n    'env',\n    'version',\n    'sessionSampleRate',\n    'sessionReplaySampleRate',\n    'defaultPrivacyLevel',\n    'enablePrivacyForActionName',\n    'traceSampleRate',\n    'trackSessionAcrossSubdomains',\n    'allowedTracingUrls',\n    'allowedTrackingOrigins',\n];\nexport async function fetchAndApplyRemoteConfiguration(initConfiguration, supportedContextManagers) {\n    let rumInitConfiguration;\n    const metrics = initMetrics();\n    const fetchResult = await fetchRemoteConfiguration(initConfiguration);\n    if (!fetchResult.ok) {\n        metrics.increment('fetch', 'failure');\n        display.error(fetchResult.error);\n    }\n    else {\n        metrics.increment('fetch', 'success');\n        rumInitConfiguration = applyRemoteConfiguration(initConfiguration, fetchResult.value, supportedContextManagers, metrics);\n    }\n    // monitor-until: forever\n    addTelemetryMetrics(\"remote configuration metrics\" /* TelemetryMetrics.REMOTE_CONFIGURATION_METRIC_NAME */, { metrics: metrics.get() });\n    return rumInitConfiguration;\n}\nexport function applyRemoteConfiguration(initConfiguration, rumRemoteConfiguration, supportedContextManagers, metrics) {\n    // intents:\n    // - explicitly set each supported field to limit risk in case an attacker can create configurations\n    // - check the existence in the remote config to avoid clearing a provided init field\n    const appliedConfiguration = { ...initConfiguration };\n    SUPPORTED_FIELDS.forEach((option) => {\n        if (option in rumRemoteConfiguration) {\n            appliedConfiguration[option] = resolveConfigurationProperty(rumRemoteConfiguration[option]);\n        }\n    });\n    Object.keys(supportedContextManagers).forEach((context) => {\n        if (rumRemoteConfiguration[context] !== undefined) {\n            resolveContextProperty(supportedContextManagers[context], rumRemoteConfiguration[context]);\n        }\n    });\n    return appliedConfiguration;\n    // share context to access metrics\n    function resolveConfigurationProperty(property) {\n        if (Array.isArray(property)) {\n            return property.map(resolveConfigurationProperty);\n        }\n        if (isObject(property)) {\n            if (isSerializedOption(property)) {\n                const type = property.rcSerializedType;\n                switch (type) {\n                    case 'string':\n                        return property.value;\n                    case 'regex':\n                        return resolveRegex(property.value);\n                    case 'dynamic':\n                        return resolveDynamicOption(property);\n                    default:\n                        display.error(`Unsupported remote configuration: \"rcSerializedType\": \"${type}\"`);\n                        return;\n                }\n            }\n            return mapValues(property, resolveConfigurationProperty);\n        }\n        return property;\n    }\n    function resolveContextProperty(contextManager, contextItems) {\n        contextItems.forEach(({ key, value }) => {\n            contextManager.setContextProperty(key, resolveConfigurationProperty(value));\n        });\n    }\n    function resolveDynamicOption(property) {\n        const strategy = property.strategy;\n        let resolvedValue;\n        switch (strategy) {\n            case 'cookie':\n                resolvedValue = resolveCookieValue(property);\n                break;\n            case 'dom':\n                resolvedValue = resolveDomValue(property);\n                break;\n            case 'js':\n                resolvedValue = resolveJsValue(property);\n                break;\n            default:\n                display.error(`Unsupported remote configuration: \"strategy\": \"${strategy}\"`);\n                return;\n        }\n        const extractor = property.extractor;\n        if (extractor !== undefined && typeof resolvedValue === 'string') {\n            return extractValue(extractor, resolvedValue);\n        }\n        return resolvedValue;\n    }\n    function resolveCookieValue({ name }) {\n        const value = getCookie(name);\n        metrics.increment('cookie', value !== undefined ? 'success' : 'missing');\n        return value;\n    }\n    function resolveDomValue({ selector, attribute }) {\n        let element;\n        try {\n            element = document.querySelector(selector);\n        }\n        catch (_a) {\n            display.error(`Invalid selector in the remote configuration: '${selector}'`);\n            metrics.increment('dom', 'failure');\n            return;\n        }\n        if (!element) {\n            metrics.increment('dom', 'missing');\n            return;\n        }\n        if (isForbidden(element, attribute)) {\n            display.error(`Forbidden element selected by the remote configuration: '${selector}'`);\n            metrics.increment('dom', 'failure');\n            return;\n        }\n        const domValue = attribute !== undefined ? element.getAttribute(attribute) : element.textContent;\n        if (domValue === null) {\n            metrics.increment('dom', 'missing');\n            return;\n        }\n        metrics.increment('dom', 'success');\n        return domValue;\n    }\n    function isForbidden(element, attribute) {\n        return element.getAttribute('type') === 'password' && attribute === 'value';\n    }\n    function resolveJsValue({ path }) {\n        let current = window;\n        const pathParts = parseJsonPath(path);\n        if (pathParts.length === 0) {\n            display.error(`Invalid JSON path in the remote configuration: '${path}'`);\n            metrics.increment('js', 'failure');\n            return;\n        }\n        for (const pathPart of pathParts) {\n            if (!(pathPart in current)) {\n                metrics.increment('js', 'missing');\n                return;\n            }\n            try {\n                current = current[pathPart];\n            }\n            catch (e) {\n                display.error(`Error accessing: '${path}'`, e);\n                metrics.increment('js', 'failure');\n                return;\n            }\n        }\n        metrics.increment('js', 'success');\n        return current;\n    }\n}\nexport function initMetrics() {\n    const metrics = { fetch: {} };\n    return {\n        get: () => metrics,\n        increment: (metricName, type) => {\n            if (!metrics[metricName]) {\n                metrics[metricName] = {};\n            }\n            if (!metrics[metricName][type]) {\n                metrics[metricName][type] = 0;\n            }\n            metrics[metricName][type] = metrics[metricName][type] + 1;\n        },\n    };\n}\nfunction isObject(property) {\n    return typeof property === 'object' && property !== null;\n}\nfunction isSerializedOption(value) {\n    return 'rcSerializedType' in value;\n}\nfunction resolveRegex(pattern) {\n    try {\n        return new RegExp(pattern);\n    }\n    catch (_a) {\n        display.error(`Invalid regex in the remote configuration: '${pattern}'`);\n    }\n}\nfunction extractValue(extractor, candidate) {\n    const resolvedExtractor = resolveRegex(extractor.value);\n    if (resolvedExtractor === undefined) {\n        return;\n    }\n    const regexResult = resolvedExtractor.exec(candidate);\n    if (regexResult === null) {\n        return;\n    }\n    const [match, capture] = regexResult;\n    return capture ? capture : match;\n}\nexport async function fetchRemoteConfiguration(configuration) {\n    let response;\n    try {\n        response = await fetch(buildEndpoint(configuration));\n    }\n    catch (_a) {\n        response = undefined;\n    }\n    if (!response || !response.ok) {\n        return {\n            ok: false,\n            error: new Error('Error fetching the remote configuration.'),\n        };\n    }\n    const remoteConfiguration = await response.json();\n    if (remoteConfiguration.rum) {\n        return {\n            ok: true,\n            value: remoteConfiguration.rum,\n        };\n    }\n    return {\n        ok: false,\n        error: new Error('No remote configuration for RUM.'),\n    };\n}\nexport function buildEndpoint(configuration) {\n    if (configuration.remoteConfigurationProxy) {\n        return configuration.remoteConfigurationProxy;\n    }\n    return `https://sdk-configuration.${buildEndpointHost('rum', configuration)}/${REMOTE_CONFIGURATION_VERSION}/${encodeURIComponent(configuration.remoteConfigurationId)}.json`;\n}\n//# sourceMappingURL=remoteConfiguration.js.map","import { createBoundedBuffer, display, canUseEventBridge, displayAlreadyInitializedError, willSyntheticsInjectRum, noop, timeStampNow, clocksNow, getEventBridge, initFeatureFlags, addTelemetryConfiguration, initFetchObservable, CustomerContextKey, buildAccountContextManager, buildGlobalContextManager, buildUserContextManager, monitorError, sanitize, } from '@datadog/browser-core';\nimport { validateAndBuildRumConfiguration, fetchAndApplyRemoteConfiguration, serializeRumConfiguration, } from '../domain/configuration';\nimport { startDurationVital, stopDurationVital } from '../domain/vital/vitalCollection';\nimport { callPluginsMethod } from '../domain/plugins';\nexport function createPreStartStrategy({ ignoreInitIfSyntheticsWillInjectRum = true, startDeflateWorker }, trackingConsentState, customVitalsState, doStartRum) {\n    const bufferApiCalls = createBoundedBuffer();\n    // TODO next major: remove the globalContextManager, userContextManager and accountContextManager from preStartStrategy and use an empty context instead\n    const globalContext = buildGlobalContextManager();\n    bufferContextCalls(globalContext, CustomerContextKey.globalContext, bufferApiCalls);\n    const userContext = buildUserContextManager();\n    bufferContextCalls(userContext, CustomerContextKey.userContext, bufferApiCalls);\n    const accountContext = buildAccountContextManager();\n    bufferContextCalls(accountContext, CustomerContextKey.accountContext, bufferApiCalls);\n    let firstStartViewCall;\n    let deflateWorker;\n    let cachedInitConfiguration;\n    let cachedConfiguration;\n    const trackingConsentStateSubscription = trackingConsentState.observable.subscribe(tryStartRum);\n    const emptyContext = {};\n    function tryStartRum() {\n        if (!cachedInitConfiguration || !cachedConfiguration || !trackingConsentState.isGranted()) {\n            return;\n        }\n        trackingConsentStateSubscription.unsubscribe();\n        let initialViewOptions;\n        if (cachedConfiguration.trackViewsManually) {\n            if (!firstStartViewCall) {\n                return;\n            }\n            // An initial view is always created when starting RUM.\n            // When tracking views automatically, any startView call before RUM start creates an extra\n            // view.\n            // When tracking views manually, we use the ViewOptions from the first startView call as the\n            // initial view options, and we remove the actual startView call so we don't create an extra\n            // view.\n            bufferApiCalls.remove(firstStartViewCall.callback);\n            initialViewOptions = firstStartViewCall.options;\n        }\n        const startRumResult = doStartRum(cachedConfiguration, deflateWorker, initialViewOptions);\n        bufferApiCalls.drain(startRumResult);\n    }\n    function doInit(initConfiguration, errorStack) {\n        const eventBridgeAvailable = canUseEventBridge();\n        if (eventBridgeAvailable) {\n            initConfiguration = overrideInitConfigurationForBridge(initConfiguration);\n        }\n        // Update the exposed initConfiguration to reflect the bridge and remote configuration overrides\n        cachedInitConfiguration = initConfiguration;\n        addTelemetryConfiguration(serializeRumConfiguration(initConfiguration));\n        if (cachedConfiguration) {\n            displayAlreadyInitializedError('DD_RUM', initConfiguration);\n            return;\n        }\n        const configuration = validateAndBuildRumConfiguration(initConfiguration, errorStack);\n        if (!configuration) {\n            return;\n        }\n        if (!eventBridgeAvailable && !configuration.sessionStoreStrategyType) {\n            display.warn('No storage available for session. We will not send any data.');\n            return;\n        }\n        if (configuration.compressIntakeRequests && !eventBridgeAvailable && startDeflateWorker) {\n            deflateWorker = startDeflateWorker(configuration, 'Datadog RUM', \n            // Worker initialization can fail asynchronously, especially in Firefox where even CSP\n            // issues are reported asynchronously. For now, the SDK will continue its execution even if\n            // data won't be sent to Datadog. We could improve this behavior in the future.\n            noop);\n            if (!deflateWorker) {\n                // `startDeflateWorker` should have logged an error message explaining the issue\n                return;\n            }\n        }\n        cachedConfiguration = configuration;\n        // Instrument fetch to track network requests\n        // This is needed in case the consent is not granted and some customer\n        // library (Apollo Client) is storing uninstrumented fetch to be used later\n        // The subscription is needed so that the instrumentation process is completed\n        initFetchObservable().subscribe(noop);\n        trackingConsentState.tryToInit(configuration.trackingConsent);\n        tryStartRum();\n    }\n    const addDurationVital = (vital) => {\n        bufferApiCalls.add((startRumResult) => startRumResult.addDurationVital(vital));\n    };\n    const addOperationStepVital = (name, stepType, options, failureReason) => {\n        bufferApiCalls.add((startRumResult) => startRumResult.addOperationStepVital(sanitize(name), stepType, sanitize(options), sanitize(failureReason)));\n    };\n    const strategy = {\n        init(initConfiguration, publicApi, errorStack) {\n            if (!initConfiguration) {\n                display.error('Missing configuration');\n                return;\n            }\n            // Set the experimental feature flags as early as possible, so we can use them in most places\n            initFeatureFlags(initConfiguration.enableExperimentalFeatures);\n            // Expose the initial configuration regardless of initialization success.\n            cachedInitConfiguration = initConfiguration;\n            // If we are in a Synthetics test configured to automatically inject a RUM instance, we want\n            // to completely discard the customer application RUM instance by ignoring their init() call.\n            // But, we should not ignore the init() call from the Synthetics-injected RUM instance, so the\n            // internal `ignoreInitIfSyntheticsWillInjectRum` option is here to bypass this condition.\n            if (ignoreInitIfSyntheticsWillInjectRum && willSyntheticsInjectRum()) {\n                return;\n            }\n            callPluginsMethod(initConfiguration.plugins, 'onInit', { initConfiguration, publicApi });\n            if (initConfiguration.remoteConfigurationId) {\n                fetchAndApplyRemoteConfiguration(initConfiguration, { user: userContext, context: globalContext })\n                    .then((initConfiguration) => {\n                    if (initConfiguration) {\n                        doInit(initConfiguration, errorStack);\n                    }\n                })\n                    .catch(monitorError);\n            }\n            else {\n                doInit(initConfiguration, errorStack);\n            }\n        },\n        get initConfiguration() {\n            return cachedInitConfiguration;\n        },\n        getInternalContext: noop,\n        stopSession: noop,\n        addTiming(name, time = timeStampNow()) {\n            bufferApiCalls.add((startRumResult) => startRumResult.addTiming(name, time));\n        },\n        startView(options, startClocks = clocksNow()) {\n            const callback = (startRumResult) => {\n                startRumResult.startView(options, startClocks);\n            };\n            bufferApiCalls.add(callback);\n            if (!firstStartViewCall) {\n                firstStartViewCall = { options, callback };\n                tryStartRum();\n            }\n        },\n        setViewName(name) {\n            bufferApiCalls.add((startRumResult) => startRumResult.setViewName(name));\n        },\n        // View context APIs\n        setViewContext(context) {\n            bufferApiCalls.add((startRumResult) => startRumResult.setViewContext(context));\n        },\n        setViewContextProperty(key, value) {\n            bufferApiCalls.add((startRumResult) => startRumResult.setViewContextProperty(key, value));\n        },\n        getViewContext: () => emptyContext,\n        globalContext,\n        userContext,\n        accountContext,\n        addAction(action) {\n            bufferApiCalls.add((startRumResult) => startRumResult.addAction(action));\n        },\n        addError(providedError) {\n            bufferApiCalls.add((startRumResult) => startRumResult.addError(providedError));\n        },\n        addFeatureFlagEvaluation(key, value) {\n            bufferApiCalls.add((startRumResult) => startRumResult.addFeatureFlagEvaluation(key, value));\n        },\n        startDurationVital(name, options) {\n            return startDurationVital(customVitalsState, name, options);\n        },\n        stopDurationVital(name, options) {\n            stopDurationVital(addDurationVital, customVitalsState, name, options);\n        },\n        addDurationVital,\n        addOperationStepVital,\n    };\n    return strategy;\n}\nfunction overrideInitConfigurationForBridge(initConfiguration) {\n    var _a, _b;\n    return {\n        ...initConfiguration,\n        applicationId: '00000000-aaaa-0000-aaaa-000000000000',\n        clientToken: 'empty',\n        sessionSampleRate: 100,\n        defaultPrivacyLevel: (_a = initConfiguration.defaultPrivacyLevel) !== null && _a !== void 0 ? _a : (_b = getEventBridge()) === null || _b === void 0 ? void 0 : _b.getPrivacyLevel(),\n    };\n}\nfunction bufferContextCalls(preStartContextManager, name, bufferApiCalls) {\n    preStartContextManager.changeObservable.subscribe(() => {\n        const context = preStartContextManager.getContext();\n        bufferApiCalls.add((startRumResult) => startRumResult[name].setContext(context));\n    });\n}\n//# sourceMappingURL=preStartRum.js.map","import { ContextManagerMethod, addTelemetryUsage, deepClone, makePublicApi, monitor, clocksNow, callMonitored, createHandlingStack, sanitize, createIdentityEncoder, displayAlreadyInitializedError, createTrackingConsentState, timeStampToClocks, CustomerContextKey, defineContextMethod, startBufferingData, } from '@datadog/browser-core';\nimport { ActionType, VitalType } from '../rawRumEvent.types';\nimport { createCustomVitalsState } from '../domain/vital/vitalCollection';\nimport { callPluginsMethod } from '../domain/plugins';\nimport { createPreStartStrategy } from './preStartRum';\nexport function makeRumPublicApi(startRumImpl, recorderApi, profilerApi, options = {}) {\n    const trackingConsentState = createTrackingConsentState();\n    const customVitalsState = createCustomVitalsState();\n    const bufferedDataObservable = startBufferingData().observable;\n    let strategy = createPreStartStrategy(options, trackingConsentState, customVitalsState, (configuration, deflateWorker, initialViewOptions) => {\n        const createEncoder = deflateWorker && options.createDeflateEncoder\n            ? (streamId) => options.createDeflateEncoder(configuration, deflateWorker, streamId)\n            : createIdentityEncoder;\n        const startRumResult = startRumImpl(configuration, recorderApi, profilerApi, initialViewOptions, createEncoder, trackingConsentState, customVitalsState, bufferedDataObservable, options.sdkName);\n        recorderApi.onRumStart(startRumResult.lifeCycle, configuration, startRumResult.session, startRumResult.viewHistory, deflateWorker, startRumResult.telemetry);\n        profilerApi.onRumStart(startRumResult.lifeCycle, startRumResult.hooks, configuration, startRumResult.session, startRumResult.viewHistory, createEncoder);\n        strategy = createPostStartStrategy(strategy, startRumResult);\n        callPluginsMethod(configuration.plugins, 'onRumStart', {\n            strategy, // TODO: remove this in the next major release\n            addEvent: startRumResult.addEvent,\n        });\n        return startRumResult;\n    });\n    const getStrategy = () => strategy;\n    const startView = monitor((options) => {\n        const sanitizedOptions = typeof options === 'object' ? options : { name: options };\n        strategy.startView(sanitizedOptions);\n        addTelemetryUsage({ feature: 'start-view' });\n    });\n    const rumPublicApi = makePublicApi({\n        init: (initConfiguration) => {\n            const errorStack = new Error().stack;\n            callMonitored(() => strategy.init(initConfiguration, rumPublicApi, errorStack));\n        },\n        setTrackingConsent: monitor((trackingConsent) => {\n            trackingConsentState.update(trackingConsent);\n            addTelemetryUsage({ feature: 'set-tracking-consent', tracking_consent: trackingConsent });\n        }),\n        setViewName: monitor((name) => {\n            strategy.setViewName(name);\n            addTelemetryUsage({ feature: 'set-view-name' });\n        }),\n        setViewContext: monitor((context) => {\n            strategy.setViewContext(context);\n            addTelemetryUsage({ feature: 'set-view-context' });\n        }),\n        setViewContextProperty: monitor((key, value) => {\n            strategy.setViewContextProperty(key, value);\n            addTelemetryUsage({ feature: 'set-view-context-property' });\n        }),\n        getViewContext: monitor(() => {\n            addTelemetryUsage({ feature: 'set-view-context-property' });\n            return strategy.getViewContext();\n        }),\n        getInternalContext: monitor((startTime) => strategy.getInternalContext(startTime)),\n        getInitConfiguration: monitor(() => deepClone(strategy.initConfiguration)),\n        addAction: (name, context) => {\n            const handlingStack = createHandlingStack('action');\n            callMonitored(() => {\n                strategy.addAction({\n                    name: sanitize(name),\n                    context: sanitize(context),\n                    startClocks: clocksNow(),\n                    type: ActionType.CUSTOM,\n                    handlingStack,\n                });\n                addTelemetryUsage({ feature: 'add-action' });\n            });\n        },\n        addError: (error, context) => {\n            const handlingStack = createHandlingStack('error');\n            callMonitored(() => {\n                strategy.addError({\n                    error, // Do not sanitize error here, it is needed unserialized by computeRawError()\n                    handlingStack,\n                    context: sanitize(context),\n                    startClocks: clocksNow(),\n                });\n                addTelemetryUsage({ feature: 'add-error' });\n            });\n        },\n        addTiming: monitor((name, time) => {\n            // TODO: next major decide to drop relative time support or update its behaviour\n            strategy.addTiming(sanitize(name), time);\n        }),\n        setGlobalContext: defineContextMethod(getStrategy, CustomerContextKey.globalContext, ContextManagerMethod.setContext, 'set-global-context'),\n        getGlobalContext: defineContextMethod(getStrategy, CustomerContextKey.globalContext, ContextManagerMethod.getContext, 'get-global-context'),\n        setGlobalContextProperty: defineContextMethod(getStrategy, CustomerContextKey.globalContext, ContextManagerMethod.setContextProperty, 'set-global-context-property'),\n        removeGlobalContextProperty: defineContextMethod(getStrategy, CustomerContextKey.globalContext, ContextManagerMethod.removeContextProperty, 'remove-global-context-property'),\n        clearGlobalContext: defineContextMethod(getStrategy, CustomerContextKey.globalContext, ContextManagerMethod.clearContext, 'clear-global-context'),\n        setUser: defineContextMethod(getStrategy, CustomerContextKey.userContext, ContextManagerMethod.setContext, 'set-user'),\n        getUser: defineContextMethod(getStrategy, CustomerContextKey.userContext, ContextManagerMethod.getContext, 'get-user'),\n        setUserProperty: defineContextMethod(getStrategy, CustomerContextKey.userContext, ContextManagerMethod.setContextProperty, 'set-user-property'),\n        removeUserProperty: defineContextMethod(getStrategy, CustomerContextKey.userContext, ContextManagerMethod.removeContextProperty, 'remove-user-property'),\n        clearUser: defineContextMethod(getStrategy, CustomerContextKey.userContext, ContextManagerMethod.clearContext, 'clear-user'),\n        setAccount: defineContextMethod(getStrategy, CustomerContextKey.accountContext, ContextManagerMethod.setContext, 'set-account'),\n        getAccount: defineContextMethod(getStrategy, CustomerContextKey.accountContext, ContextManagerMethod.getContext, 'get-account'),\n        setAccountProperty: defineContextMethod(getStrategy, CustomerContextKey.accountContext, ContextManagerMethod.setContextProperty, 'set-account-property'),\n        removeAccountProperty: defineContextMethod(getStrategy, CustomerContextKey.accountContext, ContextManagerMethod.removeContextProperty, 'remove-account-property'),\n        clearAccount: defineContextMethod(getStrategy, CustomerContextKey.accountContext, ContextManagerMethod.clearContext, 'clear-account'),\n        startView,\n        stopSession: monitor(() => {\n            strategy.stopSession();\n            addTelemetryUsage({ feature: 'stop-session' });\n        }),\n        addFeatureFlagEvaluation: monitor((key, value) => {\n            strategy.addFeatureFlagEvaluation(sanitize(key), sanitize(value));\n            addTelemetryUsage({ feature: 'add-feature-flag-evaluation' });\n        }),\n        getSessionReplayLink: monitor(() => recorderApi.getSessionReplayLink()),\n        startSessionReplayRecording: monitor((options) => {\n            recorderApi.start(options);\n            addTelemetryUsage({ feature: 'start-session-replay-recording', force: options && options.force });\n        }),\n        stopSessionReplayRecording: monitor(() => recorderApi.stop()),\n        addDurationVital: monitor((name, options) => {\n            addTelemetryUsage({ feature: 'add-duration-vital' });\n            strategy.addDurationVital({\n                name: sanitize(name),\n                type: VitalType.DURATION,\n                startClocks: timeStampToClocks(options.startTime),\n                duration: options.duration,\n                context: sanitize(options && options.context),\n                description: sanitize(options && options.description),\n            });\n        }),\n        startDurationVital: monitor((name, options) => {\n            addTelemetryUsage({ feature: 'start-duration-vital' });\n            return strategy.startDurationVital(sanitize(name), {\n                context: sanitize(options && options.context),\n                description: sanitize(options && options.description),\n            });\n        }),\n        stopDurationVital: monitor((nameOrRef, options) => {\n            addTelemetryUsage({ feature: 'stop-duration-vital' });\n            strategy.stopDurationVital(typeof nameOrRef === 'string' ? sanitize(nameOrRef) : nameOrRef, {\n                context: sanitize(options && options.context),\n                description: sanitize(options && options.description),\n            });\n        }),\n        startFeatureOperation: monitor((name, options) => {\n            addTelemetryUsage({ feature: 'add-operation-step-vital', action_type: 'start' });\n            strategy.addOperationStepVital(name, 'start', options);\n        }),\n        succeedFeatureOperation: monitor((name, options) => {\n            addTelemetryUsage({ feature: 'add-operation-step-vital', action_type: 'succeed' });\n            strategy.addOperationStepVital(name, 'end', options);\n        }),\n        failFeatureOperation: monitor((name, failureReason, options) => {\n            addTelemetryUsage({ feature: 'add-operation-step-vital', action_type: 'fail' });\n            strategy.addOperationStepVital(name, 'end', options, failureReason);\n        }),\n    });\n    return rumPublicApi;\n}\nfunction createPostStartStrategy(preStartStrategy, startRumResult) {\n    return {\n        init: (initConfiguration) => {\n            displayAlreadyInitializedError('DD_RUM', initConfiguration);\n        },\n        initConfiguration: preStartStrategy.initConfiguration,\n        ...startRumResult,\n    };\n}\n//# sourceMappingURL=rumPublicApi.js.map","import { monitor, noop, Observable, getZoneJsOriginalValue } from '@datadog/browser-core';\nexport function createDOMMutationObservable() {\n    const MutationObserver = getMutationObserverConstructor();\n    return new Observable((observable) => {\n        if (!MutationObserver) {\n            return;\n        }\n        const observer = new MutationObserver(monitor((records) => observable.notify(records)));\n        observer.observe(document, {\n            attributes: true,\n            characterData: true,\n            childList: true,\n            subtree: true,\n        });\n        return () => observer.disconnect();\n    });\n}\nexport function getMutationObserverConstructor() {\n    let constructor;\n    const browserWindow = window;\n    // Angular uses Zone.js to provide a context persisting across async tasks.  Zone.js replaces the\n    // global MutationObserver constructor with a patched version to support the context propagation.\n    // There is an ongoing issue[1][2] with this setup when using a MutationObserver within a Angular\n    // component: on some occasions, the callback is being called in an infinite loop, causing the\n    // page to freeze (even if the callback is completely empty).\n    //\n    // To work around this issue, we try to get the original MutationObserver constructor stored by\n    // Zone.js.\n    //\n    // [1] https://github.com/angular/angular/issues/26948\n    // [2] https://github.com/angular/angular/issues/31712\n    if (browserWindow.Zone) {\n        // Zone.js 0.8.6+ is storing original class constructors into the browser 'window' object[3].\n        //\n        // [3] https://github.com/angular/angular/blob/6375fa79875c0fe7b815efc45940a6e6f5c9c9eb/packages/zone.js/lib/common/utils.ts#L288\n        constructor = getZoneJsOriginalValue(browserWindow, 'MutationObserver');\n        if (browserWindow.MutationObserver && constructor === browserWindow.MutationObserver) {\n            // Anterior Zone.js versions (used in Angular 2) does not expose the original MutationObserver\n            // in the 'window' object. Luckily, the patched MutationObserver class is storing an original\n            // instance in its properties[4]. Let's get the original MutationObserver constructor from\n            // there.\n            //\n            // [4] https://github.com/angular/zone.js/blob/v0.8.5/lib/common/utils.ts#L412\n            const patchedInstance = new browserWindow.MutationObserver(noop);\n            const originalInstance = getZoneJsOriginalValue(patchedInstance, 'originalInstance');\n            constructor = originalInstance && originalInstance.constructor;\n        }\n    }\n    if (!constructor) {\n        constructor = browserWindow.MutationObserver;\n    }\n    return constructor;\n}\n//# sourceMappingURL=domMutationObservable.js.map","import { instrumentMethod, Observable } from '@datadog/browser-core';\nexport function createWindowOpenObservable() {\n    const observable = new Observable();\n    const { stop } = instrumentMethod(window, 'open', () => observable.notify());\n    return { observable, stop };\n}\n//# sourceMappingURL=windowOpenObservable.js.map","/**\n * Internal context keep returning v1 format\n * to not break compatibility with logs data format\n */\nexport function startInternalContext(applicationId, sessionManager, viewHistory, actionContexts, urlContexts) {\n    return {\n        get: (startTime) => {\n            const viewContext = viewHistory.findView(startTime);\n            const urlContext = urlContexts.findUrl(startTime);\n            const session = sessionManager.findTrackedSession(startTime);\n            if (session && viewContext && urlContext) {\n                const actionId = actionContexts.findActionId(startTime);\n                return {\n                    application_id: applicationId,\n                    session_id: session.id,\n                    user_action: actionId ? { id: actionId } : undefined,\n                    view: { id: viewContext.id, name: viewContext.name, referrer: urlContext.referrer, url: urlContext.url },\n                };\n            }\n        },\n    };\n}\n//# sourceMappingURL=internalContext.js.map","import { AbstractLifeCycle } from '@datadog/browser-core';\nexport const LifeCycle = (AbstractLifeCycle);\n//# sourceMappingURL=lifeCycle.js.map","import { SESSION_TIME_OUT_DELAY, createValueHistory } from '@datadog/browser-core';\nexport const VIEW_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport function startViewHistory(lifeCycle) {\n    const viewValueHistory = createValueHistory({ expireDelay: VIEW_CONTEXT_TIME_OUT_DELAY });\n    lifeCycle.subscribe(1 /* LifeCycleEventType.BEFORE_VIEW_CREATED */, (view) => {\n        viewValueHistory.add(buildViewHistoryEntry(view), view.startClocks.relative);\n    });\n    lifeCycle.subscribe(6 /* LifeCycleEventType.AFTER_VIEW_ENDED */, ({ endClocks }) => {\n        viewValueHistory.closeActive(endClocks.relative);\n    });\n    lifeCycle.subscribe(3 /* LifeCycleEventType.BEFORE_VIEW_UPDATED */, (viewUpdate) => {\n        const currentView = viewValueHistory.find(viewUpdate.startClocks.relative);\n        if (!currentView) {\n            return;\n        }\n        if (viewUpdate.name) {\n            currentView.name = viewUpdate.name;\n        }\n        if (viewUpdate.context) {\n            currentView.context = viewUpdate.context;\n        }\n        currentView.sessionIsActive = viewUpdate.sessionIsActive;\n    });\n    lifeCycle.subscribe(10 /* LifeCycleEventType.SESSION_RENEWED */, () => {\n        viewValueHistory.reset();\n    });\n    function buildViewHistoryEntry(view) {\n        return {\n            service: view.service,\n            version: view.version,\n            context: view.context,\n            id: view.id,\n            name: view.name,\n            startClocks: view.startClocks,\n        };\n    }\n    return {\n        findView: (startTime) => viewValueHistory.find(startTime),\n        stop: () => {\n            viewValueHistory.stop();\n        },\n    };\n}\n//# sourceMappingURL=viewHistory.js.map","import { isNonEmptyArray, matchList, ONE_KIBI_BYTE, safeTruncate } from '@datadog/browser-core';\n/**\n * arbitrary value, byte precision not needed\n */\nconst GRAPHQL_PAYLOAD_LIMIT = 32 * ONE_KIBI_BYTE;\nexport function extractGraphQlMetadata(request, graphQlConfig) {\n    const metadata = extractGraphQlRequestMetadata(request.requestBody, graphQlConfig.trackPayload);\n    if (!metadata) {\n        return;\n    }\n    if (graphQlConfig.trackResponseErrors && request.responseBody) {\n        const responseErrors = parseGraphQlResponse(request.responseBody);\n        if (responseErrors) {\n            metadata.errors_count = responseErrors.length;\n            metadata.errors = responseErrors;\n        }\n    }\n    return metadata;\n}\nexport function parseGraphQlResponse(responseText) {\n    let response;\n    try {\n        response = JSON.parse(responseText);\n    }\n    catch (_a) {\n        // Invalid JSON response\n        return;\n    }\n    if (!response || typeof response !== 'object') {\n        return;\n    }\n    const responseObj = response;\n    if (!isNonEmptyArray(responseObj.errors)) {\n        return;\n    }\n    const errors = responseObj.errors.map((error) => {\n        var _a;\n        const graphqlError = {\n            message: error.message,\n            path: error.path,\n            locations: error.locations,\n            code: (_a = error.extensions) === null || _a === void 0 ? void 0 : _a.code,\n        };\n        return graphqlError;\n    });\n    return errors;\n}\nexport function findGraphQlConfiguration(url, configuration) {\n    return configuration.allowedGraphQlUrls.find((graphQlOption) => matchList([graphQlOption.match], url));\n}\nexport function extractGraphQlRequestMetadata(requestBody, trackPayload = false) {\n    if (!requestBody || typeof requestBody !== 'string') {\n        return;\n    }\n    let graphqlBody;\n    try {\n        graphqlBody = JSON.parse(requestBody);\n    }\n    catch (_a) {\n        // Not valid JSON\n        return;\n    }\n    if (!graphqlBody || !graphqlBody.query) {\n        return;\n    }\n    const query = graphqlBody.query.trim();\n    const operationType = getOperationType(query);\n    const operationName = graphqlBody.operationName;\n    if (!operationType) {\n        return;\n    }\n    let variables;\n    if (graphqlBody.variables) {\n        variables = JSON.stringify(graphqlBody.variables);\n    }\n    return {\n        operationType,\n        operationName,\n        variables,\n        payload: trackPayload ? safeTruncate(query, GRAPHQL_PAYLOAD_LIMIT, '...') : undefined,\n    };\n}\nfunction getOperationType(query) {\n    var _a;\n    return (_a = query.match(/^\\s*(query|mutation|subscription)\\b/i)) === null || _a === void 0 ? void 0 : _a[1];\n}\n//# sourceMappingURL=graphql.js.map","import { RequestType, elapsed, initFetchObservable, initXhrObservable, timeStampNow, } from '@datadog/browser-core';\nimport { isAllowedRequestUrl } from './resource/resourceUtils';\nimport { startTracer } from './tracing/tracer';\nimport { findGraphQlConfiguration } from './resource/graphql';\nlet nextRequestIndex = 1;\nexport function startRequestCollection(lifeCycle, configuration, sessionManager, userContext, accountContext) {\n    const tracer = startTracer(configuration, sessionManager, userContext, accountContext);\n    trackXhr(lifeCycle, configuration, tracer);\n    trackFetch(lifeCycle, configuration, tracer);\n}\nexport function trackXhr(lifeCycle, configuration, tracer) {\n    const subscription = initXhrObservable(configuration).subscribe((rawContext) => {\n        const context = rawContext;\n        if (!isAllowedRequestUrl(context.url)) {\n            return;\n        }\n        switch (context.state) {\n            case 'start':\n                tracer.traceXhr(context, context.xhr);\n                context.requestIndex = getNextRequestIndex();\n                lifeCycle.notify(7 /* LifeCycleEventType.REQUEST_STARTED */, {\n                    requestIndex: context.requestIndex,\n                    url: context.url,\n                });\n                break;\n            case 'complete':\n                tracer.clearTracingIfNeeded(context);\n                lifeCycle.notify(8 /* LifeCycleEventType.REQUEST_COMPLETED */, {\n                    duration: context.duration,\n                    method: context.method,\n                    requestIndex: context.requestIndex,\n                    spanId: context.spanId,\n                    startClocks: context.startClocks,\n                    status: context.status,\n                    traceId: context.traceId,\n                    traceSampled: context.traceSampled,\n                    type: RequestType.XHR,\n                    url: context.url,\n                    xhr: context.xhr,\n                    isAborted: context.isAborted,\n                    handlingStack: context.handlingStack,\n                    requestBody: context.requestBody,\n                    responseBody: context.responseBody,\n                });\n                break;\n        }\n    });\n    return { stop: () => subscription.unsubscribe() };\n}\nexport function trackFetch(lifeCycle, configuration, tracer) {\n    const subscription = initFetchObservable({\n        responseBodyAction: (context) => {\n            var _a;\n            if ((_a = findGraphQlConfiguration(context.url, configuration)) === null || _a === void 0 ? void 0 : _a.trackResponseErrors) {\n                return 2 /* ResponseBodyAction.COLLECT */;\n            }\n            return 1 /* ResponseBodyAction.WAIT */;\n        },\n    }).subscribe((rawContext) => {\n        var _a;\n        const context = rawContext;\n        if (!isAllowedRequestUrl(context.url)) {\n            return;\n        }\n        switch (context.state) {\n            case 'start':\n                tracer.traceFetch(context);\n                context.requestIndex = getNextRequestIndex();\n                lifeCycle.notify(7 /* LifeCycleEventType.REQUEST_STARTED */, {\n                    requestIndex: context.requestIndex,\n                    url: context.url,\n                });\n                break;\n            case 'resolve':\n                tracer.clearTracingIfNeeded(context);\n                lifeCycle.notify(8 /* LifeCycleEventType.REQUEST_COMPLETED */, {\n                    duration: elapsed(context.startClocks.timeStamp, timeStampNow()),\n                    method: context.method,\n                    requestIndex: context.requestIndex,\n                    responseType: context.responseType,\n                    spanId: context.spanId,\n                    startClocks: context.startClocks,\n                    status: context.status,\n                    traceId: context.traceId,\n                    traceSampled: context.traceSampled,\n                    type: RequestType.FETCH,\n                    url: context.url,\n                    response: context.response,\n                    init: context.init,\n                    input: context.input,\n                    isAborted: context.isAborted,\n                    handlingStack: context.handlingStack,\n                    requestBody: (_a = context.init) === null || _a === void 0 ? void 0 : _a.body,\n                    responseBody: context.responseBody,\n                });\n                break;\n        }\n    });\n    return { stop: () => subscription.unsubscribe() };\n}\nfunction getNextRequestIndex() {\n    const result = nextRequestIndex;\n    nextRequestIndex += 1;\n    return result;\n}\n//# sourceMappingURL=requestCollection.js.map","import { isNumber } from '@datadog/browser-core';\nexport function discardNegativeDuration(duration) {\n    return isNumber(duration) && duration < 0 ? undefined : duration;\n}\n//# sourceMappingURL=discardNegativeDuration.js.map","import { noop } from '@datadog/browser-core';\nimport { RumEventType } from '../rawRumEvent.types';\nexport function trackEventCounts({ lifeCycle, isChildEvent, onChange: callback = noop, }) {\n    const eventCounts = {\n        errorCount: 0,\n        longTaskCount: 0,\n        resourceCount: 0,\n        actionCount: 0,\n        frustrationCount: 0,\n    };\n    const subscription = lifeCycle.subscribe(13 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, (event) => {\n        var _a;\n        if (event.type === 'view' || event.type === 'vital' || !isChildEvent(event)) {\n            return;\n        }\n        switch (event.type) {\n            case RumEventType.ERROR:\n                eventCounts.errorCount += 1;\n                callback();\n                break;\n            case RumEventType.ACTION:\n                eventCounts.actionCount += 1;\n                if (event.action.frustration) {\n                    eventCounts.frustrationCount += event.action.frustration.type.length;\n                }\n                callback();\n                break;\n            case RumEventType.LONG_TASK:\n                eventCounts.longTaskCount += 1;\n                callback();\n                break;\n            case RumEventType.RESOURCE:\n                if (!((_a = event._dd) === null || _a === void 0 ? void 0 : _a.discarded)) {\n                    eventCounts.resourceCount += 1;\n                    callback();\n                }\n                break;\n        }\n    });\n    return {\n        stop: () => {\n            subscription.unsubscribe();\n        },\n        eventCounts,\n    };\n}\n//# sourceMappingURL=trackEventCounts.js.map","export function isTextNode(node) {\n    return node.nodeType === Node.TEXT_NODE;\n}\nexport function isCommentNode(node) {\n    return node.nodeType === Node.COMMENT_NODE;\n}\nexport function isElementNode(node) {\n    return node.nodeType === Node.ELEMENT_NODE;\n}\nexport function isNodeShadowHost(node) {\n    return isElementNode(node) && Boolean(node.shadowRoot);\n}\nexport function isNodeShadowRoot(node) {\n    const shadowRoot = node;\n    return !!shadowRoot.host && shadowRoot.nodeType === Node.DOCUMENT_FRAGMENT_NODE && isElementNode(shadowRoot.host);\n}\nexport function hasChildNodes(node) {\n    return node.childNodes.length > 0 || isNodeShadowHost(node);\n}\nexport function forEachChildNodes(node, callback) {\n    let child = node.firstChild;\n    while (child) {\n        callback(child);\n        child = child.nextSibling;\n    }\n    if (isNodeShadowHost(node)) {\n        callback(node.shadowRoot);\n    }\n}\n/**\n * Return `host` in case if the current node is a shadow root otherwise will return the `parentNode`\n */\nexport function getParentNode(node) {\n    return isNodeShadowRoot(node) ? node.host : node.parentNode;\n}\n//# sourceMappingURL=htmlDomUtils.js.map","import { matchList, monitor, Observable, timeStampNow, setTimeout, clearTimeout } from '@datadog/browser-core';\nimport { createPerformanceObservable, RumPerformanceEntryType } from '../browser/performanceObservable';\nimport { isElementNode } from '../browser/htmlDomUtils';\n// Delay to wait for a page activity to validate the tracking process\nexport const PAGE_ACTIVITY_VALIDATION_DELAY = 100;\n// Delay to wait after a page activity to end the tracking process\nexport const PAGE_ACTIVITY_END_DELAY = 100;\nexport const EXCLUDED_MUTATIONS_ATTRIBUTE = 'data-dd-excluded-activity-mutations';\n/**\n * Wait for the page activity end\n *\n * Detection lifecycle:\n * ```\n *                        Wait page activity end\n *              .-------------------'--------------------.\n *              v                                        v\n *     [Wait for a page activity ]          [Wait for a maximum duration]\n *     [timeout: VALIDATION_DELAY]          [  timeout: maxDuration     ]\n *          /                  \\                           |\n *         v                    v                          |\n *  [No page activity]   [Page activity]                   |\n *         |                   |,----------------------.   |\n *         v                   v                       |   |\n *     (Discard)     [Wait for a page activity]        |   |\n *                   [   timeout: END_DELAY   ]        |   |\n *                       /                \\            |   |\n *                      v                  v           |   |\n *             [No page activity]    [Page activity]   |   |\n *                      |                 |            |   |\n *                      |                 '------------'   |\n *                      '-----------. ,--------------------'\n *                                   v\n *                                 (End)\n * ```\n *\n * Note: by assuming that maxDuration is greater than VALIDATION_DELAY, we are sure that if the\n * process is still alive after maxDuration, it has been validated.\n */\nexport function waitPageActivityEnd(lifeCycle, domMutationObservable, windowOpenObservable, configuration, pageActivityEndCallback, maxDuration) {\n    const pageActivityObservable = createPageActivityObservable(lifeCycle, domMutationObservable, windowOpenObservable, configuration);\n    return doWaitPageActivityEnd(pageActivityObservable, pageActivityEndCallback, maxDuration);\n}\nexport function doWaitPageActivityEnd(pageActivityObservable, pageActivityEndCallback, maxDuration) {\n    let pageActivityEndTimeoutId;\n    let hasCompleted = false;\n    const validationTimeoutId = setTimeout(monitor(() => complete({ hadActivity: false })), PAGE_ACTIVITY_VALIDATION_DELAY);\n    const maxDurationTimeoutId = maxDuration !== undefined\n        ? setTimeout(monitor(() => complete({ hadActivity: true, end: timeStampNow() })), maxDuration)\n        : undefined;\n    const pageActivitySubscription = pageActivityObservable.subscribe(({ isBusy }) => {\n        clearTimeout(validationTimeoutId);\n        clearTimeout(pageActivityEndTimeoutId);\n        const lastChangeTime = timeStampNow();\n        if (!isBusy) {\n            pageActivityEndTimeoutId = setTimeout(monitor(() => complete({ hadActivity: true, end: lastChangeTime })), PAGE_ACTIVITY_END_DELAY);\n        }\n    });\n    const stop = () => {\n        hasCompleted = true;\n        clearTimeout(validationTimeoutId);\n        clearTimeout(pageActivityEndTimeoutId);\n        clearTimeout(maxDurationTimeoutId);\n        pageActivitySubscription.unsubscribe();\n    };\n    function complete(event) {\n        if (hasCompleted) {\n            return;\n        }\n        stop();\n        pageActivityEndCallback(event);\n    }\n    return { stop };\n}\nexport function createPageActivityObservable(lifeCycle, domMutationObservable, windowOpenObservable, configuration) {\n    return new Observable((observable) => {\n        const subscriptions = [];\n        let firstRequestIndex;\n        let pendingRequestsCount = 0;\n        subscriptions.push(domMutationObservable.subscribe((mutations) => {\n            if (!mutations.every(isExcludedMutation)) {\n                notifyPageActivity();\n            }\n        }), windowOpenObservable.subscribe(notifyPageActivity), createPerformanceObservable(configuration, { type: RumPerformanceEntryType.RESOURCE }).subscribe((entries) => {\n            if (entries.some((entry) => !isExcludedUrl(configuration, entry.name))) {\n                notifyPageActivity();\n            }\n        }), lifeCycle.subscribe(7 /* LifeCycleEventType.REQUEST_STARTED */, (startEvent) => {\n            if (isExcludedUrl(configuration, startEvent.url)) {\n                return;\n            }\n            if (firstRequestIndex === undefined) {\n                firstRequestIndex = startEvent.requestIndex;\n            }\n            pendingRequestsCount += 1;\n            notifyPageActivity();\n        }), lifeCycle.subscribe(8 /* LifeCycleEventType.REQUEST_COMPLETED */, (request) => {\n            if (isExcludedUrl(configuration, request.url) ||\n                firstRequestIndex === undefined ||\n                // If the request started before the tracking start, ignore it\n                request.requestIndex < firstRequestIndex) {\n                return;\n            }\n            pendingRequestsCount -= 1;\n            notifyPageActivity();\n        }));\n        return () => {\n            subscriptions.forEach((s) => s.unsubscribe());\n        };\n        function notifyPageActivity() {\n            observable.notify({ isBusy: pendingRequestsCount > 0 });\n        }\n    });\n}\nfunction isExcludedUrl(configuration, requestUrl) {\n    return matchList(configuration.excludedActivityUrls, requestUrl);\n}\nfunction isExcludedMutation(mutation) {\n    const targetElement = mutation.type === 'characterData' ? mutation.target.parentElement : mutation.target;\n    return Boolean(targetElement &&\n        isElementNode(targetElement) &&\n        targetElement.matches(`[${EXCLUDED_MUTATIONS_ATTRIBUTE}], [${EXCLUDED_MUTATIONS_ATTRIBUTE}] *`));\n}\n//# sourceMappingURL=waitPageActivityEnd.js.map","/**\n * Get the action name from the attribute 'data-dd-action-name' on the element or any of its parent.\n * It can also be retrieved from a user defined attribute.\n */\nexport const DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE = 'data-dd-action-name';\nexport const ACTION_NAME_PLACEHOLDER = 'Masked Element';\nexport const ACTION_NAME_MASK = 'xxx';\n//# sourceMappingURL=actionNameConstants.js.map","import { DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE } from './action/actionNameConstants';\n/**\n * Stable attributes are attributes that are commonly used to identify parts of a UI (ex:\n * component). Those attribute values should not be generated randomly (hardcoded most of the time)\n * and stay the same across deploys. They are not necessarily unique across the document.\n */\nexport const STABLE_ATTRIBUTES = [\n    DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE,\n    // Common test attributes (list provided by google recorder)\n    'data-testid',\n    'data-test',\n    'data-qa',\n    'data-cy',\n    'data-test-id',\n    'data-qa-id',\n    'data-testing',\n    // FullStory decorator attributes:\n    'data-component',\n    'data-element',\n    'data-source-file',\n];\n// Selectors to use if they target a single element on the whole document. Those selectors are\n// considered as \"stable\" and uniquely identify an element regardless of the page state. If we find\n// one, we should consider the selector \"complete\" and stop iterating over ancestors.\nconst GLOBALLY_UNIQUE_SELECTOR_GETTERS = [getStableAttributeSelector, getIDSelector];\n// Selectors to use if they target a single element among an element descendants. Those selectors\n// are more brittle than \"globally unique\" selectors and should be combined with ancestor selectors\n// to improve specificity.\nconst UNIQUE_AMONG_CHILDREN_SELECTOR_GETTERS = [\n    getStableAttributeSelector,\n    getClassSelector,\n    getTagNameSelector,\n];\nexport function getSelectorFromElement(targetElement, actionNameAttribute) {\n    if (!targetElement.isConnected) {\n        // We cannot compute a selector for a detached element, as we don't have access to all of its\n        // parents, and we cannot determine if it's unique in the document.\n        return;\n    }\n    let targetElementSelector;\n    let currentElement = targetElement;\n    while (currentElement && currentElement.nodeName !== 'HTML') {\n        const globallyUniqueSelector = findSelector(currentElement, GLOBALLY_UNIQUE_SELECTOR_GETTERS, isSelectorUniqueGlobally, actionNameAttribute, targetElementSelector);\n        if (globallyUniqueSelector) {\n            return globallyUniqueSelector;\n        }\n        const uniqueSelectorAmongChildren = findSelector(currentElement, UNIQUE_AMONG_CHILDREN_SELECTOR_GETTERS, isSelectorUniqueAmongSiblings, actionNameAttribute, targetElementSelector);\n        targetElementSelector =\n            uniqueSelectorAmongChildren || combineSelector(getPositionSelector(currentElement), targetElementSelector);\n        currentElement = currentElement.parentElement;\n    }\n    return targetElementSelector;\n}\nfunction isGeneratedValue(value) {\n    // To compute the \"URL path group\", the backend replaces every URL path parts as a question mark\n    // if it thinks the part is an identifier. The condition it uses is to checks whether a digit is\n    // present.\n    //\n    // Here, we use the same strategy: if the value contains a digit, we consider it generated. This\n    // strategy might be a bit naive and fail in some cases, but there are many fallbacks to generate\n    // CSS selectors so it should be fine most of the time.\n    return /[0-9]/.test(value);\n}\nfunction getIDSelector(element) {\n    if (element.id && !isGeneratedValue(element.id)) {\n        return `#${CSS.escape(element.id)}`;\n    }\n}\nfunction getClassSelector(element) {\n    if (element.tagName === 'BODY') {\n        return;\n    }\n    const classList = element.classList;\n    for (let i = 0; i < classList.length; i += 1) {\n        const className = classList[i];\n        if (isGeneratedValue(className)) {\n            continue;\n        }\n        return `${CSS.escape(element.tagName)}.${CSS.escape(className)}`;\n    }\n}\nfunction getTagNameSelector(element) {\n    return CSS.escape(element.tagName);\n}\nfunction getStableAttributeSelector(element, actionNameAttribute) {\n    if (actionNameAttribute) {\n        const selector = getAttributeSelector(actionNameAttribute);\n        if (selector) {\n            return selector;\n        }\n    }\n    for (const attributeName of STABLE_ATTRIBUTES) {\n        const selector = getAttributeSelector(attributeName);\n        if (selector) {\n            return selector;\n        }\n    }\n    function getAttributeSelector(attributeName) {\n        if (element.hasAttribute(attributeName)) {\n            return `${CSS.escape(element.tagName)}[${attributeName}=\"${CSS.escape(element.getAttribute(attributeName))}\"]`;\n        }\n    }\n}\nfunction getPositionSelector(element) {\n    let sibling = element.parentElement.firstElementChild;\n    let elementIndex = 1;\n    while (sibling && sibling !== element) {\n        if (sibling.tagName === element.tagName) {\n            elementIndex += 1;\n        }\n        sibling = sibling.nextElementSibling;\n    }\n    return `${CSS.escape(element.tagName)}:nth-of-type(${elementIndex})`;\n}\nfunction findSelector(element, selectorGetters, predicate, actionNameAttribute, childSelector) {\n    for (const selectorGetter of selectorGetters) {\n        const elementSelector = selectorGetter(element, actionNameAttribute);\n        if (!elementSelector) {\n            continue;\n        }\n        if (predicate(element, elementSelector, childSelector)) {\n            return combineSelector(elementSelector, childSelector);\n        }\n    }\n}\n/**\n * Check whether the selector is unique among the whole document.\n */\nfunction isSelectorUniqueGlobally(element, elementSelector, childSelector) {\n    return element.ownerDocument.querySelectorAll(combineSelector(elementSelector, childSelector)).length === 1;\n}\n/**\n * Check whether the selector is unique among the element siblings. In other words, it returns true\n * if \"ELEMENT_PARENT > CHILD_SELECTOR\" returns a single element.\n *\n * @param currentElement - the element being considered while iterating over the target\n * element ancestors.\n * @param currentElementSelector - a selector that matches the current element. That\n * selector is not a composed selector (i.e. it might be a single tag name, class name...).\n * @param childSelector - child selector is a selector that targets a descendant\n * of the current element. When undefined, the current element is the target element.\n *\n * # Scope selector usage\n *\n * When composed together, the final selector will be joined with `>` operators to make sure we\n * target direct descendants at each level. In this function, we'll use `querySelector` to check if\n * a selector matches descendants of the current element. But by default, the query selector match\n * elements at any level. Example:\n *\n * ```html\n * <main>\n *   <div>\n *     <span></span>\n *   </div>\n *   <marquee>\n *     <div>\n *       <span></span>\n *     </div>\n *   </marquee>\n * </main>\n * ```\n *\n * `sibling.querySelector('DIV > SPAN')` will match both span elements, so we would consider the\n * selector to be not unique, even if it is unique when we'll compose it with the parent with a `>`\n * operator (`MAIN > DIV > SPAN`).\n *\n * To avoid this, we can use the `:scope` selector to make sure the selector starts from the current\n * sibling (i.e. `sibling.querySelector('DIV:scope > SPAN')` will only match the first span).\n *\n * [1]: https://developer.mozilla.org/fr/docs/Web/CSS/:scope\n *\n * # Performance considerations\n *\n * We compute selectors in performance-critical operations (ex: during a click), so we need to make\n * sure the function is as fast as possible. We observed that naively using `querySelectorAll` to\n * check if the selector matches more than 1 element is quite expensive, so we want to avoid it.\n *\n * Because we are iterating the DOM upward and we use that function at every level, we know the\n * child selector is already unique among the current element children, so we don't need to check\n * for the current element subtree.\n *\n * Instead, we can focus on the current element siblings. If we find a single element matching the\n * selector within a sibling, we know that it's not unique. This allows us to use `querySelector`\n * (or `matches`, when the current element is the target element) instead of `querySelectorAll`.\n */\nexport function isSelectorUniqueAmongSiblings(currentElement, currentElementSelector, childSelector) {\n    let isSiblingMatching;\n    if (childSelector === undefined) {\n        // If the child selector is undefined (meaning `currentElement` is the target element, not one\n        // of its ancestor), we need to use `matches` to check if the sibling is matching the selector,\n        // as `querySelector` only returns a descendant of the element.\n        isSiblingMatching = (sibling) => sibling.matches(currentElementSelector);\n    }\n    else {\n        const scopedSelector = combineSelector(`${currentElementSelector}:scope`, childSelector);\n        isSiblingMatching = (sibling) => sibling.querySelector(scopedSelector) !== null;\n    }\n    const parent = currentElement.parentElement;\n    let sibling = parent.firstElementChild;\n    while (sibling) {\n        if (sibling !== currentElement && isSiblingMatching(sibling)) {\n            return false;\n        }\n        sibling = sibling.nextElementSibling;\n    }\n    return true;\n}\nfunction combineSelector(parent, child) {\n    return child ? `${parent}>${child}` : parent;\n}\n//# sourceMappingURL=getSelectorFromElement.js.map","import { isElementNode, getParentNode, isTextNode } from '../browser/htmlDomUtils';\nimport { NodePrivacyLevel, FORM_PRIVATE_TAG_NAMES, CENSORED_STRING_MARK, getPrivacySelector, TEXT_MASKING_CHAR, PRIVACY_ATTR_NAME, } from './privacyConstants';\nimport { STABLE_ATTRIBUTES } from './getSelectorFromElement';\n/**\n * Get node privacy level by iterating over its ancestors. When the direct parent privacy level is\n * know, it is best to use something like:\n *\n * derivePrivacyLevelGivenParent(getNodeSelfPrivacyLevel(node), parentNodePrivacyLevel)\n */\nexport function getNodePrivacyLevel(node, defaultPrivacyLevel, cache) {\n    if (cache && cache.has(node)) {\n        return cache.get(node);\n    }\n    const parentNode = getParentNode(node);\n    const parentNodePrivacyLevel = parentNode\n        ? getNodePrivacyLevel(parentNode, defaultPrivacyLevel, cache)\n        : defaultPrivacyLevel;\n    const selfNodePrivacyLevel = getNodeSelfPrivacyLevel(node);\n    const nodePrivacyLevel = reducePrivacyLevel(selfNodePrivacyLevel, parentNodePrivacyLevel);\n    if (cache) {\n        cache.set(node, nodePrivacyLevel);\n    }\n    return nodePrivacyLevel;\n}\n/**\n * Reduces the next privacy level based on self + parent privacy levels\n */\nexport function reducePrivacyLevel(childPrivacyLevel, parentNodePrivacyLevel) {\n    switch (parentNodePrivacyLevel) {\n        // These values cannot be overridden\n        case NodePrivacyLevel.HIDDEN:\n        case NodePrivacyLevel.IGNORE:\n            return parentNodePrivacyLevel;\n    }\n    switch (childPrivacyLevel) {\n        case NodePrivacyLevel.ALLOW:\n        case NodePrivacyLevel.MASK:\n        case NodePrivacyLevel.MASK_USER_INPUT:\n        case NodePrivacyLevel.MASK_UNLESS_ALLOWLISTED:\n        case NodePrivacyLevel.HIDDEN:\n        case NodePrivacyLevel.IGNORE:\n            return childPrivacyLevel;\n        default:\n            return parentNodePrivacyLevel;\n    }\n}\n/**\n * Determines the node's own privacy level without checking for ancestors.\n */\nexport function getNodeSelfPrivacyLevel(node) {\n    // Only Element types can have a privacy level set\n    if (!isElementNode(node)) {\n        return;\n    }\n    // Overrules for replay purpose\n    if (node.tagName === 'BASE') {\n        return NodePrivacyLevel.ALLOW;\n    }\n    // Overrules to enforce end-user protection\n    if (node.tagName === 'INPUT') {\n        const inputElement = node;\n        if (inputElement.type === 'password' || inputElement.type === 'email' || inputElement.type === 'tel') {\n            return NodePrivacyLevel.MASK;\n        }\n        if (inputElement.type === 'hidden') {\n            return NodePrivacyLevel.MASK;\n        }\n        const autocomplete = inputElement.getAttribute('autocomplete');\n        // Handle input[autocomplete=cc-number/cc-csc/cc-exp/cc-exp-month/cc-exp-year/new-password/current-password]\n        if (autocomplete && (autocomplete.startsWith('cc-') || autocomplete.endsWith('-password'))) {\n            return NodePrivacyLevel.MASK;\n        }\n    }\n    // Check HTML privacy attributes and classes\n    if (node.matches(getPrivacySelector(NodePrivacyLevel.HIDDEN))) {\n        return NodePrivacyLevel.HIDDEN;\n    }\n    if (node.matches(getPrivacySelector(NodePrivacyLevel.MASK))) {\n        return NodePrivacyLevel.MASK;\n    }\n    if (node.matches(getPrivacySelector(NodePrivacyLevel.MASK_UNLESS_ALLOWLISTED))) {\n        return NodePrivacyLevel.MASK_UNLESS_ALLOWLISTED;\n    }\n    if (node.matches(getPrivacySelector(NodePrivacyLevel.MASK_USER_INPUT))) {\n        return NodePrivacyLevel.MASK_USER_INPUT;\n    }\n    if (node.matches(getPrivacySelector(NodePrivacyLevel.ALLOW))) {\n        return NodePrivacyLevel.ALLOW;\n    }\n    if (shouldIgnoreElement(node)) {\n        return NodePrivacyLevel.IGNORE;\n    }\n}\n/**\n * Helper aiming to unify `mask` and `mask-user-input` privacy levels:\n *\n * In the `mask` case, it is trivial: we should mask the element.\n *\n * In the `mask-user-input` case, we should mask the element only if it is a \"form\" element or the\n * direct parent is a form element for text nodes).\n *\n * Other `shouldMaskNode` cases are edge cases that should not matter too much (ex: should we mask a\n * node if it is ignored or hidden? it doesn't matter since it won't be serialized).\n */\nexport function shouldMaskNode(node, privacyLevel) {\n    switch (privacyLevel) {\n        case NodePrivacyLevel.MASK:\n        case NodePrivacyLevel.HIDDEN:\n        case NodePrivacyLevel.IGNORE:\n            return true;\n        case NodePrivacyLevel.MASK_UNLESS_ALLOWLISTED:\n            if (isTextNode(node)) {\n                // Always return true if our parent is a form element, like MASK_USER_INPUT.\n                // Otherwise, decide whether to mask based on the allowlist.\n                return isFormElement(node.parentNode) ? true : !isAllowlisted(node.textContent || '');\n            }\n            // Always return true if we're a form element, like MASK_USER_INPUT.\n            // Otherwise, return false; MASK_UNLESS_ALLOWLISTED only directly masks text nodes.\n            return isFormElement(node);\n        case NodePrivacyLevel.MASK_USER_INPUT:\n            return isTextNode(node) ? isFormElement(node.parentNode) : isFormElement(node);\n        default:\n            return false;\n    }\n}\nexport function shouldMaskAttribute(tagName, attributeName, attributeValue, nodePrivacyLevel, configuration) {\n    if (nodePrivacyLevel !== NodePrivacyLevel.MASK && nodePrivacyLevel !== NodePrivacyLevel.MASK_UNLESS_ALLOWLISTED) {\n        return false;\n    }\n    if (attributeName === PRIVACY_ATTR_NAME ||\n        STABLE_ATTRIBUTES.includes(attributeName) ||\n        attributeName === configuration.actionNameAttribute) {\n        return false;\n    }\n    switch (attributeName) {\n        case 'title':\n        case 'alt':\n        case 'placeholder':\n            return true;\n    }\n    if (tagName === 'A' && attributeName === 'href') {\n        return true;\n    }\n    if (tagName === 'IFRAME' && attributeName === 'srcdoc') {\n        return true;\n    }\n    if (attributeValue && attributeName.startsWith('data-')) {\n        return true;\n    }\n    if ((tagName === 'IMG' || tagName === 'SOURCE') && (attributeName === 'src' || attributeName === 'srcset')) {\n        return true;\n    }\n    return false;\n}\nfunction isFormElement(node) {\n    if (!node || node.nodeType !== node.ELEMENT_NODE) {\n        return false;\n    }\n    const element = node;\n    if (element.tagName === 'INPUT') {\n        switch (element.type) {\n            case 'button':\n            case 'color':\n            case 'reset':\n            case 'submit':\n                return false;\n        }\n    }\n    return !!FORM_PRIVATE_TAG_NAMES[element.tagName];\n}\n/**\n * Text censoring non-destructively maintains whitespace characters in order to preserve text shape\n * during replay.\n */\nconst censorText = (text) => text.replace(/\\S/g, TEXT_MASKING_CHAR);\nexport function getTextContent(textNode, parentNodePrivacyLevel) {\n    var _a;\n    // The parent node may not be a html element which has a tagName attribute.\n    // So just let it be undefined which is ok in this use case.\n    const parentTagName = (_a = textNode.parentElement) === null || _a === void 0 ? void 0 : _a.tagName;\n    let textContent = textNode.textContent || '';\n    const shouldIgnoreWhiteSpace = parentTagName === 'HEAD';\n    if (shouldIgnoreWhiteSpace && !textContent.trim()) {\n        return;\n    }\n    const nodePrivacyLevel = parentNodePrivacyLevel;\n    const isScript = parentTagName === 'SCRIPT';\n    if (isScript) {\n        // For perf reasons, we don't record script (heuristic)\n        textContent = CENSORED_STRING_MARK;\n    }\n    else if (nodePrivacyLevel === NodePrivacyLevel.HIDDEN) {\n        // Should never occur, but just in case, we set to CENSORED_MARK.\n        textContent = CENSORED_STRING_MARK;\n    }\n    else if (shouldMaskNode(textNode, nodePrivacyLevel)) {\n        if (\n        // Scrambling the child list breaks text nodes for DATALIST/SELECT/OPTGROUP\n        parentTagName === 'DATALIST' ||\n            parentTagName === 'SELECT' ||\n            parentTagName === 'OPTGROUP') {\n            if (!textContent.trim()) {\n                return;\n            }\n        }\n        else if (parentTagName === 'OPTION') {\n            // <Option> has low entropy in charset + text length, so use `CENSORED_STRING_MARK` when masked\n            textContent = CENSORED_STRING_MARK;\n        }\n        else if (nodePrivacyLevel === NodePrivacyLevel.MASK_UNLESS_ALLOWLISTED) {\n            textContent = maskDisallowedTextContent(textContent);\n        }\n        else {\n            textContent = censorText(textContent);\n        }\n    }\n    return textContent;\n}\n/**\n * TODO: Preserve CSS element order, and record the presence of the tag, just don't render\n * We don't need this logic on the recorder side.\n * For security related meta's, customer can mask themmanually given they\n * are easy to identify in the HEAD tag.\n */\nexport function shouldIgnoreElement(element) {\n    if (element.nodeName === 'SCRIPT') {\n        return true;\n    }\n    if (element.nodeName === 'LINK') {\n        const relAttribute = getLowerCaseAttribute('rel');\n        return (\n        // Link as script - Ignore only when rel=preload, modulepreload or prefetch\n        (/preload|prefetch/i.test(relAttribute) && getLowerCaseAttribute('as') === 'script') ||\n            // Favicons\n            relAttribute === 'shortcut icon' ||\n            relAttribute === 'icon');\n    }\n    if (element.nodeName === 'META') {\n        const nameAttribute = getLowerCaseAttribute('name');\n        const relAttribute = getLowerCaseAttribute('rel');\n        const propertyAttribute = getLowerCaseAttribute('property');\n        return (\n        // Favicons\n        /^msapplication-tile(image|color)$/.test(nameAttribute) ||\n            nameAttribute === 'application-name' ||\n            relAttribute === 'icon' ||\n            relAttribute === 'apple-touch-icon' ||\n            relAttribute === 'shortcut icon' ||\n            // Description\n            nameAttribute === 'keywords' ||\n            nameAttribute === 'description' ||\n            // Social\n            /^(og|twitter|fb):/.test(propertyAttribute) ||\n            /^(og|twitter):/.test(nameAttribute) ||\n            nameAttribute === 'pinterest' ||\n            // Robots\n            nameAttribute === 'robots' ||\n            nameAttribute === 'googlebot' ||\n            nameAttribute === 'bingbot' ||\n            // Http headers. Ex: X-UA-Compatible, Content-Type, Content-Language, cache-control,\n            // X-Translated-By\n            element.hasAttribute('http-equiv') ||\n            // Authorship\n            nameAttribute === 'author' ||\n            nameAttribute === 'generator' ||\n            nameAttribute === 'framework' ||\n            nameAttribute === 'publisher' ||\n            nameAttribute === 'progid' ||\n            /^article:/.test(propertyAttribute) ||\n            /^product:/.test(propertyAttribute) ||\n            // Verification\n            nameAttribute === 'google-site-verification' ||\n            nameAttribute === 'yandex-verification' ||\n            nameAttribute === 'csrf-token' ||\n            nameAttribute === 'p:domain_verify' ||\n            nameAttribute === 'verify-v1' ||\n            nameAttribute === 'verification' ||\n            nameAttribute === 'shopify-checkout-api-token');\n    }\n    function getLowerCaseAttribute(name) {\n        return (element.getAttribute(name) || '').toLowerCase();\n    }\n    return false;\n}\nexport function isAllowlisted(text) {\n    var _a;\n    if (!text || !text.trim()) {\n        return true;\n    }\n    // We are using toLocaleLowerCase when adding to the allowlist to avoid case sensitivity\n    // so we need to do the same here\n    return ((_a = window.$DD_ALLOW) === null || _a === void 0 ? void 0 : _a.has(text.toLocaleLowerCase())) || false;\n}\nexport function maskDisallowedTextContent(text, fixedMask) {\n    if (isAllowlisted(text)) {\n        return text;\n    }\n    return fixedMask || censorText(text);\n}\n//# sourceMappingURL=privacy.js.map","import { ONE_SECOND, clearTimeout, setTimeout } from '@datadog/browser-core';\nexport const MAX_DURATION_BETWEEN_CLICKS = ONE_SECOND;\nexport const MAX_DISTANCE_BETWEEN_CLICKS = 100;\nexport function createClickChain(firstClick, onFinalize) {\n    const bufferedClicks = [];\n    let status = 0 /* ClickChainStatus.WaitingForMoreClicks */;\n    let maxDurationBetweenClicksTimeoutId;\n    appendClick(firstClick);\n    function appendClick(click) {\n        click.stopObservable.subscribe(tryFinalize);\n        bufferedClicks.push(click);\n        clearTimeout(maxDurationBetweenClicksTimeoutId);\n        maxDurationBetweenClicksTimeoutId = setTimeout(dontAcceptMoreClick, MAX_DURATION_BETWEEN_CLICKS);\n    }\n    function tryFinalize() {\n        if (status === 1 /* ClickChainStatus.WaitingForClicksToStop */ && bufferedClicks.every((click) => click.isStopped())) {\n            status = 2 /* ClickChainStatus.Finalized */;\n            onFinalize(bufferedClicks);\n        }\n    }\n    function dontAcceptMoreClick() {\n        clearTimeout(maxDurationBetweenClicksTimeoutId);\n        if (status === 0 /* ClickChainStatus.WaitingForMoreClicks */) {\n            status = 1 /* ClickChainStatus.WaitingForClicksToStop */;\n            tryFinalize();\n        }\n    }\n    return {\n        tryAppend: (click) => {\n            if (status !== 0 /* ClickChainStatus.WaitingForMoreClicks */) {\n                return false;\n            }\n            if (bufferedClicks.length > 0 &&\n                !areEventsSimilar(bufferedClicks[bufferedClicks.length - 1].event, click.event)) {\n                dontAcceptMoreClick();\n                return false;\n            }\n            appendClick(click);\n            return true;\n        },\n        stop: () => {\n            dontAcceptMoreClick();\n        },\n    };\n}\n/**\n * Checks whether two events are similar by comparing their target, position and timestamp\n */\nfunction areEventsSimilar(first, second) {\n    return (first.target === second.target &&\n        mouseEventDistance(first, second) <= MAX_DISTANCE_BETWEEN_CLICKS &&\n        first.timeStamp - second.timeStamp <= MAX_DURATION_BETWEEN_CLICKS);\n}\nfunction mouseEventDistance(origin, other) {\n    return Math.sqrt(Math.pow(origin.clientX - other.clientX, 2) + Math.pow(origin.clientY - other.clientY, 2));\n}\n//# sourceMappingURL=clickChain.js.map","import { ExperimentalFeature, isExperimentalFeatureEnabled, safeTruncate } from '@datadog/browser-core';\nimport { getPrivacySelector, NodePrivacyLevel } from '../privacyConstants';\nimport { getNodePrivacyLevel, maskDisallowedTextContent, shouldMaskNode, shouldMaskAttribute } from '../privacy';\nimport { isElementNode } from '../../browser/htmlDomUtils';\nimport { DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE, ACTION_NAME_PLACEHOLDER, } from './actionNameConstants';\nexport function getActionNameFromElement(element, rumConfiguration, nodePrivacyLevel = NodePrivacyLevel.ALLOW) {\n    const nodePrivacyLevelCache = new Map();\n    const { actionNameAttribute: userProgrammaticAttribute } = rumConfiguration;\n    // Proceed to get the action name in two steps:\n    // * first, get the name programmatically, explicitly defined by the user.\n    // * then, if privacy is set to mask, return a placeholder for the undefined.\n    // * if privacy is not set to mask, use strategies that are known to return good results.\n    //   Those strategies will be used on the element and a few parents, but it's likely that they won't succeed at all.\n    // * if no name is found this way, use strategies returning less accurate names as a fallback.\n    //   Those are much likely to succeed.\n    const defaultActionName = getActionNameFromElementProgrammatically(element, DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE) ||\n        (userProgrammaticAttribute && getActionNameFromElementProgrammatically(element, userProgrammaticAttribute));\n    if (defaultActionName) {\n        return { name: defaultActionName, nameSource: \"custom_attribute\" /* ActionNameSource.CUSTOM_ATTRIBUTE */ };\n    }\n    else if (nodePrivacyLevel === NodePrivacyLevel.MASK) {\n        return { name: ACTION_NAME_PLACEHOLDER, nameSource: \"mask_placeholder\" /* ActionNameSource.MASK_PLACEHOLDER */ };\n    }\n    return (getActionNameFromElementForStrategies(element, priorityStrategies, rumConfiguration, nodePrivacyLevelCache) ||\n        getActionNameFromElementForStrategies(element, fallbackStrategies, rumConfiguration, nodePrivacyLevelCache) || {\n        name: '',\n        nameSource: \"blank\" /* ActionNameSource.BLANK */,\n    });\n}\nfunction getActionNameFromElementProgrammatically(targetElement, programmaticAttribute) {\n    // We don't use getActionNameFromElementForStrategies here, because we want to consider all parents,\n    // without limit. It is up to the user to declare a relevant naming strategy.\n    const elementWithAttribute = targetElement.closest(`[${programmaticAttribute}]`);\n    if (!elementWithAttribute) {\n        return;\n    }\n    const name = elementWithAttribute.getAttribute(programmaticAttribute);\n    return truncate(normalizeWhitespace(name.trim()));\n}\nconst priorityStrategies = [\n    // associated LABEL text\n    (element, rumConfiguration, nodePrivacyLevelCache) => {\n        if ('labels' in element && element.labels && element.labels.length > 0) {\n            return getActionNameFromTextualContent(element.labels[0], rumConfiguration, nodePrivacyLevelCache);\n        }\n    },\n    // INPUT button (and associated) value\n    (element) => {\n        if (element.nodeName === 'INPUT') {\n            const input = element;\n            const type = input.getAttribute('type');\n            if (type === 'button' || type === 'submit' || type === 'reset') {\n                return { name: input.value, nameSource: \"text_content\" /* ActionNameSource.TEXT_CONTENT */ };\n            }\n        }\n    },\n    // BUTTON, LABEL or button-like element text\n    (element, rumConfiguration, nodePrivacyLevelCache) => {\n        if (element.nodeName === 'BUTTON' || element.nodeName === 'LABEL' || element.getAttribute('role') === 'button') {\n            return getActionNameFromTextualContent(element, rumConfiguration, nodePrivacyLevelCache);\n        }\n    },\n    (element, rumConfiguration, nodePrivacyLevelCache) => getActionNameFromStandardAttribute(element, 'aria-label', rumConfiguration, nodePrivacyLevelCache),\n    // associated element text designated by the aria-labelledby attribute\n    (element, rumConfiguration, nodePrivacyLevelCache) => {\n        const labelledByAttribute = element.getAttribute('aria-labelledby');\n        if (labelledByAttribute) {\n            return {\n                name: labelledByAttribute\n                    .split(/\\s+/)\n                    .map((id) => getElementById(element, id))\n                    .filter((label) => Boolean(label))\n                    .map((element) => getTextualContent(element, rumConfiguration, nodePrivacyLevelCache))\n                    .join(' '),\n                nameSource: \"text_content\" /* ActionNameSource.TEXT_CONTENT */,\n            };\n        }\n    },\n    (element, rumConfiguration, nodePrivacyLevelCache) => getActionNameFromStandardAttribute(element, 'alt', rumConfiguration, nodePrivacyLevelCache),\n    (element, rumConfiguration, nodePrivacyLevelCache) => getActionNameFromStandardAttribute(element, 'name', rumConfiguration, nodePrivacyLevelCache),\n    (element, rumConfiguration, nodePrivacyLevelCache) => getActionNameFromStandardAttribute(element, 'title', rumConfiguration, nodePrivacyLevelCache),\n    (element, rumConfiguration, nodePrivacyLevelCache) => getActionNameFromStandardAttribute(element, 'placeholder', rumConfiguration, nodePrivacyLevelCache),\n    // SELECT first OPTION text\n    (element, rumConfiguration, nodePrivacyLevelCache) => {\n        if ('options' in element && element.options.length > 0) {\n            return getActionNameFromTextualContent(element.options[0], rumConfiguration, nodePrivacyLevelCache);\n        }\n    },\n];\nconst fallbackStrategies = [\n    (element, rumConfiguration, nodePrivacyLevelCache) => getActionNameFromTextualContent(element, rumConfiguration, nodePrivacyLevelCache),\n];\n/**\n * Iterates over the target element and its parent, using the strategies list to get an action name.\n * Each strategies are applied on each element, stopping as soon as a non-empty value is returned.\n */\nconst MAX_PARENTS_TO_CONSIDER = 10;\nfunction getActionNameFromElementForStrategies(targetElement, strategies, rumConfiguration, nodePrivacyLevelCache) {\n    let element = targetElement;\n    let recursionCounter = 0;\n    while (recursionCounter <= MAX_PARENTS_TO_CONSIDER &&\n        element &&\n        element.nodeName !== 'BODY' &&\n        element.nodeName !== 'HTML' &&\n        element.nodeName !== 'HEAD') {\n        for (const strategy of strategies) {\n            const actionName = strategy(element, rumConfiguration, nodePrivacyLevelCache);\n            if (actionName) {\n                const { name, nameSource } = actionName;\n                const trimmedName = name && name.trim();\n                if (trimmedName) {\n                    return { name: truncate(normalizeWhitespace(trimmedName)), nameSource };\n                }\n            }\n        }\n        // Consider a FORM as a contextual limit to get the action name.  This is experimental and may\n        // be reconsidered in the future.\n        if (element.nodeName === 'FORM') {\n            break;\n        }\n        element = element.parentElement;\n        recursionCounter += 1;\n    }\n}\nfunction normalizeWhitespace(s) {\n    return s.replace(/\\s+/g, ' ');\n}\nfunction truncate(s) {\n    return s.length > 100 ? `${safeTruncate(s, 100)} [...]` : s;\n}\nfunction getElementById(refElement, id) {\n    // Use the element ownerDocument here, because tests are executed in an iframe, so\n    // document.getElementById won't work.\n    return refElement.ownerDocument ? refElement.ownerDocument.getElementById(id) : null;\n}\nfunction getActionNameFromStandardAttribute(element, attribute, rumConfiguration, nodePrivacyLevelCache) {\n    const { enablePrivacyForActionName, defaultPrivacyLevel } = rumConfiguration;\n    let attributeValue = element.getAttribute(attribute);\n    if (attributeValue && enablePrivacyForActionName) {\n        const nodePrivacyLevel = getNodePrivacyLevel(element, defaultPrivacyLevel, nodePrivacyLevelCache);\n        if (shouldMaskAttribute(element.tagName, attribute, attributeValue, nodePrivacyLevel, rumConfiguration)) {\n            attributeValue = maskDisallowedTextContent(attributeValue, ACTION_NAME_PLACEHOLDER);\n        }\n    }\n    else if (!attributeValue) {\n        attributeValue = '';\n    }\n    return {\n        name: attributeValue,\n        nameSource: \"standard_attribute\" /* ActionNameSource.STANDARD_ATTRIBUTE */,\n    };\n}\nfunction getActionNameFromTextualContent(element, rumConfiguration, nodePrivacyLevelCache) {\n    return {\n        name: getTextualContent(element, rumConfiguration, nodePrivacyLevelCache) || '',\n        nameSource: \"text_content\" /* ActionNameSource.TEXT_CONTENT */,\n    };\n}\nfunction getTextualContent(element, rumConfiguration, nodePrivacyLevelCache) {\n    if (element.isContentEditable) {\n        return;\n    }\n    const { enablePrivacyForActionName, actionNameAttribute: userProgrammaticAttribute, defaultPrivacyLevel, } = rumConfiguration;\n    if (isExperimentalFeatureEnabled(ExperimentalFeature.USE_TREE_WALKER_FOR_ACTION_NAME)) {\n        return getTextualContentWithTreeWalker(element, userProgrammaticAttribute, enablePrivacyForActionName, defaultPrivacyLevel, nodePrivacyLevelCache);\n    }\n    if ('innerText' in element) {\n        let text = element.innerText;\n        const removeTextFromElements = (query) => {\n            const list = element.querySelectorAll(query);\n            for (let index = 0; index < list.length; index += 1) {\n                const element = list[index];\n                if ('innerText' in element) {\n                    const textToReplace = element.innerText;\n                    if (textToReplace && textToReplace.trim().length > 0) {\n                        text = text.replace(textToReplace, '');\n                    }\n                }\n            }\n        };\n        // remove the text of elements with programmatic attribute value\n        removeTextFromElements(`[${DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE}]`);\n        if (userProgrammaticAttribute) {\n            removeTextFromElements(`[${userProgrammaticAttribute}]`);\n        }\n        if (enablePrivacyForActionName) {\n            // remove the text of elements with privacy override\n            removeTextFromElements(`${getPrivacySelector(NodePrivacyLevel.HIDDEN)}, ${getPrivacySelector(NodePrivacyLevel.MASK)}`);\n        }\n        return text;\n    }\n    return element.textContent;\n}\nfunction getTextualContentWithTreeWalker(element, userProgrammaticAttribute, privacyEnabledActionName, defaultPrivacyLevel, nodePrivacyLevelCache) {\n    const walker = document.createTreeWalker(element, \n    // eslint-disable-next-line no-bitwise\n    NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_TEXT, rejectInvisibleOrMaskedElementsFilter);\n    let text = '';\n    while (walker.nextNode()) {\n        const node = walker.currentNode;\n        if (isElementNode(node)) {\n            if (\n            // Following InnerText rendering spec https://html.spec.whatwg.org/multipage/dom.html#rendered-text-collection-steps\n            node.nodeName === 'BR' ||\n                node.nodeName === 'P' ||\n                ['block', 'flex', 'grid', 'list-item', 'table', 'table-caption'].includes(getComputedStyle(node).display)) {\n                text += ' ';\n            }\n            continue; // skip element nodes\n        }\n        text += node.textContent || '';\n    }\n    return text.replace(/\\s+/g, ' ').trim();\n    function rejectInvisibleOrMaskedElementsFilter(node) {\n        const nodeSelfPrivacyLevel = getNodePrivacyLevel(node, defaultPrivacyLevel, nodePrivacyLevelCache);\n        if (privacyEnabledActionName && nodeSelfPrivacyLevel && shouldMaskNode(node, nodeSelfPrivacyLevel)) {\n            return NodeFilter.FILTER_REJECT;\n        }\n        if (isElementNode(node)) {\n            if (node.hasAttribute(DEFAULT_PROGRAMMATIC_ACTION_NAME_ATTRIBUTE) ||\n                (userProgrammaticAttribute && node.hasAttribute(userProgrammaticAttribute))) {\n                return NodeFilter.FILTER_REJECT;\n            }\n            const style = getComputedStyle(node);\n            if (style.visibility !== 'visible' ||\n                style.display === 'none' ||\n                (style.contentVisibility && style.contentVisibility !== 'visible')\n            // contentVisibility is not supported in all browsers, so we need to check it\n            ) {\n                return NodeFilter.FILTER_REJECT;\n            }\n        }\n        return NodeFilter.FILTER_ACCEPT;\n    }\n}\n//# sourceMappingURL=getActionNameFromElement.js.map","import { addEventListener } from '@datadog/browser-core';\nexport function listenActionEvents(configuration, { onPointerDown, onPointerUp }) {\n    let selectionEmptyAtPointerDown;\n    let userActivity = {\n        selection: false,\n        input: false,\n        scroll: false,\n    };\n    let clickContext;\n    const listeners = [\n        addEventListener(configuration, window, \"pointerdown\" /* DOM_EVENT.POINTER_DOWN */, (event) => {\n            if (isValidPointerEvent(event)) {\n                selectionEmptyAtPointerDown = isSelectionEmpty();\n                userActivity = {\n                    selection: false,\n                    input: false,\n                    scroll: false,\n                };\n                clickContext = onPointerDown(event);\n            }\n        }, { capture: true }),\n        addEventListener(configuration, window, \"selectionchange\" /* DOM_EVENT.SELECTION_CHANGE */, () => {\n            if (!selectionEmptyAtPointerDown || !isSelectionEmpty()) {\n                userActivity.selection = true;\n            }\n        }, { capture: true }),\n        addEventListener(configuration, window, \"scroll\" /* DOM_EVENT.SCROLL */, () => {\n            userActivity.scroll = true;\n        }, { capture: true, passive: true }),\n        addEventListener(configuration, window, \"pointerup\" /* DOM_EVENT.POINTER_UP */, (event) => {\n            if (isValidPointerEvent(event) && clickContext) {\n                // Use a scoped variable to make sure the value is not changed by other clicks\n                const localUserActivity = userActivity;\n                onPointerUp(clickContext, event, () => localUserActivity);\n                clickContext = undefined;\n            }\n        }, { capture: true }),\n        addEventListener(configuration, window, \"input\" /* DOM_EVENT.INPUT */, () => {\n            userActivity.input = true;\n        }, { capture: true }),\n    ];\n    return {\n        stop: () => {\n            listeners.forEach((listener) => listener.stop());\n        },\n    };\n}\nfunction isSelectionEmpty() {\n    const selection = window.getSelection();\n    return !selection || selection.isCollapsed;\n}\nfunction isValidPointerEvent(event) {\n    return (event.target instanceof Element &&\n        // Only consider 'primary' pointer events for now. Multi-touch support could be implemented in\n        // the future.\n        event.isPrimary !== false);\n}\n//# sourceMappingURL=listenActionEvents.js.map","import { ONE_SECOND } from '@datadog/browser-core';\nimport { FrustrationType } from '../../rawRumEvent.types';\nconst MIN_CLICKS_PER_SECOND_TO_CONSIDER_RAGE = 3;\nexport function computeFrustration(clicks, rageClick) {\n    if (isRage(clicks)) {\n        rageClick.addFrustration(FrustrationType.RAGE_CLICK);\n        if (clicks.some(isDead)) {\n            rageClick.addFrustration(FrustrationType.DEAD_CLICK);\n        }\n        if (rageClick.hasError) {\n            rageClick.addFrustration(FrustrationType.ERROR_CLICK);\n        }\n        return { isRage: true };\n    }\n    const hasSelectionChanged = clicks.some((click) => click.getUserActivity().selection);\n    clicks.forEach((click) => {\n        if (click.hasError) {\n            click.addFrustration(FrustrationType.ERROR_CLICK);\n        }\n        if (isDead(click) &&\n            // Avoid considering clicks part of a double-click or triple-click selections as dead clicks\n            !hasSelectionChanged) {\n            click.addFrustration(FrustrationType.DEAD_CLICK);\n        }\n    });\n    return { isRage: false };\n}\nexport function isRage(clicks) {\n    if (clicks.some((click) => click.getUserActivity().selection || click.getUserActivity().scroll)) {\n        return false;\n    }\n    for (let i = 0; i < clicks.length - (MIN_CLICKS_PER_SECOND_TO_CONSIDER_RAGE - 1); i += 1) {\n        if (clicks[i + MIN_CLICKS_PER_SECOND_TO_CONSIDER_RAGE - 1].event.timeStamp - clicks[i].event.timeStamp <=\n            ONE_SECOND) {\n            return true;\n        }\n    }\n    return false;\n}\nconst DEAD_CLICK_EXCLUDE_SELECTOR = \n// inputs that don't trigger a meaningful event like \"input\" when clicked, including textual\n// inputs (using a negative selector is shorter here)\n'input:not([type=\"checkbox\"]):not([type=\"radio\"]):not([type=\"button\"]):not([type=\"submit\"]):not([type=\"reset\"]):not([type=\"range\"]),' +\n    'textarea,' +\n    'select,' +\n    // contenteditable and their descendants don't always trigger meaningful changes when manipulated\n    '[contenteditable],' +\n    '[contenteditable] *,' +\n    // canvas, as there is no good way to detect activity occurring on them\n    'canvas,' +\n    // links that are interactive (have an href attribute) or any of their descendants, as they can\n    // open a new tab or navigate to a hash without triggering a meaningful event\n    'a[href],' +\n    'a[href] *';\nexport function isDead(click) {\n    if (click.hasPageActivity || click.getUserActivity().input || click.getUserActivity().scroll) {\n        return false;\n    }\n    let target = click.event.target;\n    if (target.tagName === 'LABEL' && target.hasAttribute('for')) {\n        target = document.getElementById(target.getAttribute('for'));\n    }\n    return !target || !target.matches(DEAD_CLICK_EXCLUDE_SELECTOR);\n}\n//# sourceMappingURL=computeFrustration.js.map","import { elapsed, ONE_SECOND, relativeNow } from '@datadog/browser-core';\n// Maximum duration for click actions\nexport const CLICK_ACTION_MAX_DURATION = 10 * ONE_SECOND;\nexport const interactionSelectorCache = new Map();\nexport function getInteractionSelector(relativeTimestamp) {\n    const selector = interactionSelectorCache.get(relativeTimestamp);\n    interactionSelectorCache.delete(relativeTimestamp);\n    return selector;\n}\nexport function updateInteractionSelector(relativeTimestamp, selector) {\n    interactionSelectorCache.set(relativeTimestamp, selector);\n    interactionSelectorCache.forEach((_, relativeTimestamp) => {\n        if (elapsed(relativeTimestamp, relativeNow()) > CLICK_ACTION_MAX_DURATION) {\n            interactionSelectorCache.delete(relativeTimestamp);\n        }\n    });\n}\n//# sourceMappingURL=interactionSelectorCache.js.map","import { timeStampNow, Observable, getRelativeTime, ONE_MINUTE, generateUUID, clocksNow, elapsed, createValueHistory, PageExitReason, } from '@datadog/browser-core';\nimport { ActionType } from '../../rawRumEvent.types';\nimport { trackEventCounts } from '../trackEventCounts';\nimport { PAGE_ACTIVITY_VALIDATION_DELAY, waitPageActivityEnd } from '../waitPageActivityEnd';\nimport { getSelectorFromElement } from '../getSelectorFromElement';\nimport { getNodePrivacyLevel } from '../privacy';\nimport { NodePrivacyLevel } from '../privacyConstants';\nimport { createClickChain } from './clickChain';\nimport { getActionNameFromElement } from './getActionNameFromElement';\nimport { listenActionEvents } from './listenActionEvents';\nimport { computeFrustration } from './computeFrustration';\nimport { CLICK_ACTION_MAX_DURATION, updateInteractionSelector } from './interactionSelectorCache';\nexport const ACTION_CONTEXT_TIME_OUT_DELAY = 5 * ONE_MINUTE; // arbitrary\nexport function trackClickActions(lifeCycle, domMutationObservable, windowOpenObservable, configuration) {\n    const history = createValueHistory({ expireDelay: ACTION_CONTEXT_TIME_OUT_DELAY });\n    const stopObservable = new Observable();\n    let currentClickChain;\n    lifeCycle.subscribe(10 /* LifeCycleEventType.SESSION_RENEWED */, () => {\n        history.reset();\n    });\n    lifeCycle.subscribe(5 /* LifeCycleEventType.VIEW_ENDED */, stopClickChain);\n    lifeCycle.subscribe(11 /* LifeCycleEventType.PAGE_MAY_EXIT */, (event) => {\n        if (event.reason === PageExitReason.UNLOADING) {\n            stopClickChain();\n        }\n    });\n    const { stop: stopActionEventsListener } = listenActionEvents(configuration, {\n        onPointerDown: (pointerDownEvent) => processPointerDown(configuration, lifeCycle, domMutationObservable, pointerDownEvent, windowOpenObservable),\n        onPointerUp: ({ clickActionBase, hadActivityOnPointerDown }, startEvent, getUserActivity) => {\n            startClickAction(configuration, lifeCycle, domMutationObservable, windowOpenObservable, history, stopObservable, appendClickToClickChain, clickActionBase, startEvent, getUserActivity, hadActivityOnPointerDown);\n        },\n    });\n    const actionContexts = {\n        findActionId: (startTime) => history.findAll(startTime),\n    };\n    return {\n        stop: () => {\n            stopClickChain();\n            stopObservable.notify();\n            stopActionEventsListener();\n        },\n        actionContexts,\n    };\n    function appendClickToClickChain(click) {\n        if (!currentClickChain || !currentClickChain.tryAppend(click)) {\n            const rageClick = click.clone();\n            currentClickChain = createClickChain(click, (clicks) => {\n                finalizeClicks(clicks, rageClick);\n            });\n        }\n    }\n    function stopClickChain() {\n        if (currentClickChain) {\n            currentClickChain.stop();\n        }\n    }\n}\nfunction processPointerDown(configuration, lifeCycle, domMutationObservable, pointerDownEvent, windowOpenObservable) {\n    let nodePrivacyLevel;\n    if (configuration.enablePrivacyForActionName) {\n        nodePrivacyLevel = getNodePrivacyLevel(pointerDownEvent.target, configuration.defaultPrivacyLevel);\n    }\n    else {\n        nodePrivacyLevel = NodePrivacyLevel.ALLOW;\n    }\n    if (nodePrivacyLevel === NodePrivacyLevel.HIDDEN) {\n        return undefined;\n    }\n    const clickActionBase = computeClickActionBase(pointerDownEvent, nodePrivacyLevel, configuration);\n    let hadActivityOnPointerDown = false;\n    waitPageActivityEnd(lifeCycle, domMutationObservable, windowOpenObservable, configuration, (pageActivityEndEvent) => {\n        hadActivityOnPointerDown = pageActivityEndEvent.hadActivity;\n    }, \n    // We don't care about the activity duration, we just want to know whether an activity did happen\n    // within the \"validation delay\" or not. Limit the duration so the callback is called sooner.\n    PAGE_ACTIVITY_VALIDATION_DELAY);\n    return { clickActionBase, hadActivityOnPointerDown: () => hadActivityOnPointerDown };\n}\nfunction startClickAction(configuration, lifeCycle, domMutationObservable, windowOpenObservable, history, stopObservable, appendClickToClickChain, clickActionBase, startEvent, getUserActivity, hadActivityOnPointerDown) {\n    var _a;\n    const click = newClick(lifeCycle, history, getUserActivity, clickActionBase, startEvent);\n    appendClickToClickChain(click);\n    const selector = (_a = clickActionBase === null || clickActionBase === void 0 ? void 0 : clickActionBase.target) === null || _a === void 0 ? void 0 : _a.selector;\n    if (selector) {\n        updateInteractionSelector(startEvent.timeStamp, selector);\n    }\n    const { stop: stopWaitPageActivityEnd } = waitPageActivityEnd(lifeCycle, domMutationObservable, windowOpenObservable, configuration, (pageActivityEndEvent) => {\n        if (pageActivityEndEvent.hadActivity && pageActivityEndEvent.end < click.startClocks.timeStamp) {\n            // If the clock is looking weird, just discard the click\n            click.discard();\n        }\n        else {\n            if (pageActivityEndEvent.hadActivity) {\n                click.stop(pageActivityEndEvent.end);\n            }\n            else if (hadActivityOnPointerDown()) {\n                click.stop(\n                // using the click start as activity end, so the click will have some activity but its\n                // duration will be 0 (as the activity started before the click start)\n                click.startClocks.timeStamp);\n            }\n            else {\n                click.stop();\n            }\n        }\n    }, CLICK_ACTION_MAX_DURATION);\n    const viewEndedSubscription = lifeCycle.subscribe(5 /* LifeCycleEventType.VIEW_ENDED */, ({ endClocks }) => {\n        click.stop(endClocks.timeStamp);\n    });\n    const stopSubscription = stopObservable.subscribe(() => {\n        click.stop();\n    });\n    click.stopObservable.subscribe(() => {\n        viewEndedSubscription.unsubscribe();\n        stopWaitPageActivityEnd();\n        stopSubscription.unsubscribe();\n    });\n}\nfunction computeClickActionBase(event, nodePrivacyLevel, configuration) {\n    const rect = event.target.getBoundingClientRect();\n    const selector = getSelectorFromElement(event.target, configuration.actionNameAttribute);\n    if (selector) {\n        updateInteractionSelector(event.timeStamp, selector);\n    }\n    const { name, nameSource } = getActionNameFromElement(event.target, configuration, nodePrivacyLevel);\n    return {\n        type: ActionType.CLICK,\n        target: {\n            width: Math.round(rect.width),\n            height: Math.round(rect.height),\n            selector,\n        },\n        position: {\n            // Use clientX and Y because for SVG element offsetX and Y are relatives to the <svg> element\n            x: Math.round(event.clientX - rect.left),\n            y: Math.round(event.clientY - rect.top),\n        },\n        name,\n        nameSource,\n    };\n}\nfunction newClick(lifeCycle, history, getUserActivity, clickActionBase, startEvent) {\n    const id = generateUUID();\n    const startClocks = clocksNow();\n    const historyEntry = history.add(id, startClocks.relative);\n    const eventCountsSubscription = trackEventCounts({\n        lifeCycle,\n        isChildEvent: (event) => event.action !== undefined &&\n            (Array.isArray(event.action.id) ? event.action.id.includes(id) : event.action.id === id),\n    });\n    let status = 0 /* ClickStatus.ONGOING */;\n    let activityEndTime;\n    const frustrationTypes = [];\n    const stopObservable = new Observable();\n    function stop(newActivityEndTime) {\n        if (status !== 0 /* ClickStatus.ONGOING */) {\n            return;\n        }\n        activityEndTime = newActivityEndTime;\n        status = 1 /* ClickStatus.STOPPED */;\n        if (activityEndTime) {\n            historyEntry.close(getRelativeTime(activityEndTime));\n        }\n        else {\n            historyEntry.remove();\n        }\n        eventCountsSubscription.stop();\n        stopObservable.notify();\n    }\n    return {\n        event: startEvent,\n        stop,\n        stopObservable,\n        get hasError() {\n            return eventCountsSubscription.eventCounts.errorCount > 0;\n        },\n        get hasPageActivity() {\n            return activityEndTime !== undefined;\n        },\n        getUserActivity,\n        addFrustration: (frustrationType) => {\n            frustrationTypes.push(frustrationType);\n        },\n        startClocks,\n        isStopped: () => status === 1 /* ClickStatus.STOPPED */ || status === 2 /* ClickStatus.FINALIZED */,\n        clone: () => newClick(lifeCycle, history, getUserActivity, clickActionBase, startEvent),\n        validate: (domEvents) => {\n            stop();\n            if (status !== 1 /* ClickStatus.STOPPED */) {\n                return;\n            }\n            const { resourceCount, errorCount, longTaskCount } = eventCountsSubscription.eventCounts;\n            const clickAction = {\n                duration: activityEndTime && elapsed(startClocks.timeStamp, activityEndTime),\n                startClocks,\n                id,\n                frustrationTypes,\n                counts: {\n                    resourceCount,\n                    errorCount,\n                    longTaskCount,\n                },\n                events: domEvents !== null && domEvents !== void 0 ? domEvents : [startEvent],\n                event: startEvent,\n                ...clickActionBase,\n            };\n            lifeCycle.notify(0 /* LifeCycleEventType.AUTO_ACTION_COMPLETED */, clickAction);\n            status = 2 /* ClickStatus.FINALIZED */;\n        },\n        discard: () => {\n            stop();\n            status = 2 /* ClickStatus.FINALIZED */;\n        },\n    };\n}\nexport function finalizeClicks(clicks, rageClick) {\n    const { isRage } = computeFrustration(clicks, rageClick);\n    if (isRage) {\n        clicks.forEach((click) => click.discard());\n        rageClick.stop(timeStampNow());\n        rageClick.validate(clicks.map((click) => click.event));\n    }\n    else {\n        rageClick.discard();\n        clicks.forEach((click) => click.validate());\n    }\n}\n//# sourceMappingURL=trackClickActions.js.map","import { noop, combine, toServerDuration, generateUUID, SKIPPED } from '@datadog/browser-core';\nimport { discardNegativeDuration } from '../discardNegativeDuration';\nimport { ActionType, RumEventType } from '../../rawRumEvent.types';\nimport { trackClickActions } from './trackClickActions';\nexport function startActionCollection(lifeCycle, hooks, domMutationObservable, windowOpenObservable, configuration) {\n    const { unsubscribe: unsubscribeAutoAction } = lifeCycle.subscribe(0 /* LifeCycleEventType.AUTO_ACTION_COMPLETED */, (action) => {\n        lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, processAction(action));\n    });\n    hooks.register(0 /* HookNames.Assemble */, ({ startTime, eventType }) => {\n        if (eventType !== RumEventType.ERROR &&\n            eventType !== RumEventType.RESOURCE &&\n            eventType !== RumEventType.LONG_TASK) {\n            return SKIPPED;\n        }\n        const actionId = actionContexts.findActionId(startTime);\n        if (!actionId) {\n            return SKIPPED;\n        }\n        return {\n            type: eventType,\n            action: { id: actionId },\n        };\n    });\n    hooks.register(1 /* HookNames.AssembleTelemetry */, ({ startTime }) => ({\n        action: { id: actionContexts.findActionId(startTime) },\n    }));\n    let actionContexts = { findActionId: noop };\n    let stop = noop;\n    if (configuration.trackUserInteractions) {\n        ;\n        ({ actionContexts, stop } = trackClickActions(lifeCycle, domMutationObservable, windowOpenObservable, configuration));\n    }\n    return {\n        addAction: (action) => {\n            lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, processAction(action));\n        },\n        actionContexts,\n        stop: () => {\n            unsubscribeAutoAction();\n            stop();\n        },\n    };\n}\nfunction processAction(action) {\n    const autoActionProperties = isAutoAction(action)\n        ? {\n            action: {\n                id: action.id,\n                loading_time: discardNegativeDuration(toServerDuration(action.duration)),\n                frustration: {\n                    type: action.frustrationTypes,\n                },\n                error: {\n                    count: action.counts.errorCount,\n                },\n                long_task: {\n                    count: action.counts.longTaskCount,\n                },\n                resource: {\n                    count: action.counts.resourceCount,\n                },\n            },\n            _dd: {\n                action: {\n                    target: action.target,\n                    position: action.position,\n                    name_source: action.nameSource,\n                },\n            },\n        }\n        : {\n            context: action.context,\n        };\n    const actionEvent = combine({\n        action: { id: generateUUID(), target: { name: action.name }, type: action.type },\n        date: action.startClocks.timeStamp,\n        type: RumEventType.ACTION,\n    }, autoActionProperties);\n    const duration = isAutoAction(action) ? action.duration : undefined;\n    const domainContext = isAutoAction(action)\n        ? { events: action.events }\n        : { handlingStack: action.handlingStack };\n    return {\n        rawRumEvent: actionEvent,\n        duration,\n        startTime: action.startClocks.relative,\n        domainContext,\n    };\n}\nfunction isAutoAction(action) {\n    return action.type !== ActionType.CUSTOM;\n}\n//# sourceMappingURL=actionCollection.js.map","import { initConsoleObservable, ConsoleApiName } from '@datadog/browser-core';\nexport function trackConsoleError(errorObservable) {\n    const subscription = initConsoleObservable([ConsoleApiName.error]).subscribe((consoleLog) => errorObservable.notify(consoleLog.error));\n    return {\n        stop: () => {\n            subscription.unsubscribe();\n        },\n    };\n}\n//# sourceMappingURL=trackConsoleError.js.map","import { initReportObservable, RawReportType } from '@datadog/browser-core';\nexport function trackReportError(configuration, errorObservable) {\n    const subscription = initReportObservable(configuration, [\n        RawReportType.cspViolation,\n        RawReportType.intervention,\n    ]).subscribe((rawError) => errorObservable.notify(rawError));\n    return {\n        stop: () => {\n            subscription.unsubscribe();\n        },\n    };\n}\n//# sourceMappingURL=trackReportError.js.map","import { Observable, ErrorSource, generateUUID, computeRawError, combine, } from '@datadog/browser-core';\nimport { RumEventType } from '../../rawRumEvent.types';\nimport { trackConsoleError } from './trackConsoleError';\nimport { trackReportError } from './trackReportError';\nexport function startErrorCollection(lifeCycle, configuration, bufferedDataObservable) {\n    const errorObservable = new Observable();\n    bufferedDataObservable.subscribe((bufferedData) => {\n        if (bufferedData.type === 0 /* BufferedDataType.RUNTIME_ERROR */) {\n            errorObservable.notify(bufferedData.error);\n        }\n    });\n    trackConsoleError(errorObservable);\n    trackReportError(configuration, errorObservable);\n    errorObservable.subscribe((error) => lifeCycle.notify(14 /* LifeCycleEventType.RAW_ERROR_COLLECTED */, { error }));\n    return doStartErrorCollection(lifeCycle);\n}\nexport function doStartErrorCollection(lifeCycle) {\n    lifeCycle.subscribe(14 /* LifeCycleEventType.RAW_ERROR_COLLECTED */, ({ error }) => {\n        lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, processError(error));\n    });\n    return {\n        addError: ({ error, handlingStack, componentStack, startClocks, context }) => {\n            const rawError = computeRawError({\n                originalError: error,\n                handlingStack,\n                componentStack,\n                startClocks,\n                nonErrorPrefix: \"Provided\" /* NonErrorPrefix.PROVIDED */,\n                source: ErrorSource.CUSTOM,\n                handling: \"handled\" /* ErrorHandling.HANDLED */,\n            });\n            rawError.context = combine(rawError.context, context);\n            lifeCycle.notify(14 /* LifeCycleEventType.RAW_ERROR_COLLECTED */, { error: rawError });\n        },\n    };\n}\nfunction processError(error) {\n    const rawRumEvent = {\n        date: error.startClocks.timeStamp,\n        error: {\n            id: generateUUID(),\n            message: error.message,\n            source: error.source,\n            stack: error.stack,\n            handling_stack: error.handlingStack,\n            component_stack: error.componentStack,\n            type: error.type,\n            handling: error.handling,\n            causes: error.causes,\n            source_type: 'browser',\n            fingerprint: error.fingerprint,\n            csp: error.csp,\n        },\n        type: RumEventType.ERROR,\n        context: error.context,\n    };\n    const domainContext = {\n        error: error.originalError,\n        handlingStack: error.handlingStack,\n    };\n    return {\n        rawRumEvent,\n        startTime: error.startClocks.relative,\n        domainContext,\n    };\n}\n//# sourceMappingURL=errorCollection.js.map","import { addDuration } from '@datadog/browser-core';\nimport { hasValidResourceEntryDuration, hasValidResourceEntryTimings } from './resourceUtils';\nconst alreadyMatchedEntries = new WeakSet();\n/**\n * Look for corresponding timing in resource timing buffer\n *\n * Observations:\n * - Timing (start, end) are nested inside the request (start, end)\n * - Some timing can be not exactly nested, being off by < 1 ms\n *\n * Strategy:\n * - from valid nested entries (with 1 ms error margin)\n * - filter out timing that were already matched to a request\n * - then, if a single timing match, return the timing\n * - otherwise we can't decide, return undefined\n */\nexport function matchRequestResourceEntry(request) {\n    if (!performance || !('getEntriesByName' in performance)) {\n        return;\n    }\n    const sameNameEntries = performance.getEntriesByName(request.url, 'resource');\n    if (!sameNameEntries.length || !('toJSON' in sameNameEntries[0])) {\n        return;\n    }\n    const candidates = sameNameEntries\n        .filter((entry) => !alreadyMatchedEntries.has(entry))\n        .filter((entry) => hasValidResourceEntryDuration(entry) && hasValidResourceEntryTimings(entry))\n        .filter((entry) => isBetween(entry, request.startClocks.relative, endTime({ startTime: request.startClocks.relative, duration: request.duration })));\n    if (candidates.length === 1) {\n        alreadyMatchedEntries.add(candidates[0]);\n        return candidates[0].toJSON();\n    }\n    return;\n}\nfunction endTime(timing) {\n    return addDuration(timing.startTime, timing.duration);\n}\nfunction isBetween(timing, start, end) {\n    const errorMargin = 1;\n    return timing.startTime >= start - errorMargin && endTime(timing) <= addDuration(end, errorMargin);\n}\n//# sourceMappingURL=matchRequestResourceEntry.js.map","import { dateNow, findCommaSeparatedValue, ONE_MINUTE } from '@datadog/browser-core';\nimport { isCommentNode, isTextNode } from '../../browser/htmlDomUtils';\nexport const INITIAL_DOCUMENT_OUTDATED_TRACE_ID_THRESHOLD = 2 * ONE_MINUTE;\nexport function getDocumentTraceId(document) {\n    const data = getDocumentTraceDataFromMeta(document) || getDocumentTraceDataFromComment(document);\n    if (!data || data.traceTime <= dateNow() - INITIAL_DOCUMENT_OUTDATED_TRACE_ID_THRESHOLD) {\n        return undefined;\n    }\n    return data.traceId;\n}\nexport function getDocumentTraceDataFromMeta(document) {\n    const traceIdMeta = document.querySelector('meta[name=dd-trace-id]');\n    const traceTimeMeta = document.querySelector('meta[name=dd-trace-time]');\n    return createDocumentTraceData(traceIdMeta && traceIdMeta.content, traceTimeMeta && traceTimeMeta.content);\n}\nexport function getDocumentTraceDataFromComment(document) {\n    const comment = findTraceComment(document);\n    if (!comment) {\n        return undefined;\n    }\n    return createDocumentTraceData(findCommaSeparatedValue(comment, 'trace-id'), findCommaSeparatedValue(comment, 'trace-time'));\n}\nexport function createDocumentTraceData(traceId, rawTraceTime) {\n    const traceTime = rawTraceTime && Number(rawTraceTime);\n    if (!traceId || !traceTime) {\n        return undefined;\n    }\n    return {\n        traceId,\n        traceTime,\n    };\n}\nexport function findTraceComment(document) {\n    // 1. Try to find the comment as a direct child of the document\n    // Note: TSLint advises to use a 'for of', but TS doesn't allow to use 'for of' if the iterated\n    // value is not an array or string (here, a NodeList).\n    for (let i = 0; i < document.childNodes.length; i += 1) {\n        const comment = getTraceCommentFromNode(document.childNodes[i]);\n        if (comment) {\n            return comment;\n        }\n    }\n    // 2. If the comment is placed after the </html> tag, but have some space or new lines before or\n    // after, the DOM parser will lift it (and the surrounding text) at the end of the <body> tag.\n    // Try to look for the comment at the end of the <body> by by iterating over its child nodes in\n    // reverse order, stopping if we come across a non-text node.\n    if (document.body) {\n        for (let i = document.body.childNodes.length - 1; i >= 0; i -= 1) {\n            const node = document.body.childNodes[i];\n            const comment = getTraceCommentFromNode(node);\n            if (comment) {\n                return comment;\n            }\n            if (!isTextNode(node)) {\n                break;\n            }\n        }\n    }\n}\nfunction getTraceCommentFromNode(node) {\n    if (node && isCommentNode(node)) {\n        const match = /^\\s*DATADOG;(.*?)\\s*$/.exec(node.data);\n        if (match) {\n            return match[1];\n        }\n    }\n}\n//# sourceMappingURL=getDocumentTraceId.js.map","import { getRelativeTime, isNumber } from '@datadog/browser-core';\nimport { RumPerformanceEntryType, supportPerformanceTimingEvent } from './performanceObservable';\nexport function getNavigationEntry() {\n    if (supportPerformanceTimingEvent(RumPerformanceEntryType.NAVIGATION)) {\n        const navigationEntry = performance.getEntriesByType(RumPerformanceEntryType.NAVIGATION)[0];\n        if (navigationEntry) {\n            return navigationEntry;\n        }\n    }\n    const timings = computeTimingsFromDeprecatedPerformanceTiming();\n    const entry = {\n        entryType: RumPerformanceEntryType.NAVIGATION,\n        initiatorType: 'navigation',\n        name: window.location.href,\n        startTime: 0,\n        duration: timings.loadEventEnd,\n        decodedBodySize: 0,\n        encodedBodySize: 0,\n        transferSize: 0,\n        workerStart: 0,\n        toJSON: () => ({ ...entry, toJSON: undefined }),\n        ...timings,\n    };\n    return entry;\n}\nexport function computeTimingsFromDeprecatedPerformanceTiming() {\n    const result = {};\n    const timing = performance.timing;\n    for (const key in timing) {\n        if (isNumber(timing[key])) {\n            const numberKey = key;\n            const timingElement = timing[numberKey];\n            result[numberKey] = timingElement === 0 ? 0 : getRelativeTime(timingElement);\n        }\n    }\n    return result;\n}\n//# sourceMappingURL=performanceUtils.js.map","import { runOnReadyState } from '@datadog/browser-core';\nimport { RumPerformanceEntryType } from '../../browser/performanceObservable';\nimport { getDocumentTraceId } from '../tracing/getDocumentTraceId';\nimport { getNavigationEntry } from '../../browser/performanceUtils';\nimport { FAKE_INITIAL_DOCUMENT } from './resourceUtils';\nexport function retrieveInitialDocumentResourceTiming(configuration, callback, getNavigationEntryImpl = getNavigationEntry) {\n    runOnReadyState(configuration, 'interactive', () => {\n        const navigationEntry = getNavigationEntryImpl();\n        const entry = Object.assign(navigationEntry.toJSON(), {\n            entryType: RumPerformanceEntryType.RESOURCE,\n            initiatorType: FAKE_INITIAL_DOCUMENT,\n            // The ResourceTiming duration entry should be `responseEnd - startTime`. With\n            // NavigationTiming entries, `startTime` is always 0, so set it to `responseEnd`.\n            duration: navigationEntry.responseEnd,\n            traceId: getDocumentTraceId(document),\n            toJSON: () => ({ ...entry, toJSON: undefined }),\n        });\n        callback(entry);\n    });\n}\n//# sourceMappingURL=retrieveInitialDocumentResourceTiming.js.map","import { addTelemetryDebug } from '@datadog/browser-core';\n// Maximum number of requests to keep in the registry. Requests should be removed quite quickly in\n// general, this is just a safety limit to avoid memory leaks in case of a bug.\nexport const MAX_REQUESTS = 1000;\nexport function createRequestRegistry(lifeCycle) {\n    const requests = new Set();\n    const subscription = lifeCycle.subscribe(8 /* LifeCycleEventType.REQUEST_COMPLETED */, (request) => {\n        requests.add(request);\n        if (requests.size > MAX_REQUESTS) {\n            // monitor-until: 2026-01-01, after early request collection GA\n            addTelemetryDebug('Too many requests');\n            requests.delete(requests.values().next().value);\n        }\n    });\n    return {\n        getMatchingRequest(entry) {\n            // Returns the closest request object that happened before the entry\n            let minTimeDifference = Infinity;\n            let closestRequest;\n            for (const request of requests) {\n                const timeDifference = entry.startTime - request.startClocks.relative;\n                if (0 <= timeDifference && timeDifference < minTimeDifference && request.url === entry.name) {\n                    minTimeDifference = Math.abs(timeDifference);\n                    closestRequest = request;\n                }\n            }\n            if (closestRequest) {\n                requests.delete(closestRequest);\n            }\n            return closestRequest;\n        },\n        stop() {\n            subscription.unsubscribe();\n        },\n    };\n}\n//# sourceMappingURL=requestRegistry.js.map","import { combine, generateUUID, RequestType, ResourceType, toServerDuration, relativeToClocks, createTaskQueue, } from '@datadog/browser-core';\nimport { RumPerformanceEntryType, createPerformanceObservable } from '../../browser/performanceObservable';\nimport { RumEventType } from '../../rawRumEvent.types';\nimport { createSpanIdentifier } from '../tracing/identifier';\nimport { matchRequestResourceEntry } from './matchRequestResourceEntry';\nimport { computeResourceEntryDetails, computeResourceEntryDuration, computeResourceEntryType, computeResourceEntrySize, computeResourceEntryProtocol, computeResourceEntryDeliveryType, isResourceEntryRequestType, sanitizeIfLongDataUrl, } from './resourceUtils';\nimport { retrieveInitialDocumentResourceTiming } from './retrieveInitialDocumentResourceTiming';\nimport { createRequestRegistry } from './requestRegistry';\nimport { extractGraphQlMetadata, findGraphQlConfiguration } from './graphql';\nexport function startResourceCollection(lifeCycle, configuration, pageStateHistory, taskQueue = createTaskQueue(), retrieveInitialDocumentResourceTimingImpl = retrieveInitialDocumentResourceTiming) {\n    let requestRegistry;\n    const isEarlyRequestCollectionEnabled = configuration.trackEarlyRequests;\n    if (isEarlyRequestCollectionEnabled) {\n        requestRegistry = createRequestRegistry(lifeCycle);\n    }\n    else {\n        lifeCycle.subscribe(8 /* LifeCycleEventType.REQUEST_COMPLETED */, (request) => {\n            handleResource(() => processRequest(request, configuration, pageStateHistory));\n        });\n    }\n    const performanceResourceSubscription = createPerformanceObservable(configuration, {\n        type: RumPerformanceEntryType.RESOURCE,\n        buffered: true,\n    }).subscribe((entries) => {\n        for (const entry of entries) {\n            if (isEarlyRequestCollectionEnabled || !isResourceEntryRequestType(entry)) {\n                handleResource(() => processResourceEntry(entry, configuration, pageStateHistory, requestRegistry));\n            }\n        }\n    });\n    retrieveInitialDocumentResourceTimingImpl(configuration, (timing) => {\n        handleResource(() => processResourceEntry(timing, configuration, pageStateHistory, requestRegistry));\n    });\n    function handleResource(computeRawEvent) {\n        taskQueue.push(() => {\n            const rawEvent = computeRawEvent();\n            if (rawEvent) {\n                lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, rawEvent);\n            }\n        });\n    }\n    return {\n        stop: () => {\n            taskQueue.stop();\n            performanceResourceSubscription.unsubscribe();\n        },\n    };\n}\nfunction processRequest(request, configuration, pageStateHistory) {\n    const matchingTiming = matchRequestResourceEntry(request);\n    return assembleResource(matchingTiming, request, pageStateHistory, configuration);\n}\nfunction processResourceEntry(entry, configuration, pageStateHistory, requestRegistry) {\n    const matchingRequest = isResourceEntryRequestType(entry) && requestRegistry ? requestRegistry.getMatchingRequest(entry) : undefined;\n    return assembleResource(entry, matchingRequest, pageStateHistory, configuration);\n}\n// TODO: In the future, the `entry` parameter should be required, making things simpler.\nfunction assembleResource(entry, request, pageStateHistory, configuration) {\n    if (!entry && !request) {\n        return;\n    }\n    const tracingInfo = request\n        ? computeRequestTracingInfo(request, configuration)\n        : computeResourceEntryTracingInfo(entry, configuration);\n    if (!configuration.trackResources && !tracingInfo) {\n        return;\n    }\n    const startClocks = entry ? relativeToClocks(entry.startTime) : request.startClocks;\n    const duration = entry\n        ? computeResourceEntryDuration(entry)\n        : computeRequestDuration(pageStateHistory, startClocks, request.duration);\n    const graphql = request && computeGraphQlMetaData(request, configuration);\n    const resourceEvent = combine({\n        date: startClocks.timeStamp,\n        resource: {\n            id: generateUUID(),\n            duration: toServerDuration(duration),\n            // TODO: in the future when `entry` is required, we can probably only rely on `computeResourceEntryType`\n            type: request\n                ? request.type === RequestType.XHR\n                    ? ResourceType.XHR\n                    : ResourceType.FETCH\n                : computeResourceEntryType(entry),\n            method: request ? request.method : undefined,\n            status_code: request ? request.status : discardZeroStatus(entry.responseStatus),\n            url: request ? sanitizeIfLongDataUrl(request.url) : entry.name,\n            protocol: entry && computeResourceEntryProtocol(entry),\n            delivery_type: entry && computeResourceEntryDeliveryType(entry),\n            graphql,\n        },\n        type: RumEventType.RESOURCE,\n        _dd: {\n            discarded: !configuration.trackResources,\n        },\n    }, tracingInfo, entry && computeResourceEntryMetrics(entry));\n    return {\n        startTime: startClocks.relative,\n        duration,\n        rawRumEvent: resourceEvent,\n        domainContext: getResourceDomainContext(entry, request),\n    };\n}\nfunction computeGraphQlMetaData(request, configuration) {\n    const graphQlConfig = findGraphQlConfiguration(request.url, configuration);\n    if (!graphQlConfig) {\n        return;\n    }\n    return extractGraphQlMetadata(request, graphQlConfig);\n}\nfunction getResourceDomainContext(entry, request) {\n    if (request) {\n        const baseDomainContext = {\n            performanceEntry: entry,\n            isAborted: request.isAborted,\n            handlingStack: request.handlingStack,\n        };\n        if (request.type === RequestType.XHR) {\n            return {\n                xhr: request.xhr,\n                ...baseDomainContext,\n            };\n        }\n        return {\n            requestInput: request.input,\n            requestInit: request.init,\n            response: request.response,\n            error: request.error,\n            ...baseDomainContext,\n        };\n    }\n    return {\n        // Currently, at least one of `entry` or `request` must be defined when calling this function.\n        // So `entry` is guaranteed to be defined here. In the future, when `entry` is required, we can\n        // remove the `!` assertion.\n        performanceEntry: entry,\n    };\n}\nfunction computeResourceEntryMetrics(entry) {\n    const { renderBlockingStatus } = entry;\n    return {\n        resource: {\n            render_blocking_status: renderBlockingStatus,\n            ...computeResourceEntrySize(entry),\n            ...computeResourceEntryDetails(entry),\n        },\n    };\n}\nfunction computeRequestTracingInfo(request, configuration) {\n    const hasBeenTraced = request.traceSampled && request.traceId && request.spanId;\n    if (!hasBeenTraced) {\n        return undefined;\n    }\n    return {\n        _dd: {\n            span_id: request.spanId.toString(),\n            trace_id: request.traceId.toString(),\n            rule_psr: configuration.rulePsr,\n        },\n    };\n}\nfunction computeResourceEntryTracingInfo(entry, configuration) {\n    const hasBeenTraced = entry.traceId;\n    if (!hasBeenTraced) {\n        return undefined;\n    }\n    return {\n        _dd: {\n            trace_id: entry.traceId,\n            span_id: createSpanIdentifier().toString(),\n            rule_psr: configuration.rulePsr,\n        },\n    };\n}\nfunction computeRequestDuration(pageStateHistory, startClocks, duration) {\n    return !pageStateHistory.wasInPageStateDuringPeriod(\"frozen\" /* PageState.FROZEN */, startClocks.relative, duration)\n        ? duration\n        : undefined;\n}\n/**\n * The status is 0 for cross-origin resources without CORS headers, so the status is meaningless, and we shouldn't report it\n * https://developer.mozilla.org/en-US/docs/Web/API/PerformanceResourceTiming/responseStatus#cross-origin_response_status_codes\n */\nfunction discardZeroStatus(statusCode) {\n    return statusCode === 0 ? undefined : statusCode;\n}\n//# sourceMappingURL=resourceCollection.js.map","import { trackEventCounts } from '../trackEventCounts';\nexport function trackViewEventCounts(lifeCycle, viewId, onChange) {\n    const { stop, eventCounts } = trackEventCounts({\n        lifeCycle,\n        isChildEvent: (event) => event.view.id === viewId,\n        onChange,\n    });\n    return {\n        stop,\n        eventCounts,\n    };\n}\n//# sourceMappingURL=trackViewEventCounts.js.map","import { ONE_MINUTE, elapsed, relativeNow } from '@datadog/browser-core';\nimport { createPerformanceObservable, RumPerformanceEntryType } from '../../../browser/performanceObservable';\n// Discard FCP timings above a certain delay to avoid incorrect data\n// It happens in some cases like sleep mode or some browser implementations\nexport const FCP_MAXIMUM_DELAY = 10 * ONE_MINUTE;\nexport function trackFirstContentfulPaint(configuration, firstHidden, callback) {\n    const performanceSubscription = createPerformanceObservable(configuration, {\n        type: RumPerformanceEntryType.PAINT,\n        buffered: true,\n    }).subscribe((entries) => {\n        const fcpEntry = entries.find((entry) => entry.name === 'first-contentful-paint' &&\n            entry.startTime < firstHidden.timeStamp &&\n            entry.startTime < FCP_MAXIMUM_DELAY);\n        if (fcpEntry) {\n            callback(fcpEntry.startTime);\n        }\n    });\n    return {\n        stop: performanceSubscription.unsubscribe,\n    };\n}\n/**\n * Measure the First Contentful Paint after a BFCache restoration.\n * The DOM is restored synchronously, so we approximate the FCP with the first frame\n * rendered just after the pageshow event, using two nested requestAnimationFrame calls.\n */\nexport function trackRestoredFirstContentfulPaint(viewStartRelative, callback) {\n    requestAnimationFrame(() => {\n        requestAnimationFrame(() => {\n            callback(elapsed(viewStartRelative, relativeNow()));\n        });\n    });\n}\n//# sourceMappingURL=trackFirstContentfulPaint.js.map","import { elapsed } from '@datadog/browser-core';\nimport { isElementNode } from '../../../browser/htmlDomUtils';\nimport { createPerformanceObservable, RumPerformanceEntryType } from '../../../browser/performanceObservable';\nimport { getSelectorFromElement } from '../../getSelectorFromElement';\n/**\n * Track the first input occurring during the initial View to return:\n * - First Input Delay\n * - First Input Time\n * Callback is called at most one time.\n * Documentation: https://web.dev/fid/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getFID.ts\n */\nexport function trackFirstInput(configuration, firstHidden, callback) {\n    const performanceFirstInputSubscription = createPerformanceObservable(configuration, {\n        type: RumPerformanceEntryType.FIRST_INPUT,\n        buffered: true,\n    }).subscribe((entries) => {\n        const firstInputEntry = entries.find((entry) => entry.startTime < firstHidden.timeStamp);\n        if (firstInputEntry) {\n            const firstInputDelay = elapsed(firstInputEntry.startTime, firstInputEntry.processingStart);\n            let firstInputTargetSelector;\n            if (firstInputEntry.target && isElementNode(firstInputEntry.target)) {\n                firstInputTargetSelector = getSelectorFromElement(firstInputEntry.target, configuration.actionNameAttribute);\n            }\n            callback({\n                // Ensure firstInputDelay to be positive, see\n                // https://bugs.chromium.org/p/chromium/issues/detail?id=1185815\n                delay: firstInputDelay >= 0 ? firstInputDelay : 0,\n                time: firstInputEntry.startTime,\n                targetSelector: firstInputTargetSelector,\n            });\n        }\n    });\n    return {\n        stop: () => {\n            performanceFirstInputSubscription.unsubscribe();\n        },\n    };\n}\n//# sourceMappingURL=trackFirstInput.js.map","import { setTimeout, relativeNow, runOnReadyState, clearTimeout } from '@datadog/browser-core';\nimport { getNavigationEntry } from '../../../browser/performanceUtils';\nexport function trackNavigationTimings(configuration, callback, getNavigationEntryImpl = getNavigationEntry) {\n    return waitAfterLoadEvent(configuration, () => {\n        const entry = getNavigationEntryImpl();\n        if (!isIncompleteNavigation(entry)) {\n            callback(processNavigationEntry(entry));\n        }\n    });\n}\nfunction processNavigationEntry(entry) {\n    return {\n        domComplete: entry.domComplete,\n        domContentLoaded: entry.domContentLoadedEventEnd,\n        domInteractive: entry.domInteractive,\n        loadEvent: entry.loadEventEnd,\n        // In some cases the value reported is negative or is larger\n        // than the current page time. Ignore these cases:\n        // https://github.com/GoogleChrome/web-vitals/issues/137\n        // https://github.com/GoogleChrome/web-vitals/issues/162\n        firstByte: entry.responseStart >= 0 && entry.responseStart <= relativeNow() ? entry.responseStart : undefined,\n    };\n}\nfunction isIncompleteNavigation(entry) {\n    return entry.loadEventEnd <= 0;\n}\nfunction waitAfterLoadEvent(configuration, callback) {\n    let timeoutId;\n    const { stop: stopOnReadyState } = runOnReadyState(configuration, 'complete', () => {\n        // Invoke the callback a bit after the actual load event, so the \"loadEventEnd\" timing is accurate\n        timeoutId = setTimeout(() => callback());\n    });\n    return {\n        stop: () => {\n            stopOnReadyState();\n            clearTimeout(timeoutId);\n        },\n    };\n}\n//# sourceMappingURL=trackNavigationTimings.js.map","import { ONE_MINUTE, addEventListeners, findLast } from '@datadog/browser-core';\nimport { createPerformanceObservable, RumPerformanceEntryType } from '../../../browser/performanceObservable';\nimport { getSelectorFromElement } from '../../getSelectorFromElement';\n// Discard LCP timings above a certain delay to avoid incorrect data\n// It happens in some cases like sleep mode or some browser implementations\nexport const LCP_MAXIMUM_DELAY = 10 * ONE_MINUTE;\n/**\n * Track the largest contentful paint (LCP) occurring during the initial View.  This can yield\n * multiple values, only the most recent one should be used.\n * Documentation: https://web.dev/lcp/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/onLCP.ts\n */\nexport function trackLargestContentfulPaint(configuration, firstHidden, eventTarget, callback) {\n    // Ignore entries that come after the first user interaction. According to the documentation, the\n    // browser should not send largest-contentful-paint entries after a user interact with the page,\n    // but the web-vitals reference implementation uses this as a safeguard.\n    let firstInteractionTimestamp = Infinity;\n    const { stop: stopEventListener } = addEventListeners(configuration, eventTarget, [\"pointerdown\" /* DOM_EVENT.POINTER_DOWN */, \"keydown\" /* DOM_EVENT.KEY_DOWN */], (event) => {\n        firstInteractionTimestamp = event.timeStamp;\n    }, { capture: true, once: true });\n    let biggestLcpSize = 0;\n    const performanceLcpSubscription = createPerformanceObservable(configuration, {\n        type: RumPerformanceEntryType.LARGEST_CONTENTFUL_PAINT,\n        buffered: true,\n    }).subscribe((entries) => {\n        const lcpEntry = findLast(entries, (entry) => entry.entryType === RumPerformanceEntryType.LARGEST_CONTENTFUL_PAINT &&\n            entry.startTime < firstInteractionTimestamp &&\n            entry.startTime < firstHidden.timeStamp &&\n            entry.startTime < LCP_MAXIMUM_DELAY &&\n            // Ensure to get the LCP entry with the biggest size, see\n            // https://bugs.chromium.org/p/chromium/issues/detail?id=1516655\n            entry.size > biggestLcpSize);\n        if (lcpEntry) {\n            let lcpTargetSelector;\n            if (lcpEntry.element) {\n                lcpTargetSelector = getSelectorFromElement(lcpEntry.element, configuration.actionNameAttribute);\n            }\n            callback({\n                value: lcpEntry.startTime,\n                targetSelector: lcpTargetSelector,\n                resourceUrl: computeLcpEntryUrl(lcpEntry),\n            });\n            biggestLcpSize = lcpEntry.size;\n        }\n    });\n    return {\n        stop: () => {\n            stopEventListener();\n            performanceLcpSubscription.unsubscribe();\n        },\n    };\n}\n// The property url report an empty string if the value is not available, we shouldn't report it in this case.\nfunction computeLcpEntryUrl(entry) {\n    return entry.url === '' ? undefined : entry.url;\n}\n//# sourceMappingURL=trackLargestContentfulPaint.js.map","import { addEventListeners, noop } from '@datadog/browser-core';\nimport { supportPerformanceTimingEvent, RumPerformanceEntryType } from '../../../browser/performanceObservable';\nexport function trackFirstHidden(configuration, viewStart, eventTarget = window) {\n    if (document.visibilityState === 'hidden') {\n        return { timeStamp: 0, stop: noop };\n    }\n    if (supportPerformanceTimingEvent(RumPerformanceEntryType.VISIBILITY_STATE)) {\n        const firstHiddenEntry = performance\n            .getEntriesByType(RumPerformanceEntryType.VISIBILITY_STATE)\n            .filter((entry) => entry.name === 'hidden')\n            .find((entry) => entry.startTime >= viewStart.relative);\n        if (firstHiddenEntry) {\n            return { timeStamp: firstHiddenEntry.startTime, stop: noop };\n        }\n    }\n    let timeStamp = Infinity;\n    const { stop } = addEventListeners(configuration, eventTarget, [\"pagehide\" /* DOM_EVENT.PAGE_HIDE */, \"visibilitychange\" /* DOM_EVENT.VISIBILITY_CHANGE */], (event) => {\n        if (event.type === \"pagehide\" /* DOM_EVENT.PAGE_HIDE */ || document.visibilityState === 'hidden') {\n            timeStamp = event.timeStamp;\n            stop();\n        }\n    }, { capture: true });\n    return {\n        get timeStamp() {\n            return timeStamp;\n        },\n        stop,\n    };\n}\n//# sourceMappingURL=trackFirstHidden.js.map","import { trackFirstContentfulPaint } from './trackFirstContentfulPaint';\nimport { trackFirstInput } from './trackFirstInput';\nimport { trackNavigationTimings } from './trackNavigationTimings';\nimport { trackLargestContentfulPaint } from './trackLargestContentfulPaint';\nimport { trackFirstHidden } from './trackFirstHidden';\nexport function trackInitialViewMetrics(configuration, viewStart, setLoadEvent, scheduleViewUpdate) {\n    const initialViewMetrics = {};\n    const { stop: stopNavigationTracking } = trackNavigationTimings(configuration, (navigationTimings) => {\n        setLoadEvent(navigationTimings.loadEvent);\n        initialViewMetrics.navigationTimings = navigationTimings;\n        scheduleViewUpdate();\n    });\n    const firstHidden = trackFirstHidden(configuration, viewStart);\n    const { stop: stopFCPTracking } = trackFirstContentfulPaint(configuration, firstHidden, (firstContentfulPaint) => {\n        initialViewMetrics.firstContentfulPaint = firstContentfulPaint;\n        scheduleViewUpdate();\n    });\n    const { stop: stopLCPTracking } = trackLargestContentfulPaint(configuration, firstHidden, window, (largestContentfulPaint) => {\n        initialViewMetrics.largestContentfulPaint = largestContentfulPaint;\n        scheduleViewUpdate();\n    });\n    const { stop: stopFIDTracking } = trackFirstInput(configuration, firstHidden, (firstInput) => {\n        initialViewMetrics.firstInput = firstInput;\n        scheduleViewUpdate();\n    });\n    function stop() {\n        stopNavigationTracking();\n        stopFCPTracking();\n        stopLCPTracking();\n        stopFIDTracking();\n        firstHidden.stop();\n    }\n    return {\n        stop,\n        initialViewMetrics,\n    };\n}\n//# sourceMappingURL=trackInitialViewMetrics.js.map","/**\n * Calculates the area of a rectangle given its width and height\n */\nconst calculateArea = (width, height) => width * height;\n/**\n * Calculates the intersection area between two rectangles\n */\nconst calculateIntersectionArea = (rect1, rect2) => {\n    const left = Math.max(rect1.left, rect2.left);\n    const top = Math.max(rect1.top, rect2.top);\n    const right = Math.min(rect1.right, rect2.right);\n    const bottom = Math.min(rect1.bottom, rect2.bottom);\n    if (left >= right || top >= bottom) {\n        return 0;\n    }\n    return calculateArea(right - left, bottom - top);\n};\n/**\n * Calculates the total impacted area of a layout shift source\n * This is the sum of the previous and current areas minus their intersection\n */\nexport const getClsAttributionImpactedArea = (source) => {\n    const previousArea = calculateArea(source.previousRect.width, source.previousRect.height);\n    const currentArea = calculateArea(source.currentRect.width, source.currentRect.height);\n    const intersectionArea = calculateIntersectionArea(source.previousRect, source.currentRect);\n    return previousArea + currentArea - intersectionArea;\n};\n//# sourceMappingURL=getClsAttributionImpactedArea.js.map","import { round, ONE_SECOND, noop, elapsed } from '@datadog/browser-core';\nimport { isElementNode } from '../../../browser/htmlDomUtils';\nimport { supportPerformanceTimingEvent, RumPerformanceEntryType, createPerformanceObservable, } from '../../../browser/performanceObservable';\nimport { getSelectorFromElement } from '../../getSelectorFromElement';\nimport { getClsAttributionImpactedArea } from './getClsAttributionImpactedArea';\n/**\n * Track the cumulative layout shifts (CLS).\n * Layout shifts are grouped into session windows.\n * The minimum gap between session windows is 1 second.\n * The maximum duration of a session window is 5 second.\n * The session window layout shift value is the sum of layout shifts inside it.\n * The CLS value is the max of session windows values.\n *\n * This yields a new value whenever the CLS value is updated (a higher session window value is computed).\n *\n * See isLayoutShiftSupported to check for browser support.\n *\n * Documentation:\n * https://web.dev/cls/\n * https://web.dev/evolving-cls/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getCLS.ts\n */\nexport function trackCumulativeLayoutShift(configuration, viewStart, callback) {\n    if (!isLayoutShiftSupported()) {\n        return {\n            stop: noop,\n        };\n    }\n    let maxClsValue = 0;\n    let biggestShift;\n    // if no layout shift happen the value should be reported as 0\n    callback({\n        value: 0,\n    });\n    const slidingWindow = slidingSessionWindow();\n    const performanceSubscription = createPerformanceObservable(configuration, {\n        type: RumPerformanceEntryType.LAYOUT_SHIFT,\n        buffered: true,\n    }).subscribe((entries) => {\n        var _a;\n        for (const entry of entries) {\n            if (entry.hadRecentInput || entry.startTime < viewStart) {\n                continue;\n            }\n            const { cumulatedValue, isMaxValue } = slidingWindow.update(entry);\n            if (isMaxValue) {\n                const attribution = getTopImpactedElement(entry.sources);\n                biggestShift = {\n                    target: (attribution === null || attribution === void 0 ? void 0 : attribution.node) ? new WeakRef(attribution.node) : undefined,\n                    time: elapsed(viewStart, entry.startTime),\n                    previousRect: attribution === null || attribution === void 0 ? void 0 : attribution.previousRect,\n                    currentRect: attribution === null || attribution === void 0 ? void 0 : attribution.currentRect,\n                    devicePixelRatio: window.devicePixelRatio,\n                };\n            }\n            if (cumulatedValue > maxClsValue) {\n                maxClsValue = cumulatedValue;\n                const target = (_a = biggestShift === null || biggestShift === void 0 ? void 0 : biggestShift.target) === null || _a === void 0 ? void 0 : _a.deref();\n                callback({\n                    value: round(maxClsValue, 4),\n                    targetSelector: target && getSelectorFromElement(target, configuration.actionNameAttribute),\n                    time: biggestShift === null || biggestShift === void 0 ? void 0 : biggestShift.time,\n                    previousRect: (biggestShift === null || biggestShift === void 0 ? void 0 : biggestShift.previousRect) ? asRumRect(biggestShift.previousRect) : undefined,\n                    currentRect: (biggestShift === null || biggestShift === void 0 ? void 0 : biggestShift.currentRect) ? asRumRect(biggestShift.currentRect) : undefined,\n                    devicePixelRatio: biggestShift === null || biggestShift === void 0 ? void 0 : biggestShift.devicePixelRatio,\n                });\n            }\n        }\n    });\n    return {\n        stop: () => {\n            performanceSubscription.unsubscribe();\n        },\n    };\n}\nfunction getTopImpactedElement(sources) {\n    let topImpactedSource;\n    for (const source of sources) {\n        if (source.node && isElementNode(source.node)) {\n            const currentImpactedArea = getClsAttributionImpactedArea(source);\n            if (!topImpactedSource || getClsAttributionImpactedArea(topImpactedSource) < currentImpactedArea) {\n                topImpactedSource = source;\n            }\n        }\n    }\n    return topImpactedSource;\n}\nfunction asRumRect({ x, y, width, height }) {\n    return { x, y, width, height };\n}\nexport const MAX_WINDOW_DURATION = 5 * ONE_SECOND;\nconst MAX_UPDATE_GAP = ONE_SECOND;\nfunction slidingSessionWindow() {\n    let cumulatedValue = 0;\n    let startTime;\n    let endTime;\n    let maxValue = 0;\n    return {\n        update: (entry) => {\n            const shouldCreateNewWindow = startTime === undefined ||\n                entry.startTime - endTime >= MAX_UPDATE_GAP ||\n                entry.startTime - startTime >= MAX_WINDOW_DURATION;\n            let isMaxValue;\n            if (shouldCreateNewWindow) {\n                startTime = endTime = entry.startTime;\n                maxValue = cumulatedValue = entry.value;\n                isMaxValue = true;\n            }\n            else {\n                cumulatedValue += entry.value;\n                endTime = entry.startTime;\n                isMaxValue = entry.value > maxValue;\n                if (isMaxValue) {\n                    maxValue = entry.value;\n                }\n            }\n            return {\n                cumulatedValue,\n                isMaxValue,\n            };\n        },\n    };\n}\n/**\n * Check whether `layout-shift` is supported by the browser.\n */\nexport function isLayoutShiftSupported() {\n    return supportPerformanceTimingEvent(RumPerformanceEntryType.LAYOUT_SHIFT) && 'WeakRef' in window;\n}\n//# sourceMappingURL=trackCumulativeLayoutShift.js.map","/**\n * performance.interactionCount polyfill\n *\n * The interactionCount is an integer which counts the total number of distinct user interactions,\n * for which there was a unique interactionId.\n *\n * The interactionCount polyfill is an estimate based on a convention specific to Chrome. Cf: https://github.com/GoogleChrome/web-vitals/pull/213\n * This is currently not an issue as the polyfill is only used for INP which is currently only supported on Chrome.\n * Hopefully when/if other browsers will support INP, they will also implement performance.interactionCount at the same time, so we won't need that polyfill.\n *\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/main/src/lib/polyfills/interactionCountPolyfill.ts\n */\nimport { monitor } from '@datadog/browser-core';\nlet observer;\nlet interactionCountEstimate = 0;\nlet minKnownInteractionId = Infinity;\nlet maxKnownInteractionId = 0;\nexport function initInteractionCountPolyfill() {\n    if ('interactionCount' in performance || observer) {\n        return;\n    }\n    observer = new window.PerformanceObserver(monitor((entries) => {\n        entries.getEntries().forEach((e) => {\n            const entry = e;\n            if (entry.interactionId) {\n                minKnownInteractionId = Math.min(minKnownInteractionId, entry.interactionId);\n                maxKnownInteractionId = Math.max(maxKnownInteractionId, entry.interactionId);\n                interactionCountEstimate = (maxKnownInteractionId - minKnownInteractionId) / 7 + 1;\n            }\n        });\n    }));\n    observer.observe({ type: 'event', buffered: true, durationThreshold: 0 });\n}\n/**\n * Returns the `interactionCount` value using the native API (if available)\n * or the polyfill estimate in this module.\n */\nexport const getInteractionCount = () => observer ? interactionCountEstimate : window.performance.interactionCount || 0;\n//# sourceMappingURL=interactionCountPolyfill.js.map","import { elapsed, noop, ONE_MINUTE } from '@datadog/browser-core';\nimport { createPerformanceObservable, RumPerformanceEntryType, supportPerformanceTimingEvent, } from '../../../browser/performanceObservable';\nimport { ViewLoadingType } from '../../../rawRumEvent.types';\nimport { getSelectorFromElement } from '../../getSelectorFromElement';\nimport { isElementNode } from '../../../browser/htmlDomUtils';\nimport { getInteractionSelector } from '../../action/interactionSelectorCache';\nimport { getInteractionCount, initInteractionCountPolyfill } from './interactionCountPolyfill';\n// Arbitrary value to prevent unnecessary memory usage on views with lots of interactions.\nconst MAX_INTERACTION_ENTRIES = 10;\n// Arbitrary value to cap INP outliers\nexport const MAX_INP_VALUE = (1 * ONE_MINUTE);\n/**\n * Track the interaction to next paint (INP).\n * To avoid outliers, return the p98 worst interaction of the view.\n * Documentation: https://web.dev/inp/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/main/src/onINP.ts\n */\nexport function trackInteractionToNextPaint(configuration, viewStart, viewLoadingType) {\n    if (!isInteractionToNextPaintSupported()) {\n        return {\n            getInteractionToNextPaint: () => undefined,\n            setViewEnd: noop,\n            stop: noop,\n        };\n    }\n    const { getViewInteractionCount, stopViewInteractionCount } = trackViewInteractionCount(viewLoadingType);\n    let viewEnd = Infinity;\n    const longestInteractions = trackLongestInteractions(getViewInteractionCount);\n    let interactionToNextPaint = -1;\n    let interactionToNextPaintTargetSelector;\n    let interactionToNextPaintStartTime;\n    function handleEntries(entries) {\n        for (const entry of entries) {\n            if (entry.interactionId &&\n                // Check the entry start time is inside the view bounds because some view interactions can be reported after the view end (if long duration).\n                entry.startTime >= viewStart &&\n                entry.startTime <= viewEnd) {\n                longestInteractions.process(entry);\n            }\n        }\n        const newInteraction = longestInteractions.estimateP98Interaction();\n        if (newInteraction && newInteraction.duration !== interactionToNextPaint) {\n            interactionToNextPaint = newInteraction.duration;\n            interactionToNextPaintStartTime = elapsed(viewStart, newInteraction.startTime);\n            interactionToNextPaintTargetSelector = getInteractionSelector(newInteraction.startTime);\n            if (!interactionToNextPaintTargetSelector && newInteraction.target && isElementNode(newInteraction.target)) {\n                interactionToNextPaintTargetSelector = getSelectorFromElement(newInteraction.target, configuration.actionNameAttribute);\n            }\n        }\n    }\n    const firstInputSubscription = createPerformanceObservable(configuration, {\n        type: RumPerformanceEntryType.FIRST_INPUT,\n        buffered: true,\n    }).subscribe(handleEntries);\n    const eventSubscription = createPerformanceObservable(configuration, {\n        type: RumPerformanceEntryType.EVENT,\n        // durationThreshold only impact PerformanceEventTiming entries used for INP computation which requires a threshold at 40 (default is 104ms)\n        // cf: https://github.com/GoogleChrome/web-vitals/blob/3806160ffbc93c3c4abf210a167b81228172b31c/src/onINP.ts#L202-L210\n        durationThreshold: 40,\n        buffered: true,\n    }).subscribe(handleEntries);\n    return {\n        getInteractionToNextPaint: () => {\n            // If no INP duration where captured because of the performanceObserver 40ms threshold\n            // but the view interaction count > 0 then report 0\n            if (interactionToNextPaint >= 0) {\n                return {\n                    value: Math.min(interactionToNextPaint, MAX_INP_VALUE),\n                    targetSelector: interactionToNextPaintTargetSelector,\n                    time: interactionToNextPaintStartTime,\n                };\n            }\n            else if (getViewInteractionCount()) {\n                return {\n                    value: 0,\n                };\n            }\n        },\n        setViewEnd: (viewEndTime) => {\n            viewEnd = viewEndTime;\n            stopViewInteractionCount();\n        },\n        stop: () => {\n            eventSubscription.unsubscribe();\n            firstInputSubscription.unsubscribe();\n        },\n    };\n}\nfunction trackLongestInteractions(getViewInteractionCount) {\n    const longestInteractions = [];\n    function sortAndTrimLongestInteractions() {\n        longestInteractions.sort((a, b) => b.duration - a.duration).splice(MAX_INTERACTION_ENTRIES);\n    }\n    return {\n        /**\n         * Process the performance entry:\n         * - if its duration is long enough, add the performance entry to the list of worst interactions\n         * - if an entry with the same interaction id exists and its duration is lower than the new one, then replace it in the list of worst interactions\n         */\n        process(entry) {\n            const interactionIndex = longestInteractions.findIndex((interaction) => entry.interactionId === interaction.interactionId);\n            const minLongestInteraction = longestInteractions[longestInteractions.length - 1];\n            if (interactionIndex !== -1) {\n                if (entry.duration > longestInteractions[interactionIndex].duration) {\n                    longestInteractions[interactionIndex] = entry;\n                    sortAndTrimLongestInteractions();\n                }\n            }\n            else if (longestInteractions.length < MAX_INTERACTION_ENTRIES ||\n                entry.duration > minLongestInteraction.duration) {\n                longestInteractions.push(entry);\n                sortAndTrimLongestInteractions();\n            }\n        },\n        /**\n         * Compute the p98 longest interaction.\n         * For better performance the computation is based on 10 longest interactions and the interaction count of the current view.\n         */\n        estimateP98Interaction() {\n            const interactionIndex = Math.min(longestInteractions.length - 1, Math.floor(getViewInteractionCount() / 50));\n            return longestInteractions[interactionIndex];\n        },\n    };\n}\nexport function trackViewInteractionCount(viewLoadingType) {\n    initInteractionCountPolyfill();\n    const previousInteractionCount = viewLoadingType === ViewLoadingType.INITIAL_LOAD ? 0 : getInteractionCount();\n    let state = { stopped: false };\n    function computeViewInteractionCount() {\n        return getInteractionCount() - previousInteractionCount;\n    }\n    return {\n        getViewInteractionCount: () => {\n            if (state.stopped) {\n                return state.interactionCount;\n            }\n            return computeViewInteractionCount();\n        },\n        stopViewInteractionCount: () => {\n            state = { stopped: true, interactionCount: computeViewInteractionCount() };\n        },\n    };\n}\nexport function isInteractionToNextPaintSupported() {\n    return (supportPerformanceTimingEvent(RumPerformanceEntryType.EVENT) &&\n        window.PerformanceEventTiming &&\n        'interactionId' in PerformanceEventTiming.prototype);\n}\n//# sourceMappingURL=trackInteractionToNextPaint.js.map","import { elapsed } from '@datadog/browser-core';\nimport { waitPageActivityEnd } from '../../waitPageActivityEnd';\nimport { ViewLoadingType } from '../../../rawRumEvent.types';\nimport { trackFirstHidden } from './trackFirstHidden';\n/**\n * For non-initial views (such as route changes or BFCache restores), the regular load event does not fire\n * In these cases, trackLoadingTime can only emit a loadingTime  if waitPageActivityEnd detects some post-restore activity.\n * If nothing happens after the view starts,no candidate is recorded and loadingTime stays undefined.\n */\nexport function trackLoadingTime(lifeCycle, domMutationObservable, windowOpenObservable, configuration, loadType, viewStart, callback) {\n    let isWaitingForLoadEvent = loadType === ViewLoadingType.INITIAL_LOAD;\n    let isWaitingForActivityLoadingTime = true;\n    const loadingTimeCandidates = [];\n    const firstHidden = trackFirstHidden(configuration, viewStart);\n    function invokeCallbackIfAllCandidatesAreReceived() {\n        if (!isWaitingForActivityLoadingTime && !isWaitingForLoadEvent && loadingTimeCandidates.length > 0) {\n            const loadingTime = Math.max(...loadingTimeCandidates);\n            // firstHidden is a relative time from time origin, so we use the relative start time of the view to compare with the loading time\n            if (loadingTime < firstHidden.timeStamp - viewStart.relative) {\n                callback(loadingTime);\n            }\n        }\n    }\n    const { stop } = waitPageActivityEnd(lifeCycle, domMutationObservable, windowOpenObservable, configuration, (event) => {\n        if (isWaitingForActivityLoadingTime) {\n            isWaitingForActivityLoadingTime = false;\n            if (event.hadActivity) {\n                loadingTimeCandidates.push(elapsed(viewStart.timeStamp, event.end));\n            }\n            invokeCallbackIfAllCandidatesAreReceived();\n        }\n    });\n    return {\n        stop: () => {\n            stop();\n            firstHidden.stop();\n        },\n        setLoadEvent: (loadEvent) => {\n            if (isWaitingForLoadEvent) {\n                isWaitingForLoadEvent = false;\n                loadingTimeCandidates.push(loadEvent);\n                invokeCallbackIfAllCandidatesAreReceived();\n            }\n        },\n    };\n}\n//# sourceMappingURL=trackLoadingTime.js.map","export function getScrollX() {\n    let scrollX;\n    const visual = window.visualViewport;\n    if (visual) {\n        scrollX = visual.pageLeft - visual.offsetLeft;\n    }\n    else if (window.scrollX !== undefined) {\n        scrollX = window.scrollX;\n    }\n    else {\n        scrollX = window.pageXOffset || 0;\n    }\n    return Math.round(scrollX);\n}\nexport function getScrollY() {\n    let scrollY;\n    const visual = window.visualViewport;\n    if (visual) {\n        scrollY = visual.pageTop - visual.offsetTop;\n    }\n    else if (window.scrollY !== undefined) {\n        scrollY = window.scrollY;\n    }\n    else {\n        scrollY = window.pageYOffset || 0;\n    }\n    return Math.round(scrollY);\n}\n//# sourceMappingURL=scroll.js.map","import { Observable, throttle, addEventListener } from '@datadog/browser-core';\nlet viewportObservable;\nexport function initViewportObservable(configuration) {\n    if (!viewportObservable) {\n        viewportObservable = createViewportObservable(configuration);\n    }\n    return viewportObservable;\n}\nexport function createViewportObservable(configuration) {\n    return new Observable((observable) => {\n        const { throttled: updateDimension } = throttle(() => {\n            observable.notify(getViewportDimension());\n        }, 200);\n        return addEventListener(configuration, window, \"resize\" /* DOM_EVENT.RESIZE */, updateDimension, { capture: true, passive: true })\n            .stop;\n    });\n}\n// excludes the width and height of any rendered classic scrollbar that is fixed to the visual viewport\nexport function getViewportDimension() {\n    const visual = window.visualViewport;\n    if (visual) {\n        return {\n            width: Number(visual.width * visual.scale),\n            height: Number(visual.height * visual.scale),\n        };\n    }\n    return {\n        width: Number(window.innerWidth || 0),\n        height: Number(window.innerHeight || 0),\n    };\n}\n//# sourceMappingURL=viewportObservable.js.map","import { Observable, ONE_SECOND, elapsed, relativeNow, throttle, addEventListener, monitor, } from '@datadog/browser-core';\nimport { getScrollY } from '../../../browser/scroll';\nimport { getViewportDimension } from '../../../browser/viewportObservable';\n/** Arbitrary scroll throttle duration */\nexport const THROTTLE_SCROLL_DURATION = ONE_SECOND;\nexport function trackScrollMetrics(configuration, viewStart, callback, scrollValues = createScrollValuesObservable(configuration)) {\n    let maxScrollDepth = 0;\n    let maxScrollHeight = 0;\n    let maxScrollHeightTime = 0;\n    const subscription = scrollValues.subscribe(({ scrollDepth, scrollTop, scrollHeight }) => {\n        let shouldUpdate = false;\n        if (scrollDepth > maxScrollDepth) {\n            maxScrollDepth = scrollDepth;\n            shouldUpdate = true;\n        }\n        if (scrollHeight > maxScrollHeight) {\n            maxScrollHeight = scrollHeight;\n            const now = relativeNow();\n            maxScrollHeightTime = elapsed(viewStart.relative, now);\n            shouldUpdate = true;\n        }\n        if (shouldUpdate) {\n            callback({\n                maxDepth: Math.min(maxScrollDepth, maxScrollHeight),\n                maxDepthScrollTop: scrollTop,\n                maxScrollHeight,\n                maxScrollHeightTime,\n            });\n        }\n    });\n    return {\n        stop: () => subscription.unsubscribe(),\n    };\n}\nexport function computeScrollValues() {\n    const scrollTop = getScrollY();\n    const { height } = getViewportDimension();\n    const scrollHeight = Math.round((document.scrollingElement || document.documentElement).scrollHeight);\n    const scrollDepth = Math.round(height + scrollTop);\n    return {\n        scrollHeight,\n        scrollDepth,\n        scrollTop,\n    };\n}\nexport function createScrollValuesObservable(configuration, throttleDuration = THROTTLE_SCROLL_DURATION) {\n    return new Observable((observable) => {\n        function notify() {\n            observable.notify(computeScrollValues());\n        }\n        if (window.ResizeObserver) {\n            const throttledNotify = throttle(notify, throttleDuration, {\n                leading: false,\n                trailing: true,\n            });\n            const observerTarget = document.scrollingElement || document.documentElement;\n            const resizeObserver = new ResizeObserver(monitor(throttledNotify.throttled));\n            if (observerTarget) {\n                resizeObserver.observe(observerTarget);\n            }\n            const eventListener = addEventListener(configuration, window, \"scroll\" /* DOM_EVENT.SCROLL */, throttledNotify.throttled, {\n                passive: true,\n            });\n            return () => {\n                throttledNotify.cancel();\n                resizeObserver.disconnect();\n                eventListener.stop();\n            };\n        }\n    });\n}\n//# sourceMappingURL=trackScrollMetrics.js.map","import { trackCumulativeLayoutShift } from './trackCumulativeLayoutShift';\nimport { trackInteractionToNextPaint } from './trackInteractionToNextPaint';\nimport { trackLoadingTime } from './trackLoadingTime';\nimport { trackScrollMetrics } from './trackScrollMetrics';\nexport function trackCommonViewMetrics(lifeCycle, domMutationObservable, windowOpenObservable, configuration, scheduleViewUpdate, loadingType, viewStart) {\n    const commonViewMetrics = {};\n    const { stop: stopLoadingTimeTracking, setLoadEvent } = trackLoadingTime(lifeCycle, domMutationObservable, windowOpenObservable, configuration, loadingType, viewStart, (newLoadingTime) => {\n        commonViewMetrics.loadingTime = newLoadingTime;\n        scheduleViewUpdate();\n    });\n    const { stop: stopScrollMetricsTracking } = trackScrollMetrics(configuration, viewStart, (newScrollMetrics) => {\n        commonViewMetrics.scroll = newScrollMetrics;\n    });\n    const { stop: stopCLSTracking } = trackCumulativeLayoutShift(configuration, viewStart.relative, (cumulativeLayoutShift) => {\n        commonViewMetrics.cumulativeLayoutShift = cumulativeLayoutShift;\n        scheduleViewUpdate();\n    });\n    const { stop: stopINPTracking, getInteractionToNextPaint, setViewEnd, } = trackInteractionToNextPaint(configuration, viewStart.relative, loadingType);\n    return {\n        stop: () => {\n            stopLoadingTimeTracking();\n            stopCLSTracking();\n            stopScrollMetricsTracking();\n        },\n        stopINPTracking,\n        setLoadEvent,\n        setViewEnd,\n        getCommonViewMetrics: () => {\n            commonViewMetrics.interactionToNextPaint = getInteractionToNextPaint();\n            return commonViewMetrics;\n        },\n    };\n}\n//# sourceMappingURL=trackCommonViewMetrics.js.map","import { addEventListener } from '@datadog/browser-core';\nexport function onBFCacheRestore(configuration, callback) {\n    const { stop } = addEventListener(configuration, window, \"pageshow\" /* DOM_EVENT.PAGE_SHOW */, (event) => {\n        if (event.persisted) {\n            callback(event);\n        }\n    }, { capture: true });\n    return stop;\n}\n//# sourceMappingURL=bfCacheSupport.js.map","import { trackRestoredFirstContentfulPaint } from './trackFirstContentfulPaint';\n/**\n * BFCache keeps a full in-memory snapshot of the DOM. When the page is restored, nothing needs to be fetched, so the whole\n * viewport repaints in a single frame. Consequently, LCP almost always equals FCP.\n * (See: https://github.com/GoogleChrome/web-vitals/pull/87)\n */\nexport function trackBfcacheMetrics(viewStart, metrics, scheduleViewUpdate) {\n    trackRestoredFirstContentfulPaint(viewStart.relative, (paintTime) => {\n        metrics.firstContentfulPaint = paintTime;\n        metrics.largestContentfulPaint = { value: paintTime };\n        scheduleViewUpdate();\n    });\n}\n//# sourceMappingURL=trackBfcacheMetrics.js.map","import { noop, PageExitReason, shallowClone, elapsed, generateUUID, ONE_MINUTE, throttle, clocksNow, clocksOrigin, relativeToClocks, timeStampNow, display, looksLikeRelativeTime, setInterval, clearInterval, setTimeout, Observable, createContextManager, } from '@datadog/browser-core';\nimport { ViewLoadingType } from '../../rawRumEvent.types';\nimport { trackViewEventCounts } from './trackViewEventCounts';\nimport { trackInitialViewMetrics } from './viewMetrics/trackInitialViewMetrics';\nimport { trackCommonViewMetrics } from './viewMetrics/trackCommonViewMetrics';\nimport { onBFCacheRestore } from './bfCacheSupport';\nimport { trackBfcacheMetrics } from './viewMetrics/trackBfcacheMetrics';\nexport const THROTTLE_VIEW_UPDATE_PERIOD = 3000;\nexport const SESSION_KEEP_ALIVE_INTERVAL = 5 * ONE_MINUTE;\n// Some events or metrics can be captured after the end of the view. To avoid missing those;\n// an arbitrary delay is added for stopping their tracking after the view ends.\n//\n// Ideally, we would not stop and keep tracking events or metrics until the end of the session.\n// But this might have a small performance impact if there are many many views.\n// So let's have a fairly short delay improving the situation in most cases and avoid impacting performances too much.\nexport const KEEP_TRACKING_AFTER_VIEW_DELAY = 5 * ONE_MINUTE;\nexport function trackViews(location, lifeCycle, domMutationObservable, windowOpenObservable, configuration, locationChangeObservable, areViewsTrackedAutomatically, initialViewOptions) {\n    const activeViews = new Set();\n    let currentView = startNewView(ViewLoadingType.INITIAL_LOAD, clocksOrigin(), initialViewOptions);\n    let stopOnBFCacheRestore;\n    startViewLifeCycle();\n    let locationChangeSubscription;\n    if (areViewsTrackedAutomatically) {\n        locationChangeSubscription = renewViewOnLocationChange(locationChangeObservable);\n        if (configuration.trackBfcacheViews) {\n            stopOnBFCacheRestore = onBFCacheRestore(configuration, (pageshowEvent) => {\n                currentView.end();\n                const startClocks = relativeToClocks(pageshowEvent.timeStamp);\n                currentView = startNewView(ViewLoadingType.BF_CACHE, startClocks, undefined);\n            });\n        }\n    }\n    function startNewView(loadingType, startClocks, viewOptions) {\n        const newlyCreatedView = newView(lifeCycle, domMutationObservable, windowOpenObservable, configuration, location, loadingType, startClocks, viewOptions);\n        activeViews.add(newlyCreatedView);\n        newlyCreatedView.stopObservable.subscribe(() => {\n            activeViews.delete(newlyCreatedView);\n        });\n        return newlyCreatedView;\n    }\n    function startViewLifeCycle() {\n        lifeCycle.subscribe(10 /* LifeCycleEventType.SESSION_RENEWED */, () => {\n            // Renew view on session renewal\n            currentView = startNewView(ViewLoadingType.ROUTE_CHANGE, undefined, {\n                name: currentView.name,\n                service: currentView.service,\n                version: currentView.version,\n                context: currentView.contextManager.getContext(),\n            });\n        });\n        lifeCycle.subscribe(9 /* LifeCycleEventType.SESSION_EXPIRED */, () => {\n            currentView.end({ sessionIsActive: false });\n        });\n    }\n    function renewViewOnLocationChange(locationChangeObservable) {\n        return locationChangeObservable.subscribe(({ oldLocation, newLocation }) => {\n            if (areDifferentLocation(oldLocation, newLocation)) {\n                currentView.end();\n                currentView = startNewView(ViewLoadingType.ROUTE_CHANGE);\n            }\n        });\n    }\n    return {\n        addTiming: (name, time = timeStampNow()) => {\n            currentView.addTiming(name, time);\n        },\n        startView: (options, startClocks) => {\n            currentView.end({ endClocks: startClocks });\n            currentView = startNewView(ViewLoadingType.ROUTE_CHANGE, startClocks, options);\n        },\n        setViewContext: (context) => {\n            currentView.contextManager.setContext(context);\n        },\n        setViewContextProperty: (key, value) => {\n            currentView.contextManager.setContextProperty(key, value);\n        },\n        setViewName: (name) => {\n            currentView.setViewName(name);\n        },\n        getViewContext: () => currentView.contextManager.getContext(),\n        stop: () => {\n            if (locationChangeSubscription) {\n                locationChangeSubscription.unsubscribe();\n            }\n            if (stopOnBFCacheRestore) {\n                stopOnBFCacheRestore();\n            }\n            currentView.end();\n            activeViews.forEach((view) => view.stop());\n        },\n    };\n}\nfunction newView(lifeCycle, domMutationObservable, windowOpenObservable, configuration, initialLocation, loadingType, startClocks = clocksNow(), viewOptions) {\n    // Setup initial values\n    const id = generateUUID();\n    const stopObservable = new Observable();\n    const customTimings = {};\n    let documentVersion = 0;\n    let endClocks;\n    const location = shallowClone(initialLocation);\n    const contextManager = createContextManager();\n    let sessionIsActive = true;\n    let name = viewOptions === null || viewOptions === void 0 ? void 0 : viewOptions.name;\n    const service = (viewOptions === null || viewOptions === void 0 ? void 0 : viewOptions.service) || configuration.service;\n    const version = (viewOptions === null || viewOptions === void 0 ? void 0 : viewOptions.version) || configuration.version;\n    const context = viewOptions === null || viewOptions === void 0 ? void 0 : viewOptions.context;\n    if (context) {\n        contextManager.setContext(context);\n    }\n    const viewCreatedEvent = {\n        id,\n        name,\n        startClocks,\n        service,\n        version,\n        context,\n    };\n    lifeCycle.notify(1 /* LifeCycleEventType.BEFORE_VIEW_CREATED */, viewCreatedEvent);\n    lifeCycle.notify(2 /* LifeCycleEventType.VIEW_CREATED */, viewCreatedEvent);\n    // Update the view every time the measures are changing\n    const { throttled, cancel: cancelScheduleViewUpdate } = throttle(triggerViewUpdate, THROTTLE_VIEW_UPDATE_PERIOD, {\n        leading: false,\n    });\n    const { setLoadEvent, setViewEnd, stop: stopCommonViewMetricsTracking, stopINPTracking, getCommonViewMetrics, } = trackCommonViewMetrics(lifeCycle, domMutationObservable, windowOpenObservable, configuration, scheduleViewUpdate, loadingType, startClocks);\n    const { stop: stopInitialViewMetricsTracking, initialViewMetrics } = loadingType === ViewLoadingType.INITIAL_LOAD\n        ? trackInitialViewMetrics(configuration, startClocks, setLoadEvent, scheduleViewUpdate)\n        : { stop: noop, initialViewMetrics: {} };\n    // Start BFCache-specific metrics when restoring from BFCache\n    if (loadingType === ViewLoadingType.BF_CACHE) {\n        trackBfcacheMetrics(startClocks, initialViewMetrics, scheduleViewUpdate);\n    }\n    const { stop: stopEventCountsTracking, eventCounts } = trackViewEventCounts(lifeCycle, id, scheduleViewUpdate);\n    // Session keep alive\n    const keepAliveIntervalId = setInterval(triggerViewUpdate, SESSION_KEEP_ALIVE_INTERVAL);\n    const pageMayExitSubscription = lifeCycle.subscribe(11 /* LifeCycleEventType.PAGE_MAY_EXIT */, (pageMayExitEvent) => {\n        if (pageMayExitEvent.reason === PageExitReason.UNLOADING) {\n            triggerViewUpdate();\n        }\n    });\n    // Initial view update\n    triggerViewUpdate();\n    // View context update should always be throttled\n    contextManager.changeObservable.subscribe(scheduleViewUpdate);\n    function triggerBeforeViewUpdate() {\n        lifeCycle.notify(3 /* LifeCycleEventType.BEFORE_VIEW_UPDATED */, {\n            id,\n            name,\n            context: contextManager.getContext(),\n            startClocks,\n            sessionIsActive,\n        });\n    }\n    function scheduleViewUpdate() {\n        triggerBeforeViewUpdate();\n        throttled();\n    }\n    function triggerViewUpdate() {\n        cancelScheduleViewUpdate();\n        triggerBeforeViewUpdate();\n        documentVersion += 1;\n        const currentEnd = endClocks === undefined ? timeStampNow() : endClocks.timeStamp;\n        lifeCycle.notify(4 /* LifeCycleEventType.VIEW_UPDATED */, {\n            customTimings,\n            documentVersion,\n            id,\n            name,\n            service,\n            version,\n            context: contextManager.getContext(),\n            loadingType,\n            location,\n            startClocks,\n            commonViewMetrics: getCommonViewMetrics(),\n            initialViewMetrics,\n            duration: elapsed(startClocks.timeStamp, currentEnd),\n            isActive: endClocks === undefined,\n            sessionIsActive,\n            eventCounts,\n        });\n    }\n    return {\n        get name() {\n            return name;\n        },\n        service,\n        version,\n        contextManager,\n        stopObservable,\n        end(options = {}) {\n            var _a, _b;\n            if (endClocks) {\n                // view already ended\n                return;\n            }\n            endClocks = (_a = options.endClocks) !== null && _a !== void 0 ? _a : clocksNow();\n            sessionIsActive = (_b = options.sessionIsActive) !== null && _b !== void 0 ? _b : true;\n            lifeCycle.notify(5 /* LifeCycleEventType.VIEW_ENDED */, { endClocks });\n            lifeCycle.notify(6 /* LifeCycleEventType.AFTER_VIEW_ENDED */, { endClocks });\n            clearInterval(keepAliveIntervalId);\n            setViewEnd(endClocks.relative);\n            stopCommonViewMetricsTracking();\n            pageMayExitSubscription.unsubscribe();\n            triggerViewUpdate();\n            setTimeout(() => {\n                this.stop();\n            }, KEEP_TRACKING_AFTER_VIEW_DELAY);\n        },\n        stop() {\n            stopInitialViewMetricsTracking();\n            stopEventCountsTracking();\n            stopINPTracking();\n            stopObservable.notify();\n        },\n        addTiming(name, time) {\n            if (endClocks) {\n                return;\n            }\n            const relativeTime = looksLikeRelativeTime(time) ? time : elapsed(startClocks.timeStamp, time);\n            customTimings[sanitizeTiming(name)] = relativeTime;\n            scheduleViewUpdate();\n        },\n        setViewName(updatedName) {\n            name = updatedName;\n            triggerViewUpdate();\n        },\n    };\n}\n/**\n * Timing name is used as facet path that must contain only letters, digits, or the characters - _ . @ $\n */\nfunction sanitizeTiming(name) {\n    const sanitized = name.replace(/[^a-zA-Z0-9-_.@$]/g, '_');\n    if (sanitized !== name) {\n        display.warn(`Invalid timing name: ${name}, sanitized to: ${sanitized}`);\n    }\n    return sanitized;\n}\nfunction areDifferentLocation(currentLocation, otherLocation) {\n    return (currentLocation.pathname !== otherLocation.pathname ||\n        (!isHashAnAnchor(otherLocation.hash) &&\n            getPathFromHash(otherLocation.hash) !== getPathFromHash(currentLocation.hash)));\n}\nfunction isHashAnAnchor(hash) {\n    const correspondingId = hash.substring(1);\n    // check if the correspondingId is empty because on Firefox an empty string passed to getElementById() prints a consol warning\n    return correspondingId !== '' && !!document.getElementById(correspondingId);\n}\nfunction getPathFromHash(hash) {\n    const index = hash.indexOf('?');\n    return index < 0 ? hash : hash.slice(0, index);\n}\n//# sourceMappingURL=trackViews.js.map","import { getTimeZone, DISCARDED, isEmptyObject, mapValues, toServerDuration } from '@datadog/browser-core';\nimport { discardNegativeDuration } from '../discardNegativeDuration';\nimport { RumEventType } from '../../rawRumEvent.types';\nimport { trackViews } from './trackViews';\nexport function startViewCollection(lifeCycle, hooks, configuration, location, domMutationObservable, pageOpenObservable, locationChangeObservable, recorderApi, viewHistory, initialViewOptions) {\n    lifeCycle.subscribe(4 /* LifeCycleEventType.VIEW_UPDATED */, (view) => lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, processViewUpdate(view, configuration, recorderApi)));\n    hooks.register(0 /* HookNames.Assemble */, ({ startTime, eventType }) => {\n        const view = viewHistory.findView(startTime);\n        if (!view) {\n            return DISCARDED;\n        }\n        return {\n            type: eventType,\n            service: view.service,\n            version: view.version,\n            context: view.context,\n            view: {\n                id: view.id,\n                name: view.name,\n            },\n        };\n    });\n    hooks.register(1 /* HookNames.AssembleTelemetry */, ({ startTime }) => {\n        var _a;\n        return ({\n            view: {\n                id: (_a = viewHistory.findView(startTime)) === null || _a === void 0 ? void 0 : _a.id,\n            },\n        });\n    });\n    return trackViews(location, lifeCycle, domMutationObservable, pageOpenObservable, configuration, locationChangeObservable, !configuration.trackViewsManually, initialViewOptions);\n}\nfunction processViewUpdate(view, configuration, recorderApi) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t;\n    const replayStats = recorderApi.getReplayStats(view.id);\n    const clsDevicePixelRatio = (_b = (_a = view.commonViewMetrics) === null || _a === void 0 ? void 0 : _a.cumulativeLayoutShift) === null || _b === void 0 ? void 0 : _b.devicePixelRatio;\n    const viewEvent = {\n        _dd: {\n            document_version: view.documentVersion,\n            replay_stats: replayStats,\n            cls: clsDevicePixelRatio\n                ? {\n                    device_pixel_ratio: clsDevicePixelRatio,\n                }\n                : undefined,\n            configuration: {\n                start_session_replay_recording_manually: configuration.startSessionReplayRecordingManually,\n            },\n        },\n        date: view.startClocks.timeStamp,\n        type: RumEventType.VIEW,\n        view: {\n            action: {\n                count: view.eventCounts.actionCount,\n            },\n            frustration: {\n                count: view.eventCounts.frustrationCount,\n            },\n            cumulative_layout_shift: (_c = view.commonViewMetrics.cumulativeLayoutShift) === null || _c === void 0 ? void 0 : _c.value,\n            cumulative_layout_shift_time: toServerDuration((_d = view.commonViewMetrics.cumulativeLayoutShift) === null || _d === void 0 ? void 0 : _d.time),\n            cumulative_layout_shift_target_selector: (_e = view.commonViewMetrics.cumulativeLayoutShift) === null || _e === void 0 ? void 0 : _e.targetSelector,\n            first_byte: toServerDuration((_f = view.initialViewMetrics.navigationTimings) === null || _f === void 0 ? void 0 : _f.firstByte),\n            dom_complete: toServerDuration((_g = view.initialViewMetrics.navigationTimings) === null || _g === void 0 ? void 0 : _g.domComplete),\n            dom_content_loaded: toServerDuration((_h = view.initialViewMetrics.navigationTimings) === null || _h === void 0 ? void 0 : _h.domContentLoaded),\n            dom_interactive: toServerDuration((_j = view.initialViewMetrics.navigationTimings) === null || _j === void 0 ? void 0 : _j.domInteractive),\n            error: {\n                count: view.eventCounts.errorCount,\n            },\n            first_contentful_paint: toServerDuration(view.initialViewMetrics.firstContentfulPaint),\n            first_input_delay: toServerDuration((_k = view.initialViewMetrics.firstInput) === null || _k === void 0 ? void 0 : _k.delay),\n            first_input_time: toServerDuration((_l = view.initialViewMetrics.firstInput) === null || _l === void 0 ? void 0 : _l.time),\n            first_input_target_selector: (_m = view.initialViewMetrics.firstInput) === null || _m === void 0 ? void 0 : _m.targetSelector,\n            interaction_to_next_paint: toServerDuration((_o = view.commonViewMetrics.interactionToNextPaint) === null || _o === void 0 ? void 0 : _o.value),\n            interaction_to_next_paint_time: toServerDuration((_p = view.commonViewMetrics.interactionToNextPaint) === null || _p === void 0 ? void 0 : _p.time),\n            interaction_to_next_paint_target_selector: (_q = view.commonViewMetrics.interactionToNextPaint) === null || _q === void 0 ? void 0 : _q.targetSelector,\n            is_active: view.isActive,\n            name: view.name,\n            largest_contentful_paint: toServerDuration((_r = view.initialViewMetrics.largestContentfulPaint) === null || _r === void 0 ? void 0 : _r.value),\n            largest_contentful_paint_target_selector: (_s = view.initialViewMetrics.largestContentfulPaint) === null || _s === void 0 ? void 0 : _s.targetSelector,\n            load_event: toServerDuration((_t = view.initialViewMetrics.navigationTimings) === null || _t === void 0 ? void 0 : _t.loadEvent),\n            loading_time: discardNegativeDuration(toServerDuration(view.commonViewMetrics.loadingTime)),\n            loading_type: view.loadingType,\n            long_task: {\n                count: view.eventCounts.longTaskCount,\n            },\n            performance: computeViewPerformanceData(view.commonViewMetrics, view.initialViewMetrics),\n            resource: {\n                count: view.eventCounts.resourceCount,\n            },\n            time_spent: toServerDuration(view.duration),\n        },\n        display: view.commonViewMetrics.scroll\n            ? {\n                scroll: {\n                    max_depth: view.commonViewMetrics.scroll.maxDepth,\n                    max_depth_scroll_top: view.commonViewMetrics.scroll.maxDepthScrollTop,\n                    max_scroll_height: view.commonViewMetrics.scroll.maxScrollHeight,\n                    max_scroll_height_time: toServerDuration(view.commonViewMetrics.scroll.maxScrollHeightTime),\n                },\n            }\n            : undefined,\n        privacy: {\n            replay_level: configuration.defaultPrivacyLevel,\n        },\n        device: {\n            locale: navigator.language,\n            locales: navigator.languages,\n            time_zone: getTimeZone(),\n        },\n    };\n    if (!isEmptyObject(view.customTimings)) {\n        viewEvent.view.custom_timings = mapValues(view.customTimings, toServerDuration);\n    }\n    return {\n        rawRumEvent: viewEvent,\n        startTime: view.startClocks.relative,\n        duration: view.duration,\n        domainContext: {\n            location: view.location,\n        },\n    };\n}\nfunction computeViewPerformanceData({ cumulativeLayoutShift, interactionToNextPaint }, { firstContentfulPaint, firstInput, largestContentfulPaint }) {\n    return {\n        cls: cumulativeLayoutShift && {\n            score: cumulativeLayoutShift.value,\n            timestamp: toServerDuration(cumulativeLayoutShift.time),\n            target_selector: cumulativeLayoutShift.targetSelector,\n            previous_rect: cumulativeLayoutShift.previousRect,\n            current_rect: cumulativeLayoutShift.currentRect,\n        },\n        fcp: firstContentfulPaint && { timestamp: toServerDuration(firstContentfulPaint) },\n        fid: firstInput && {\n            duration: toServerDuration(firstInput.delay),\n            timestamp: toServerDuration(firstInput.time),\n            target_selector: firstInput.targetSelector,\n        },\n        inp: interactionToNextPaint && {\n            duration: toServerDuration(interactionToNextPaint.value),\n            timestamp: toServerDuration(interactionToNextPaint.time),\n            target_selector: interactionToNextPaint.targetSelector,\n        },\n        lcp: largestContentfulPaint && {\n            timestamp: toServerDuration(largestContentfulPaint.value),\n            target_selector: largestContentfulPaint.targetSelector,\n            resource_url: largestContentfulPaint.resourceUrl,\n        },\n    };\n}\n//# sourceMappingURL=viewCollection.js.map","import { Observable, SESSION_NOT_TRACKED, bridgeSupports, noop, performDraw, startSessionManager, } from '@datadog/browser-core';\nexport const RUM_SESSION_KEY = 'rum';\nexport function startRumSessionManager(configuration, lifeCycle, trackingConsentState) {\n    const sessionManager = startSessionManager(configuration, RUM_SESSION_KEY, (rawTrackingType) => computeTrackingType(configuration, rawTrackingType), trackingConsentState);\n    sessionManager.expireObservable.subscribe(() => {\n        lifeCycle.notify(9 /* LifeCycleEventType.SESSION_EXPIRED */);\n    });\n    sessionManager.renewObservable.subscribe(() => {\n        lifeCycle.notify(10 /* LifeCycleEventType.SESSION_RENEWED */);\n    });\n    sessionManager.sessionStateUpdateObservable.subscribe(({ previousState, newState }) => {\n        if (!previousState.forcedReplay && newState.forcedReplay) {\n            const sessionEntity = sessionManager.findSession();\n            if (sessionEntity) {\n                sessionEntity.isReplayForced = true;\n            }\n        }\n    });\n    return {\n        findTrackedSession: (startTime) => {\n            const session = sessionManager.findSession(startTime);\n            if (!session || session.trackingType === \"0\" /* RumTrackingType.NOT_TRACKED */) {\n                return;\n            }\n            return {\n                id: session.id,\n                sessionReplay: session.trackingType === \"1\" /* RumTrackingType.TRACKED_WITH_SESSION_REPLAY */\n                    ? 1 /* SessionReplayState.SAMPLED */\n                    : session.isReplayForced\n                        ? 2 /* SessionReplayState.FORCED */\n                        : 0 /* SessionReplayState.OFF */,\n                anonymousId: session.anonymousId,\n            };\n        },\n        expire: sessionManager.expire,\n        expireObservable: sessionManager.expireObservable,\n        setForcedReplay: () => sessionManager.updateSessionState({ forcedReplay: '1' }),\n    };\n}\n/**\n * Start a tracked replay session stub\n */\nexport function startRumSessionManagerStub() {\n    const session = {\n        id: '00000000-aaaa-0000-aaaa-000000000000',\n        sessionReplay: bridgeSupports(\"records\" /* BridgeCapability.RECORDS */) ? 1 /* SessionReplayState.SAMPLED */ : 0 /* SessionReplayState.OFF */,\n    };\n    return {\n        findTrackedSession: () => session,\n        expire: noop,\n        expireObservable: new Observable(),\n        setForcedReplay: noop,\n    };\n}\nfunction computeTrackingType(configuration, rawTrackingType) {\n    if (hasValidRumSession(rawTrackingType)) {\n        return rawTrackingType;\n    }\n    if (!performDraw(configuration.sessionSampleRate)) {\n        return \"0\" /* RumTrackingType.NOT_TRACKED */;\n    }\n    if (!performDraw(configuration.sessionReplaySampleRate)) {\n        return \"2\" /* RumTrackingType.TRACKED_WITHOUT_SESSION_REPLAY */;\n    }\n    return \"1\" /* RumTrackingType.TRACKED_WITH_SESSION_REPLAY */;\n}\nfunction hasValidRumSession(trackingType) {\n    return (trackingType === \"0\" /* RumTrackingType.NOT_TRACKED */ ||\n        trackingType === \"1\" /* RumTrackingType.TRACKED_WITH_SESSION_REPLAY */ ||\n        trackingType === \"2\" /* RumTrackingType.TRACKED_WITHOUT_SESSION_REPLAY */);\n}\n//# sourceMappingURL=rumSessionManager.js.map","import { createBatch, createFlushController, createHttpRequest } from '@datadog/browser-core';\nimport { RumEventType } from '../rawRumEvent.types';\nexport function startRumBatch(configuration, lifeCycle, reportError, pageMayExitObservable, sessionExpireObservable, createEncoder) {\n    const endpoints = [configuration.rumEndpointBuilder];\n    if (configuration.replica) {\n        endpoints.push(configuration.replica.rumEndpointBuilder);\n    }\n    const batch = createBatch({\n        encoder: createEncoder(2 /* DeflateEncoderStreamId.RUM */),\n        request: createHttpRequest(endpoints, reportError),\n        flushController: createFlushController({\n            pageMayExitObservable,\n            sessionExpireObservable,\n        }),\n    });\n    lifeCycle.subscribe(13 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, (serverRumEvent) => {\n        if (serverRumEvent.type === RumEventType.VIEW) {\n            batch.upsert(serverRumEvent, serverRumEvent.view.id);\n        }\n        else {\n            batch.add(serverRumEvent);\n        }\n    });\n    return batch;\n}\n//# sourceMappingURL=startRumBatch.js.map","import { getEventBridge } from '@datadog/browser-core';\nexport function startRumEventBridge(lifeCycle) {\n    const bridge = getEventBridge();\n    lifeCycle.subscribe(13 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, (serverRumEvent) => {\n        bridge.send('rum', serverRumEvent);\n    });\n}\n//# sourceMappingURL=startRumEventBridge.js.map","import { SESSION_TIME_OUT_DELAY, relativeNow, createValueHistory, DISCARDED } from '@datadog/browser-core';\n/**\n * We want to attach to an event:\n * - the url corresponding to its start\n * - the referrer corresponding to the previous view url (or document referrer for initial view)\n */\nexport const URL_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport function startUrlContexts(lifeCycle, hooks, locationChangeObservable, location) {\n    const urlContextHistory = createValueHistory({ expireDelay: URL_CONTEXT_TIME_OUT_DELAY });\n    let previousViewUrl;\n    lifeCycle.subscribe(1 /* LifeCycleEventType.BEFORE_VIEW_CREATED */, ({ startClocks }) => {\n        const viewUrl = location.href;\n        urlContextHistory.add(buildUrlContext({\n            url: viewUrl,\n            referrer: !previousViewUrl ? document.referrer : previousViewUrl,\n        }), startClocks.relative);\n        previousViewUrl = viewUrl;\n    });\n    lifeCycle.subscribe(6 /* LifeCycleEventType.AFTER_VIEW_ENDED */, ({ endClocks }) => {\n        urlContextHistory.closeActive(endClocks.relative);\n    });\n    const locationChangeSubscription = locationChangeObservable.subscribe(({ newLocation }) => {\n        const current = urlContextHistory.find();\n        if (current) {\n            const changeTime = relativeNow();\n            urlContextHistory.closeActive(changeTime);\n            urlContextHistory.add(buildUrlContext({\n                url: newLocation.href,\n                referrer: current.referrer,\n            }), changeTime);\n        }\n    });\n    function buildUrlContext({ url, referrer }) {\n        return {\n            url,\n            referrer,\n        };\n    }\n    hooks.register(0 /* HookNames.Assemble */, ({ startTime, eventType }) => {\n        const urlContext = urlContextHistory.find(startTime);\n        if (!urlContext) {\n            return DISCARDED;\n        }\n        return {\n            type: eventType,\n            view: {\n                url: urlContext.url,\n                referrer: urlContext.referrer,\n            },\n        };\n    });\n    return {\n        findUrl: (startTime) => urlContextHistory.find(startTime),\n        stop: () => {\n            locationChangeSubscription.unsubscribe();\n            urlContextHistory.stop();\n        },\n    };\n}\n//# sourceMappingURL=urlContexts.js.map","import { addEventListener, instrumentMethod, Observable, shallowClone } from '@datadog/browser-core';\nexport function createLocationChangeObservable(configuration, location) {\n    let currentLocation = shallowClone(location);\n    return new Observable((observable) => {\n        const { stop: stopHistoryTracking } = trackHistory(configuration, onLocationChange);\n        const { stop: stopHashTracking } = trackHash(configuration, onLocationChange);\n        function onLocationChange() {\n            if (currentLocation.href === location.href) {\n                return;\n            }\n            const newLocation = shallowClone(location);\n            observable.notify({\n                newLocation,\n                oldLocation: currentLocation,\n            });\n            currentLocation = newLocation;\n        }\n        return () => {\n            stopHistoryTracking();\n            stopHashTracking();\n        };\n    });\n}\nfunction trackHistory(configuration, onHistoryChange) {\n    const { stop: stopInstrumentingPushState } = instrumentMethod(getHistoryInstrumentationTarget('pushState'), 'pushState', ({ onPostCall }) => {\n        onPostCall(onHistoryChange);\n    });\n    const { stop: stopInstrumentingReplaceState } = instrumentMethod(getHistoryInstrumentationTarget('replaceState'), 'replaceState', ({ onPostCall }) => {\n        onPostCall(onHistoryChange);\n    });\n    const { stop: removeListener } = addEventListener(configuration, window, \"popstate\" /* DOM_EVENT.POP_STATE */, onHistoryChange);\n    return {\n        stop: () => {\n            stopInstrumentingPushState();\n            stopInstrumentingReplaceState();\n            removeListener();\n        },\n    };\n}\nfunction trackHash(configuration, onHashChange) {\n    return addEventListener(configuration, window, \"hashchange\" /* DOM_EVENT.HASH_CHANGE */, onHashChange);\n}\nfunction getHistoryInstrumentationTarget(methodName) {\n    // Ideally we should always instument the method on the prototype, however some frameworks (e.g [Next.js](https://github.com/vercel/next.js/blob/d3f5532065f3e3bb84fb54bd2dfd1a16d0f03a21/packages/next/src/client/components/app-router.tsx#L429))\n    // are wrapping the instance method. In that case we should also wrap the instance method.\n    return Object.prototype.hasOwnProperty.call(history, methodName) ? history : History.prototype;\n}\n//# sourceMappingURL=locationChangeObservable.js.map","import { SESSION_TIME_OUT_DELAY, SKIPPED, createValueHistory, isEmptyObject } from '@datadog/browser-core';\nimport { RumEventType } from '../../rawRumEvent.types';\nexport const FEATURE_FLAG_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport const BYTES_COMPUTATION_THROTTLING_DELAY = 200;\n/**\n * Start feature flag contexts\n *\n * Feature flag contexts follow the life of views.\n * A new context is added when a view is created and ended when the view is ended\n *\n * Note: we choose not to add a new context at each evaluation to save memory\n */\nexport function startFeatureFlagContexts(lifeCycle, hooks, configuration) {\n    const featureFlagContexts = createValueHistory({\n        expireDelay: FEATURE_FLAG_CONTEXT_TIME_OUT_DELAY,\n    });\n    lifeCycle.subscribe(1 /* LifeCycleEventType.BEFORE_VIEW_CREATED */, ({ startClocks }) => {\n        featureFlagContexts.add({}, startClocks.relative);\n    });\n    lifeCycle.subscribe(6 /* LifeCycleEventType.AFTER_VIEW_ENDED */, ({ endClocks }) => {\n        featureFlagContexts.closeActive(endClocks.relative);\n    });\n    hooks.register(0 /* HookNames.Assemble */, ({ startTime, eventType }) => {\n        const trackFeatureFlagsForEvents = configuration.trackFeatureFlagsForEvents.concat([\n            RumEventType.VIEW,\n            RumEventType.ERROR,\n        ]);\n        if (!trackFeatureFlagsForEvents.includes(eventType)) {\n            return SKIPPED;\n        }\n        const featureFlagContext = featureFlagContexts.find(startTime);\n        if (!featureFlagContext || isEmptyObject(featureFlagContext)) {\n            return SKIPPED;\n        }\n        return {\n            type: eventType,\n            feature_flags: featureFlagContext,\n        };\n    });\n    return {\n        addFeatureFlagEvaluation: (key, value) => {\n            const currentContext = featureFlagContexts.find();\n            if (currentContext) {\n                currentContext[key] = value;\n            }\n        },\n    };\n}\n//# sourceMappingURL=featureFlagContext.js.map","import { ONE_SECOND, addTelemetryMetrics, setInterval } from '@datadog/browser-core';\nexport const MEASURES_PERIOD_DURATION = 10 * ONE_SECOND;\nlet currentPeriodMeasures;\nlet batchHasRumEvent;\nexport function startCustomerDataTelemetry(telemetry, lifeCycle, batchFlushObservable) {\n    if (!telemetry.metricsEnabled) {\n        return;\n    }\n    initCurrentPeriodMeasures();\n    batchHasRumEvent = false;\n    // We measure the data of every view updates even if there could only be one per batch due to the upsert\n    // It means that contexts bytes count sums can be higher than it really is\n    lifeCycle.subscribe(13 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, () => {\n        batchHasRumEvent = true;\n    });\n    batchFlushObservable.subscribe(({ bytesCount, messagesCount }) => {\n        // Don't measure batch that only contains telemetry events to avoid batch sending loop\n        // It could happen because after each batch we are adding a customer data measures telemetry event to the next one\n        if (!batchHasRumEvent) {\n            return;\n        }\n        batchHasRumEvent = false;\n        currentPeriodMeasures.batchCount += 1;\n        updateMeasure(currentPeriodMeasures.batchBytesCount, bytesCount);\n        updateMeasure(currentPeriodMeasures.batchMessagesCount, messagesCount);\n    });\n    setInterval(sendCurrentPeriodMeasures, MEASURES_PERIOD_DURATION);\n}\nfunction sendCurrentPeriodMeasures() {\n    if (currentPeriodMeasures.batchCount === 0) {\n        return;\n    }\n    // monitor-until: forever\n    addTelemetryMetrics(\"Customer data measures\" /* TelemetryMetrics.CUSTOMER_DATA_METRIC_NAME */, currentPeriodMeasures);\n    initCurrentPeriodMeasures();\n}\nfunction createMeasure() {\n    return { min: Infinity, max: 0, sum: 0 };\n}\nfunction updateMeasure(measure, value) {\n    measure.sum += value;\n    measure.min = Math.min(measure.min, value);\n    measure.max = Math.max(measure.max, value);\n}\nfunction initCurrentPeriodMeasures() {\n    currentPeriodMeasures = {\n        batchCount: 0,\n        batchBytesCount: createMeasure(),\n        batchMessagesCount: createMeasure(),\n    };\n}\n//# sourceMappingURL=startCustomerDataTelemetry.js.map","import { SKIPPED, elapsed, createValueHistory, SESSION_TIME_OUT_DELAY, toServerDuration, addEventListeners, relativeNow, } from '@datadog/browser-core';\nimport { supportPerformanceTimingEvent, RumPerformanceEntryType } from '../../browser/performanceObservable';\nimport { RumEventType } from '../../rawRumEvent.types';\n// Arbitrary value to cap number of element for memory consumption in the browser\nexport const MAX_PAGE_STATE_ENTRIES = 4000;\n// Arbitrary value to cap number of element for backend & to save bandwidth\nexport const MAX_PAGE_STATE_ENTRIES_SELECTABLE = 500;\nexport const PAGE_STATE_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport function startPageStateHistory(hooks, configuration, maxPageStateEntriesSelectable = MAX_PAGE_STATE_ENTRIES_SELECTABLE) {\n    const pageStateEntryHistory = createValueHistory({\n        expireDelay: PAGE_STATE_CONTEXT_TIME_OUT_DELAY,\n        maxEntries: MAX_PAGE_STATE_ENTRIES,\n    });\n    let currentPageState;\n    if (supportPerformanceTimingEvent(RumPerformanceEntryType.VISIBILITY_STATE)) {\n        const visibilityEntries = performance.getEntriesByType(RumPerformanceEntryType.VISIBILITY_STATE);\n        visibilityEntries.forEach((entry) => {\n            const state = entry.name === 'hidden' ? \"hidden\" /* PageState.HIDDEN */ : \"active\" /* PageState.ACTIVE */;\n            addPageState(state, entry.startTime);\n        });\n    }\n    addPageState(getPageState(), relativeNow());\n    const { stop: stopEventListeners } = addEventListeners(configuration, window, [\n        \"pageshow\" /* DOM_EVENT.PAGE_SHOW */,\n        \"focus\" /* DOM_EVENT.FOCUS */,\n        \"blur\" /* DOM_EVENT.BLUR */,\n        \"visibilitychange\" /* DOM_EVENT.VISIBILITY_CHANGE */,\n        \"resume\" /* DOM_EVENT.RESUME */,\n        \"freeze\" /* DOM_EVENT.FREEZE */,\n        \"pagehide\" /* DOM_EVENT.PAGE_HIDE */,\n    ], (event) => {\n        addPageState(computePageState(event), event.timeStamp);\n    }, { capture: true });\n    function addPageState(nextPageState, startTime = relativeNow()) {\n        if (nextPageState === currentPageState) {\n            return;\n        }\n        currentPageState = nextPageState;\n        pageStateEntryHistory.closeActive(startTime);\n        pageStateEntryHistory.add({ state: currentPageState, startTime }, startTime);\n    }\n    function wasInPageStateDuringPeriod(state, startTime, duration) {\n        return pageStateEntryHistory.findAll(startTime, duration).some((pageState) => pageState.state === state);\n    }\n    hooks.register(0 /* HookNames.Assemble */, ({ startTime, duration = 0, eventType }) => {\n        if (eventType === RumEventType.VIEW) {\n            const pageStates = pageStateEntryHistory.findAll(startTime, duration);\n            return {\n                type: eventType,\n                _dd: { page_states: processPageStates(pageStates, startTime, maxPageStateEntriesSelectable) },\n            };\n        }\n        if (eventType === RumEventType.ACTION || eventType === RumEventType.ERROR) {\n            return {\n                type: eventType,\n                view: { in_foreground: wasInPageStateDuringPeriod(\"active\" /* PageState.ACTIVE */, startTime, 0) },\n            };\n        }\n        return SKIPPED;\n    });\n    return {\n        wasInPageStateDuringPeriod,\n        addPageState,\n        stop: () => {\n            stopEventListeners();\n            pageStateEntryHistory.stop();\n        },\n    };\n}\nfunction processPageStates(pageStateEntries, eventStartTime, maxPageStateEntriesSelectable) {\n    if (pageStateEntries.length === 0) {\n        return;\n    }\n    return pageStateEntries\n        .slice(-maxPageStateEntriesSelectable)\n        .reverse()\n        .map(({ state, startTime }) => ({\n        state,\n        start: toServerDuration(elapsed(eventStartTime, startTime)),\n    }));\n}\nfunction computePageState(event) {\n    if (event.type === \"freeze\" /* DOM_EVENT.FREEZE */) {\n        return \"frozen\" /* PageState.FROZEN */;\n    }\n    else if (event.type === \"pagehide\" /* DOM_EVENT.PAGE_HIDE */) {\n        return event.persisted ? \"frozen\" /* PageState.FROZEN */ : \"terminated\" /* PageState.TERMINATED */;\n    }\n    return getPageState();\n}\nfunction getPageState() {\n    if (document.visibilityState === 'hidden') {\n        return \"hidden\" /* PageState.HIDDEN */;\n    }\n    if (document.hasFocus()) {\n        return \"active\" /* PageState.ACTIVE */;\n    }\n    return \"passive\" /* PageState.PASSIVE */;\n}\n//# sourceMappingURL=pageStateHistory.js.map","import { monitor } from '@datadog/browser-core';\nimport { getViewportDimension, initViewportObservable } from '../../browser/viewportObservable';\nexport function startDisplayContext(hooks, configuration) {\n    let viewport;\n    // Use requestAnimationFrame to delay the calculation of viewport dimensions until after SDK initialization, preventing long tasks.\n    const animationFrameId = requestAnimationFrame(monitor(() => {\n        viewport = getViewportDimension();\n    }));\n    const unsubscribeViewport = initViewportObservable(configuration).subscribe((viewportDimension) => {\n        viewport = viewportDimension;\n    }).unsubscribe;\n    hooks.register(0 /* HookNames.Assemble */, ({ eventType }) => ({\n        type: eventType,\n        display: viewport ? { viewport } : undefined,\n    }));\n    return {\n        stop: () => {\n            unsubscribeViewport();\n            if (animationFrameId) {\n                cancelAnimationFrame(animationFrameId);\n            }\n        },\n    };\n}\n//# sourceMappingURL=displayContext.js.map","import { setInterval, clearInterval, Observable, addEventListener, ONE_SECOND, findCommaSeparatedValue, } from '@datadog/browser-core';\nexport function createCookieObservable(configuration, cookieName) {\n    const detectCookieChangeStrategy = window.cookieStore\n        ? listenToCookieStoreChange(configuration)\n        : watchCookieFallback;\n    return new Observable((observable) => detectCookieChangeStrategy(cookieName, (event) => observable.notify(event)));\n}\nfunction listenToCookieStoreChange(configuration) {\n    return (cookieName, callback) => {\n        const listener = addEventListener(configuration, window.cookieStore, \"change\" /* DOM_EVENT.CHANGE */, (event) => {\n            // Based on our experimentation, we're assuming that entries for the same cookie cannot be in both the 'changed' and 'deleted' arrays.\n            // However, due to ambiguity in the specification, we asked for clarification: https://github.com/WICG/cookie-store/issues/226\n            const changeEvent = event.changed.find((event) => event.name === cookieName) ||\n                event.deleted.find((event) => event.name === cookieName);\n            if (changeEvent) {\n                callback(changeEvent.value);\n            }\n        });\n        return listener.stop;\n    };\n}\nexport const WATCH_COOKIE_INTERVAL_DELAY = ONE_SECOND;\nfunction watchCookieFallback(cookieName, callback) {\n    const previousCookieValue = findCommaSeparatedValue(document.cookie, cookieName);\n    const watchCookieIntervalId = setInterval(() => {\n        const cookieValue = findCommaSeparatedValue(document.cookie, cookieName);\n        if (cookieValue !== previousCookieValue) {\n            callback(cookieValue);\n        }\n    }, WATCH_COOKIE_INTERVAL_DELAY);\n    return () => {\n        clearInterval(watchCookieIntervalId);\n    };\n}\n//# sourceMappingURL=cookieObservable.js.map","import { getInitCookie, SKIPPED } from '@datadog/browser-core';\nimport { createCookieObservable } from '../../browser/cookieObservable';\nexport const CI_VISIBILITY_TEST_ID_COOKIE_NAME = 'datadog-ci-visibility-test-execution-id';\nexport function startCiVisibilityContext(configuration, hooks, cookieObservable = createCookieObservable(configuration, CI_VISIBILITY_TEST_ID_COOKIE_NAME)) {\n    var _a;\n    let testExecutionId = getInitCookie(CI_VISIBILITY_TEST_ID_COOKIE_NAME) || ((_a = window.Cypress) === null || _a === void 0 ? void 0 : _a.env('traceId'));\n    const cookieObservableSubscription = cookieObservable.subscribe((value) => {\n        testExecutionId = value;\n    });\n    hooks.register(0 /* HookNames.Assemble */, ({ eventType }) => {\n        if (typeof testExecutionId !== 'string') {\n            return SKIPPED;\n        }\n        return {\n            type: eventType,\n            session: {\n                type: \"ci_test\" /* SessionType.CI_TEST */,\n            },\n            ci_test: {\n                test_execution_id: testExecutionId,\n            },\n        };\n    });\n    return {\n        stop: () => {\n            cookieObservableSubscription.unsubscribe();\n        },\n    };\n}\n//# sourceMappingURL=ciVisibilityContext.js.map","import { toServerDuration, relativeToClocks, generateUUID } from '@datadog/browser-core';\nimport { RumEventType, RumLongTaskEntryType } from '../../rawRumEvent.types';\nimport { createPerformanceObservable, RumPerformanceEntryType } from '../../browser/performanceObservable';\nexport function startLongAnimationFrameCollection(lifeCycle, configuration) {\n    const performanceResourceSubscription = createPerformanceObservable(configuration, {\n        type: RumPerformanceEntryType.LONG_ANIMATION_FRAME,\n        buffered: true,\n    }).subscribe((entries) => {\n        for (const entry of entries) {\n            const startClocks = relativeToClocks(entry.startTime);\n            const rawRumEvent = {\n                date: startClocks.timeStamp,\n                long_task: {\n                    id: generateUUID(),\n                    entry_type: RumLongTaskEntryType.LONG_ANIMATION_FRAME,\n                    duration: toServerDuration(entry.duration),\n                    blocking_duration: toServerDuration(entry.blockingDuration),\n                    first_ui_event_timestamp: toServerDuration(entry.firstUIEventTimestamp),\n                    render_start: toServerDuration(entry.renderStart),\n                    style_and_layout_start: toServerDuration(entry.styleAndLayoutStart),\n                    start_time: toServerDuration(entry.startTime),\n                    scripts: entry.scripts.map((script) => ({\n                        duration: toServerDuration(script.duration),\n                        pause_duration: toServerDuration(script.pauseDuration),\n                        forced_style_and_layout_duration: toServerDuration(script.forcedStyleAndLayoutDuration),\n                        start_time: toServerDuration(script.startTime),\n                        execution_start: toServerDuration(script.executionStart),\n                        source_url: script.sourceURL,\n                        source_function_name: script.sourceFunctionName,\n                        source_char_position: script.sourceCharPosition,\n                        invoker: script.invoker,\n                        invoker_type: script.invokerType,\n                        window_attribution: script.windowAttribution,\n                    })),\n                },\n                type: RumEventType.LONG_TASK,\n                _dd: {\n                    discarded: false,\n                },\n            };\n            lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, {\n                rawRumEvent,\n                startTime: startClocks.relative,\n                duration: entry.duration,\n                domainContext: { performanceEntry: entry },\n            });\n        }\n    });\n    return { stop: () => performanceResourceSubscription.unsubscribe() };\n}\n//# sourceMappingURL=longAnimationFrameCollection.js.map","import { toServerDuration, relativeToClocks, generateUUID } from '@datadog/browser-core';\nimport { RumEventType, RumLongTaskEntryType } from '../../rawRumEvent.types';\nimport { createPerformanceObservable, RumPerformanceEntryType } from '../../browser/performanceObservable';\nexport function startLongTaskCollection(lifeCycle, configuration) {\n    const performanceLongTaskSubscription = createPerformanceObservable(configuration, {\n        type: RumPerformanceEntryType.LONG_TASK,\n        buffered: true,\n    }).subscribe((entries) => {\n        for (const entry of entries) {\n            if (entry.entryType !== RumPerformanceEntryType.LONG_TASK) {\n                break;\n            }\n            if (!configuration.trackLongTasks) {\n                break;\n            }\n            const startClocks = relativeToClocks(entry.startTime);\n            const rawRumEvent = {\n                date: startClocks.timeStamp,\n                long_task: {\n                    id: generateUUID(),\n                    entry_type: RumLongTaskEntryType.LONG_TASK,\n                    duration: toServerDuration(entry.duration),\n                },\n                type: RumEventType.LONG_TASK,\n                _dd: {\n                    discarded: false,\n                },\n            };\n            lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, {\n                rawRumEvent,\n                startTime: startClocks.relative,\n                duration: entry.duration,\n                domainContext: { performanceEntry: entry },\n            });\n        }\n    });\n    return {\n        stop() {\n            performanceLongTaskSubscription.unsubscribe();\n        },\n    };\n}\n//# sourceMappingURL=longTaskCollection.js.map","import { SKIPPED, getSyntheticsResultId, getSyntheticsTestId, willSyntheticsInjectRum, isSyntheticsTest, } from '@datadog/browser-core';\nexport function startSyntheticsContext(hooks) {\n    hooks.register(0 /* HookNames.Assemble */, ({ eventType }) => {\n        if (!isSyntheticsTest()) {\n            return SKIPPED;\n        }\n        const testId = getSyntheticsTestId();\n        const resultId = getSyntheticsResultId();\n        return {\n            type: eventType,\n            session: {\n                type: \"synthetics\" /* SessionType.SYNTHETICS */,\n            },\n            synthetics: {\n                test_id: testId,\n                result_id: resultId,\n                injected: willSyntheticsInjectRum(),\n            },\n        };\n    });\n}\n//# sourceMappingURL=syntheticsContext.js.map","import { sanitize, deepClone, getType, objectEntries } from '@datadog/browser-core';\n/**\n * Allows declaring and enforcing modifications to specific fields of an object.\n * Only supports modifying properties of an object (even if nested in an array).\n * Does not support array manipulation (adding/removing items).\n */\nexport function limitModification(object, modifiableFieldPaths, modifier) {\n    const clone = deepClone(object);\n    const result = modifier(clone);\n    objectEntries(modifiableFieldPaths).forEach(([fieldPath, fieldType]) => \n    // Traverse both object and clone simultaneously up to the path and apply the modification from the clone to the original object when the type is valid\n    setValueAtPath(object, clone, fieldPath.split(/\\.|(?=\\[\\])/), fieldType));\n    return result;\n}\nfunction setValueAtPath(object, clone, pathSegments, fieldType) {\n    const [field, ...restPathSegments] = pathSegments;\n    if (field === '[]') {\n        if (Array.isArray(object) && Array.isArray(clone)) {\n            object.forEach((item, i) => setValueAtPath(item, clone[i], restPathSegments, fieldType));\n        }\n        return;\n    }\n    if (!isValidObject(object) || !isValidObject(clone)) {\n        return;\n    }\n    if (restPathSegments.length > 0) {\n        return setValueAtPath(object[field], clone[field], restPathSegments, fieldType);\n    }\n    setNestedValue(object, field, clone[field], fieldType);\n}\nfunction setNestedValue(object, field, value, fieldType) {\n    const newType = getType(value);\n    if (newType === fieldType) {\n        object[field] = sanitize(value);\n    }\n    else if (fieldType === 'object' && (newType === 'undefined' || newType === 'null')) {\n        object[field] = {};\n    }\n}\nfunction isValidObject(object) {\n    return getType(object) === 'object';\n}\n//# sourceMappingURL=limitModification.js.map","import { combine, isEmptyObject, display, createEventRateLimiter, DISCARDED, buildTags, } from '@datadog/browser-core';\nimport { RumEventType } from '../rawRumEvent.types';\nimport { limitModification } from './limitModification';\nconst VIEW_MODIFIABLE_FIELD_PATHS = {\n    'view.name': 'string',\n    'view.url': 'string',\n    'view.referrer': 'string',\n};\nconst USER_CUSTOMIZABLE_FIELD_PATHS = {\n    context: 'object',\n};\nconst ROOT_MODIFIABLE_FIELD_PATHS = {\n    service: 'string',\n    version: 'string',\n};\nlet modifiableFieldPathsByEvent;\nexport function startRumAssembly(configuration, lifeCycle, hooks, reportError, eventRateLimit) {\n    modifiableFieldPathsByEvent = {\n        [RumEventType.VIEW]: {\n            'view.performance.lcp.resource_url': 'string',\n            ...USER_CUSTOMIZABLE_FIELD_PATHS,\n            ...VIEW_MODIFIABLE_FIELD_PATHS,\n            ...ROOT_MODIFIABLE_FIELD_PATHS,\n        },\n        [RumEventType.ERROR]: {\n            'error.message': 'string',\n            'error.stack': 'string',\n            'error.resource.url': 'string',\n            'error.fingerprint': 'string',\n            ...USER_CUSTOMIZABLE_FIELD_PATHS,\n            ...VIEW_MODIFIABLE_FIELD_PATHS,\n            ...ROOT_MODIFIABLE_FIELD_PATHS,\n        },\n        [RumEventType.RESOURCE]: {\n            'resource.url': 'string',\n            'resource.graphql.variables': 'string',\n            ...USER_CUSTOMIZABLE_FIELD_PATHS,\n            ...VIEW_MODIFIABLE_FIELD_PATHS,\n            ...ROOT_MODIFIABLE_FIELD_PATHS,\n        },\n        [RumEventType.ACTION]: {\n            'action.target.name': 'string',\n            ...USER_CUSTOMIZABLE_FIELD_PATHS,\n            ...VIEW_MODIFIABLE_FIELD_PATHS,\n            ...ROOT_MODIFIABLE_FIELD_PATHS,\n        },\n        [RumEventType.LONG_TASK]: {\n            'long_task.scripts[].source_url': 'string',\n            'long_task.scripts[].invoker': 'string',\n            ...USER_CUSTOMIZABLE_FIELD_PATHS,\n            ...VIEW_MODIFIABLE_FIELD_PATHS,\n            ...ROOT_MODIFIABLE_FIELD_PATHS,\n        },\n        [RumEventType.VITAL]: {\n            ...USER_CUSTOMIZABLE_FIELD_PATHS,\n            ...VIEW_MODIFIABLE_FIELD_PATHS,\n            ...ROOT_MODIFIABLE_FIELD_PATHS,\n        },\n    };\n    const eventRateLimiters = {\n        [RumEventType.ERROR]: createEventRateLimiter(RumEventType.ERROR, reportError, eventRateLimit),\n        [RumEventType.ACTION]: createEventRateLimiter(RumEventType.ACTION, reportError, eventRateLimit),\n        [RumEventType.VITAL]: createEventRateLimiter(RumEventType.VITAL, reportError, eventRateLimit),\n    };\n    lifeCycle.subscribe(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, ({ startTime, duration, rawRumEvent, domainContext }) => {\n        const defaultRumEventAttributes = hooks.triggerHook(0 /* HookNames.Assemble */, {\n            eventType: rawRumEvent.type,\n            startTime,\n            duration,\n        });\n        if (defaultRumEventAttributes === DISCARDED) {\n            return;\n        }\n        const serverRumEvent = combine(defaultRumEventAttributes, rawRumEvent, {\n            ddtags: buildTags(configuration).join(','),\n        });\n        if (shouldSend(serverRumEvent, configuration.beforeSend, domainContext, eventRateLimiters)) {\n            if (isEmptyObject(serverRumEvent.context)) {\n                delete serverRumEvent.context;\n            }\n            lifeCycle.notify(13 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, serverRumEvent);\n        }\n    });\n}\nfunction shouldSend(event, beforeSend, domainContext, eventRateLimiters) {\n    var _a;\n    if (beforeSend) {\n        const result = limitModification(event, modifiableFieldPathsByEvent[event.type], (event) => beforeSend(event, domainContext));\n        if (result === false && event.type !== RumEventType.VIEW) {\n            return false;\n        }\n        if (result === false) {\n            display.warn(\"Can't dismiss view events using beforeSend!\");\n        }\n    }\n    const rateLimitReached = (_a = eventRateLimiters[event.type]) === null || _a === void 0 ? void 0 : _a.isLimitReached();\n    return !rateLimitReached;\n}\n//# sourceMappingURL=assembly.js.map","import { DISCARDED, SKIPPED } from '@datadog/browser-core';\nimport { RumEventType } from '../../rawRumEvent.types';\nexport function startSessionContext(hooks, sessionManager, recorderApi, viewHistory) {\n    hooks.register(0 /* HookNames.Assemble */, ({ eventType, startTime }) => {\n        const session = sessionManager.findTrackedSession(startTime);\n        const view = viewHistory.findView(startTime);\n        if (!session || !view) {\n            return DISCARDED;\n        }\n        let hasReplay;\n        let sampledForReplay;\n        let isActive;\n        if (eventType === RumEventType.VIEW) {\n            hasReplay = recorderApi.getReplayStats(view.id) ? true : undefined;\n            sampledForReplay = session.sessionReplay === 1 /* SessionReplayState.SAMPLED */;\n            isActive = view.sessionIsActive ? undefined : false;\n        }\n        else {\n            hasReplay = recorderApi.isRecording() ? true : undefined;\n        }\n        return {\n            type: eventType,\n            session: {\n                id: session.id,\n                type: \"user\" /* SessionType.USER */,\n                has_replay: hasReplay,\n                sampled_for_replay: sampledForReplay,\n                is_active: isActive,\n            },\n        };\n    });\n    hooks.register(1 /* HookNames.AssembleTelemetry */, ({ startTime }) => {\n        const session = sessionManager.findTrackedSession(startTime);\n        if (!session) {\n            return SKIPPED;\n        }\n        return {\n            session: {\n                id: session.id,\n            },\n        };\n    });\n}\n//# sourceMappingURL=sessionContext.js.map","import { getConnectivity } from '@datadog/browser-core';\nexport function startConnectivityContext(hooks) {\n    hooks.register(0 /* HookNames.Assemble */, ({ eventType }) => ({\n        type: eventType,\n        connectivity: getConnectivity(),\n    }));\n}\n//# sourceMappingURL=connectivityContext.js.map","import { canUseEventBridge, currentDrift, round, timeStampNow } from '@datadog/browser-core';\nexport function startDefaultContext(hooks, configuration, sdkName) {\n    hooks.register(0 /* HookNames.Assemble */, ({ eventType }) => {\n        const source = configuration.source;\n        return {\n            type: eventType,\n            _dd: {\n                format_version: 2,\n                drift: currentDrift(),\n                configuration: {\n                    session_sample_rate: round(configuration.sessionSampleRate, 3),\n                    session_replay_sample_rate: round(configuration.sessionReplaySampleRate, 3),\n                    profiling_sample_rate: round(configuration.profilingSampleRate, 3),\n                    beta_encode_cookie_options: configuration.betaEncodeCookieOptions,\n                },\n                browser_sdk_version: canUseEventBridge() ? \"6.24.1\" : undefined,\n                sdk_name: sdkName,\n            },\n            application: {\n                id: configuration.applicationId,\n            },\n            date: timeStampNow(),\n            source,\n        };\n    });\n    hooks.register(1 /* HookNames.AssembleTelemetry */, () => ({\n        application: { id: configuration.applicationId },\n    }));\n}\n//# sourceMappingURL=defaultContext.js.map","import { DISCARDED, SKIPPED } from '@datadog/browser-core';\nexport function startTrackingConsentContext(hooks, trackingConsentState) {\n    hooks.register(1 /* HookNames.AssembleTelemetry */, () => {\n        const wasConsented = trackingConsentState.isGranted();\n        if (!wasConsented) {\n            return DISCARDED;\n        }\n        return SKIPPED;\n    });\n}\n//# sourceMappingURL=trackingConsentContext.js.map","import { abstractHooks } from '@datadog/browser-core';\nexport const createHooks = (abstractHooks);\n//# sourceMappingURL=hooks.js.map","import { RumEventType } from '../../rawRumEvent.types';\nconst allowedEventTypes = [\n    RumEventType.ACTION,\n    RumEventType.ERROR,\n    RumEventType.LONG_TASK,\n    RumEventType.RESOURCE,\n    RumEventType.VITAL,\n];\nexport function startEventCollection(lifeCycle) {\n    return {\n        addEvent: (startTime, event, domainContext, duration) => {\n            if (!allowedEventTypes.includes(event.type)) {\n                return;\n            }\n            lifeCycle.notify(12 /* LifeCycleEventType.RAW_RUM_EVENT_COLLECTED */, {\n                startTime,\n                rawRumEvent: event,\n                domainContext,\n                duration,\n            });\n        },\n    };\n}\n//# sourceMappingURL=eventCollection.js.map","import { addTelemetryMetrics, noop } from '@datadog/browser-core';\nexport function startInitialViewMetricsTelemetry(lifeCycle, telemetry) {\n    if (!telemetry.metricsEnabled) {\n        return { stop: noop };\n    }\n    const { unsubscribe } = lifeCycle.subscribe(4 /* LifeCycleEventType.VIEW_UPDATED */, ({ initialViewMetrics }) => {\n        if (!initialViewMetrics.largestContentfulPaint || !initialViewMetrics.navigationTimings) {\n            return;\n        }\n        // The navigation timings become available shortly after the load event fires, so\n        // we're snapshotting the LCP value available at that point. However, more LCP values\n        // can be emitted until the page is scrolled or interacted with, so it's possible that\n        // the final LCP value may differ. These metrics are intended to help diagnose\n        // performance issues early in the page load process, and using LCP-at-page-load is a\n        // good fit for that use case, but it's important to be aware that this is not\n        // necessarily equivalent to the normal LCP metric.\n        // monitor-until: 2026-07-01\n        addTelemetryMetrics(\"Initial view metrics\" /* TelemetryMetrics.INITIAL_VIEW_METRICS_TELEMETRY_NAME */, {\n            metrics: createCoreInitialViewMetrics(initialViewMetrics.largestContentfulPaint, initialViewMetrics.navigationTimings),\n        });\n        unsubscribe();\n    });\n    return {\n        stop: unsubscribe,\n    };\n}\nfunction createCoreInitialViewMetrics(lcp, navigation) {\n    return {\n        lcp: {\n            value: lcp.value,\n        },\n        navigation: {\n            domComplete: navigation.domComplete,\n            domContentLoaded: navigation.domContentLoaded,\n            domInteractive: navigation.domInteractive,\n            firstByte: navigation.firstByte,\n            loadEvent: navigation.loadEvent,\n        },\n    };\n}\n//# sourceMappingURL=startInitialViewMetricsTelemetry.js.map","import { sendToExtension, createPageMayExitObservable, startTelemetry, canUseEventBridge, addTelemetryDebug, startAccountContext, startGlobalContext, startUserContext, } from '@datadog/browser-core';\nimport { createDOMMutationObservable } from '../browser/domMutationObservable';\nimport { createWindowOpenObservable } from '../browser/windowOpenObservable';\nimport { startInternalContext } from '../domain/contexts/internalContext';\nimport { LifeCycle } from '../domain/lifeCycle';\nimport { startViewHistory } from '../domain/contexts/viewHistory';\nimport { startRequestCollection } from '../domain/requestCollection';\nimport { startActionCollection } from '../domain/action/actionCollection';\nimport { startErrorCollection } from '../domain/error/errorCollection';\nimport { startResourceCollection } from '../domain/resource/resourceCollection';\nimport { startViewCollection } from '../domain/view/viewCollection';\nimport { startRumSessionManager, startRumSessionManagerStub } from '../domain/rumSessionManager';\nimport { startRumBatch } from '../transport/startRumBatch';\nimport { startRumEventBridge } from '../transport/startRumEventBridge';\nimport { startUrlContexts } from '../domain/contexts/urlContexts';\nimport { createLocationChangeObservable } from '../browser/locationChangeObservable';\nimport { startFeatureFlagContexts } from '../domain/contexts/featureFlagContext';\nimport { startCustomerDataTelemetry } from '../domain/startCustomerDataTelemetry';\nimport { startPageStateHistory } from '../domain/contexts/pageStateHistory';\nimport { startDisplayContext } from '../domain/contexts/displayContext';\nimport { startVitalCollection } from '../domain/vital/vitalCollection';\nimport { startCiVisibilityContext } from '../domain/contexts/ciVisibilityContext';\nimport { startLongAnimationFrameCollection } from '../domain/longAnimationFrame/longAnimationFrameCollection';\nimport { RumPerformanceEntryType, supportPerformanceTimingEvent } from '../browser/performanceObservable';\nimport { startLongTaskCollection } from '../domain/longTask/longTaskCollection';\nimport { startSyntheticsContext } from '../domain/contexts/syntheticsContext';\nimport { startRumAssembly } from '../domain/assembly';\nimport { startSessionContext } from '../domain/contexts/sessionContext';\nimport { startConnectivityContext } from '../domain/contexts/connectivityContext';\nimport { startDefaultContext } from '../domain/contexts/defaultContext';\nimport { startTrackingConsentContext } from '../domain/contexts/trackingConsentContext';\nimport { createHooks } from '../domain/hooks';\nimport { startEventCollection } from '../domain/event/eventCollection';\nimport { startInitialViewMetricsTelemetry } from '../domain/view/viewMetrics/startInitialViewMetricsTelemetry';\nexport function startRum(configuration, recorderApi, profilerApi, initialViewOptions, createEncoder, \n// `startRum` and its subcomponents assume tracking consent is granted initially and starts\n// collecting logs unconditionally. As such, `startRum` should be called with a\n// `trackingConsentState` set to \"granted\".\ntrackingConsentState, customVitalsState, bufferedDataObservable, sdkName) {\n    const cleanupTasks = [];\n    const lifeCycle = new LifeCycle();\n    const hooks = createHooks();\n    lifeCycle.subscribe(13 /* LifeCycleEventType.RUM_EVENT_COLLECTED */, (event) => sendToExtension('rum', event));\n    const reportError = (error) => {\n        lifeCycle.notify(14 /* LifeCycleEventType.RAW_ERROR_COLLECTED */, { error });\n        // monitor-until: forever, to keep an eye on the errors reported to customers\n        addTelemetryDebug('Error reported to customer', { 'error.message': error.message });\n    };\n    const pageMayExitObservable = createPageMayExitObservable(configuration);\n    const pageMayExitSubscription = pageMayExitObservable.subscribe((event) => {\n        lifeCycle.notify(11 /* LifeCycleEventType.PAGE_MAY_EXIT */, event);\n    });\n    cleanupTasks.push(() => pageMayExitSubscription.unsubscribe());\n    const telemetry = startTelemetry(\"browser-rum-sdk\" /* TelemetryService.RUM */, configuration, hooks, reportError, pageMayExitObservable, createEncoder);\n    cleanupTasks.push(telemetry.stop);\n    const session = !canUseEventBridge()\n        ? startRumSessionManager(configuration, lifeCycle, trackingConsentState)\n        : startRumSessionManagerStub();\n    if (!canUseEventBridge()) {\n        const batch = startRumBatch(configuration, lifeCycle, reportError, pageMayExitObservable, session.expireObservable, createEncoder);\n        cleanupTasks.push(() => batch.stop());\n        startCustomerDataTelemetry(telemetry, lifeCycle, batch.flushController.flushObservable);\n    }\n    else {\n        startRumEventBridge(lifeCycle);\n    }\n    const domMutationObservable = createDOMMutationObservable();\n    const locationChangeObservable = createLocationChangeObservable(configuration, location);\n    const { observable: windowOpenObservable, stop: stopWindowOpen } = createWindowOpenObservable();\n    cleanupTasks.push(stopWindowOpen);\n    startDefaultContext(hooks, configuration, sdkName);\n    const pageStateHistory = startPageStateHistory(hooks, configuration);\n    const viewHistory = startViewHistory(lifeCycle);\n    cleanupTasks.push(() => viewHistory.stop());\n    const urlContexts = startUrlContexts(lifeCycle, hooks, locationChangeObservable, location);\n    cleanupTasks.push(() => urlContexts.stop());\n    const featureFlagContexts = startFeatureFlagContexts(lifeCycle, hooks, configuration);\n    startSessionContext(hooks, session, recorderApi, viewHistory);\n    startConnectivityContext(hooks);\n    startTrackingConsentContext(hooks, trackingConsentState);\n    const globalContext = startGlobalContext(hooks, configuration, 'rum', true);\n    const userContext = startUserContext(hooks, configuration, session, 'rum');\n    const accountContext = startAccountContext(hooks, configuration, 'rum');\n    const { actionContexts, addAction, addEvent, stop: stopRumEventCollection, } = startRumEventCollection(lifeCycle, hooks, configuration, pageStateHistory, domMutationObservable, windowOpenObservable, reportError);\n    cleanupTasks.push(stopRumEventCollection);\n    const { addTiming, startView, setViewName, setViewContext, setViewContextProperty, getViewContext, stop: stopViewCollection, } = startViewCollection(lifeCycle, hooks, configuration, location, domMutationObservable, windowOpenObservable, locationChangeObservable, recorderApi, viewHistory, initialViewOptions);\n    cleanupTasks.push(stopViewCollection);\n    const { stop: stopInitialViewMetricsTelemetry } = startInitialViewMetricsTelemetry(lifeCycle, telemetry);\n    cleanupTasks.push(stopInitialViewMetricsTelemetry);\n    const { stop: stopResourceCollection } = startResourceCollection(lifeCycle, configuration, pageStateHistory);\n    cleanupTasks.push(stopResourceCollection);\n    if (configuration.trackLongTasks) {\n        if (supportPerformanceTimingEvent(RumPerformanceEntryType.LONG_ANIMATION_FRAME)) {\n            const { stop: stopLongAnimationFrameCollection } = startLongAnimationFrameCollection(lifeCycle, configuration);\n            cleanupTasks.push(stopLongAnimationFrameCollection);\n        }\n        else {\n            startLongTaskCollection(lifeCycle, configuration);\n        }\n    }\n    const { addError } = startErrorCollection(lifeCycle, configuration, bufferedDataObservable);\n    bufferedDataObservable.unbuffer();\n    startRequestCollection(lifeCycle, configuration, session, userContext, accountContext);\n    const vitalCollection = startVitalCollection(lifeCycle, pageStateHistory, customVitalsState);\n    const internalContext = startInternalContext(configuration.applicationId, session, viewHistory, actionContexts, urlContexts);\n    // Add Clean-up tasks for Profiler API.\n    cleanupTasks.push(() => profilerApi.stop());\n    return {\n        addAction,\n        addEvent,\n        addError,\n        addTiming,\n        addFeatureFlagEvaluation: featureFlagContexts.addFeatureFlagEvaluation,\n        startView,\n        setViewContext,\n        setViewContextProperty,\n        getViewContext,\n        setViewName,\n        lifeCycle,\n        viewHistory,\n        session,\n        stopSession: () => session.expire(),\n        getInternalContext: internalContext.get,\n        startDurationVital: vitalCollection.startDurationVital,\n        stopDurationVital: vitalCollection.stopDurationVital,\n        addDurationVital: vitalCollection.addDurationVital,\n        addOperationStepVital: vitalCollection.addOperationStepVital,\n        globalContext,\n        userContext,\n        accountContext,\n        telemetry,\n        stop: () => {\n            cleanupTasks.forEach((task) => task());\n        },\n        hooks,\n    };\n}\nexport function startRumEventCollection(lifeCycle, hooks, configuration, pageStateHistory, domMutationObservable, windowOpenObservable, reportError) {\n    const actionCollection = startActionCollection(lifeCycle, hooks, domMutationObservable, windowOpenObservable, configuration);\n    const eventCollection = startEventCollection(lifeCycle);\n    const displayContext = startDisplayContext(hooks, configuration);\n    const ciVisibilityContext = startCiVisibilityContext(configuration, hooks);\n    startSyntheticsContext(hooks);\n    startRumAssembly(configuration, lifeCycle, hooks, reportError);\n    return {\n        pageStateHistory,\n        addAction: actionCollection.addAction,\n        addEvent: eventCollection.addEvent,\n        actionContexts: actionCollection.actionContexts,\n        stop: () => {\n            actionCollection.stop();\n            ciVisibilityContext.stop();\n            displayContext.stop();\n            pageStateHistory.stop();\n        },\n    };\n}\n//# sourceMappingURL=startRum.js.map","import { INTAKE_SITE_STAGING, INTAKE_SITE_US1, INTAKE_SITE_EU1 } from '@datadog/browser-core';\nexport function getSessionReplayUrl(configuration, { session, viewContext, errorType, }) {\n    const sessionId = session ? session.id : 'no-session-id';\n    const parameters = [];\n    if (errorType !== undefined) {\n        parameters.push(`error-type=${errorType}`);\n    }\n    if (viewContext) {\n        parameters.push(`seed=${viewContext.id}`);\n        parameters.push(`from=${viewContext.startClocks.timeStamp}`);\n    }\n    const origin = getDatadogSiteUrl(configuration);\n    const path = `/rum/replay/sessions/${sessionId}`;\n    return `${origin}${path}?${parameters.join('&')}`;\n}\nexport function getDatadogSiteUrl(rumConfiguration) {\n    const site = rumConfiguration.site;\n    const subdomain = rumConfiguration.subdomain || getSiteDefaultSubdomain(rumConfiguration);\n    return `https://${subdomain ? `${subdomain}.` : ''}${site}`;\n}\nfunction getSiteDefaultSubdomain(configuration) {\n    switch (configuration.site) {\n        case INTAKE_SITE_US1:\n        case INTAKE_SITE_EU1:\n            return 'app';\n        case INTAKE_SITE_STAGING:\n            return 'dd';\n        default:\n            return undefined;\n    }\n}\n//# sourceMappingURL=getSessionReplayUrl.js.map","export const MAX_STATS_HISTORY = 1000;\nlet statsPerView;\nexport function getSegmentsCount(viewId) {\n    return getOrCreateReplayStats(viewId).segments_count;\n}\nexport function addSegment(viewId) {\n    getOrCreateReplayStats(viewId).segments_count += 1;\n}\nexport function addRecord(viewId) {\n    getOrCreateReplayStats(viewId).records_count += 1;\n}\nexport function addWroteData(viewId, additionalBytesCount) {\n    getOrCreateReplayStats(viewId).segments_total_raw_size += additionalBytesCount;\n}\nexport function getReplayStats(viewId) {\n    return statsPerView === null || statsPerView === void 0 ? void 0 : statsPerView.get(viewId);\n}\nexport function resetReplayStats() {\n    statsPerView = undefined;\n}\nfunction getOrCreateReplayStats(viewId) {\n    if (!statsPerView) {\n        statsPerView = new Map();\n    }\n    let replayStats;\n    if (statsPerView.has(viewId)) {\n        replayStats = statsPerView.get(viewId);\n    }\n    else {\n        replayStats = {\n            records_count: 0,\n            segments_count: 0,\n            segments_total_raw_size: 0,\n        };\n        statsPerView.set(viewId, replayStats);\n        if (statsPerView.size > MAX_STATS_HISTORY) {\n            deleteOldestStats();\n        }\n    }\n    return replayStats;\n}\nfunction deleteOldestStats() {\n    if (!statsPerView) {\n        return;\n    }\n    const toDelete = statsPerView.keys().next().value;\n    if (toDelete) {\n        statsPerView.delete(toDelete);\n    }\n}\n//# sourceMappingURL=replayStats.js.map","import { addEventListener, concatBuffers } from '@datadog/browser-core';\nexport function createDeflateEncoder(configuration, worker, streamId) {\n    let rawBytesCount = 0;\n    let compressedData = [];\n    let compressedDataTrailer;\n    let isEmpty = true;\n    let nextWriteActionId = 0;\n    const pendingWriteActions = [];\n    const { stop: removeMessageListener } = addEventListener(configuration, worker, 'message', ({ data: workerResponse }) => {\n        if (workerResponse.type !== 'wrote' || workerResponse.streamId !== streamId) {\n            return;\n        }\n        const nextPendingAction = pendingWriteActions[0];\n        if (nextPendingAction) {\n            if (nextPendingAction.id === workerResponse.id) {\n                pendingWriteActions.shift();\n                rawBytesCount += workerResponse.additionalBytesCount;\n                compressedData.push(workerResponse.result);\n                compressedDataTrailer = workerResponse.trailer;\n                if (nextPendingAction.writeCallback) {\n                    nextPendingAction.writeCallback(workerResponse.result.byteLength);\n                }\n                else if (nextPendingAction.finishCallback) {\n                    nextPendingAction.finishCallback();\n                }\n            }\n            else if (nextPendingAction.id < workerResponse.id) {\n                // Worker responses received out of order\n                removeMessageListener();\n            }\n        }\n    });\n    function consumeResult() {\n        const output = compressedData.length === 0 ? new Uint8Array(0) : concatBuffers(compressedData.concat(compressedDataTrailer));\n        const result = {\n            rawBytesCount,\n            output,\n            outputBytesCount: output.byteLength,\n            encoding: 'deflate',\n        };\n        rawBytesCount = 0;\n        compressedData = [];\n        return result;\n    }\n    function sendResetIfNeeded() {\n        if (!isEmpty) {\n            worker.postMessage({\n                action: 'reset',\n                streamId,\n            });\n            isEmpty = true;\n        }\n    }\n    return {\n        isAsync: true,\n        get isEmpty() {\n            return isEmpty;\n        },\n        write(data, callback) {\n            worker.postMessage({\n                action: 'write',\n                id: nextWriteActionId,\n                data,\n                streamId,\n            });\n            pendingWriteActions.push({\n                id: nextWriteActionId,\n                writeCallback: callback,\n                data,\n            });\n            isEmpty = false;\n            nextWriteActionId += 1;\n        },\n        finish(callback) {\n            sendResetIfNeeded();\n            if (!pendingWriteActions.length) {\n                callback(consumeResult());\n            }\n            else {\n                // Make sure we do not call any write callback\n                pendingWriteActions.forEach((pendingWriteAction) => {\n                    delete pendingWriteAction.writeCallback;\n                });\n                // Wait for the last action to finish before calling the finish callback\n                pendingWriteActions[pendingWriteActions.length - 1].finishCallback = () => callback(consumeResult());\n            }\n        },\n        finishSync() {\n            sendResetIfNeeded();\n            const pendingData = pendingWriteActions.map((pendingWriteAction) => pendingWriteAction.data).join('');\n            // Ignore all pending write actions responses from the worker\n            pendingWriteActions.length = 0;\n            return { ...consumeResult(), pendingData };\n        },\n        estimateEncodedBytesCount(data) {\n            // This is a rough estimation of the data size once it'll be encoded by deflate. We observed\n            // that if it's the first chunk of data pushed to the stream, the ratio is lower (3-4), but\n            // after that the ratio is greater (10+). We chose 8 here, which (on average) seems to produce\n            // requests of the expected size.\n            return data.length / 8;\n        },\n        stop() {\n            removeMessageListener();\n        },\n    };\n}\n//# sourceMappingURL=deflateEncoder.js.map","import { addTelemetryError, display, DOCS_ORIGIN } from '@datadog/browser-core';\nexport function reportScriptLoadingError({ configuredUrl, error, source, scriptType, }) {\n    display.error(`${source} failed to start: an error occurred while initializing the ${scriptType}:`, error);\n    if (error instanceof Event || (error instanceof Error && isMessageCspRelated(error.message))) {\n        let baseMessage;\n        if (configuredUrl) {\n            baseMessage = `Please make sure the ${scriptType} URL ${configuredUrl} is correct and CSP is correctly configured.`;\n        }\n        else {\n            baseMessage = 'Please make sure CSP is correctly configured.';\n        }\n        display.error(`${baseMessage} See documentation at ${DOCS_ORIGIN}/integrations/content_security_policy_logs/#use-csp-with-real-user-monitoring-and-session-replay`);\n    }\n    else if (scriptType === 'worker') {\n        addTelemetryError(error);\n    }\n}\nfunction isMessageCspRelated(message) {\n    return (message.includes('Content Security Policy') ||\n        // Related to `require-trusted-types-for` CSP: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/require-trusted-types-for\n        message.includes(\"requires 'TrustedScriptURL'\"));\n}\n//# sourceMappingURL=scriptLoadingError.js.map","import { addTelemetryError, display, addEventListener, setTimeout, ONE_SECOND } from '@datadog/browser-core';\nimport { reportScriptLoadingError } from '../scriptLoadingError';\nexport const INITIALIZATION_TIME_OUT_DELAY = 30 * ONE_SECOND;\nfunction createDeflateWorker(configuration) {\n    return new Worker(configuration.workerUrl || URL.createObjectURL(new Blob([\"(()=>{function t(t){if(1===t.length)return t[0];const e=t.reduce((t,e)=>t+e.length,0),a=new Uint8Array(e);let n=0;for(const e of t)a.set(e,n),n+=e.length;return a}function e(t){for(var e=t.length;--e>=0;)t[e]=0}var a=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),n=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),r=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),i=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=Array(576);e(s);var h=Array(60);e(h);var l=Array(512);e(l);var _=Array(256);e(_);var o=Array(29);e(o);var d,u,f,c=Array(30);function p(t,e,a,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=a,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function g(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}e(c);var v=function(t){return t<256?l[t]:l[256+(t>>>7)]},w=function(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},m=function(t,e,a){t.bi_valid>16-a?(t.bi_buf|=e<<t.bi_valid&65535,w(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=a-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=a)},b=function(t,e,a){m(t,a[2*e],a[2*e+1])},y=function(t,e){var a=0;do{a|=1&t,t>>>=1,a<<=1}while(--e>0);return a>>>1},z=function(t,e,a){var n,r,i=Array(16),s=0;for(n=1;n<=15;n++)i[n]=s=s+a[n-1]<<1;for(r=0;r<=e;r++){var h=t[2*r+1];0!==h&&(t[2*r]=y(i[h]++,h))}},k=function(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},x=function(t){t.bi_valid>8?w(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},A=function(t,e,a,n){var r=2*e,i=2*a;return t[r]<t[i]||t[r]===t[i]&&n[e]<=n[a]},U=function(t,e,a){for(var n=t.heap[a],r=a<<1;r<=t.heap_len&&(r<t.heap_len&&A(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!A(e,n,t.heap[r],t.depth));)t.heap[a]=t.heap[r],a=r,r<<=1;t.heap[a]=n},B=function(t,e,r){var i,s,h,l,d=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*d]<<8|t.pending_buf[t.d_buf+2*d+1],s=t.pending_buf[t.l_buf+d],d++,0===i?b(t,s,e):(h=_[s],b(t,h+256+1,e),0!==(l=a[h])&&(s-=o[h],m(t,s,l)),i--,h=v(i),b(t,h,r),0!==(l=n[h])&&(i-=c[h],m(t,i,l)))}while(d<t.last_lit);b(t,256,e)},I=function(t,e){var a,n,r,i=e.dyn_tree,s=e.stat_desc.static_tree,h=e.stat_desc.has_stree,l=e.stat_desc.elems,_=-1;for(t.heap_len=0,t.heap_max=573,a=0;a<l;a++)0!==i[2*a]?(t.heap[++t.heap_len]=_=a,t.depth[a]=0):i[2*a+1]=0;for(;t.heap_len<2;)i[2*(r=t.heap[++t.heap_len]=_<2?++_:0)]=1,t.depth[r]=0,t.opt_len--,h&&(t.static_len-=s[2*r+1]);for(e.max_code=_,a=t.heap_len>>1;a>=1;a--)U(t,i,a);r=l;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],U(t,i,1),n=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=n,i[2*r]=i[2*a]+i[2*n],t.depth[r]=(t.depth[a]>=t.depth[n]?t.depth[a]:t.depth[n])+1,i[2*a+1]=i[2*n+1]=r,t.heap[1]=r++,U(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var a,n,r,i,s,h,l=e.dyn_tree,_=e.max_code,o=e.stat_desc.static_tree,d=e.stat_desc.has_stree,u=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,c=e.stat_desc.max_length,p=0;for(i=0;i<=15;i++)t.bl_count[i]=0;for(l[2*t.heap[t.heap_max]+1]=0,a=t.heap_max+1;a<573;a++)(i=l[2*l[2*(n=t.heap[a])+1]+1]+1)>c&&(i=c,p++),l[2*n+1]=i,n>_||(t.bl_count[i]++,s=0,n>=f&&(s=u[n-f]),h=l[2*n],t.opt_len+=h*(i+s),d&&(t.static_len+=h*(o[2*n+1]+s)));if(0!==p){do{for(i=c-1;0===t.bl_count[i];)i--;t.bl_count[i]--,t.bl_count[i+1]+=2,t.bl_count[c]--,p-=2}while(p>0);for(i=c;0!==i;i--)for(n=t.bl_count[i];0!==n;)(r=t.heap[--a])>_||(l[2*r+1]!==i&&(t.opt_len+=(i-l[2*r+1])*l[2*r],l[2*r+1]=i),n--)}}(t,e),z(i,_,t.bl_count)},E=function(t,e,a){var n,r,i=-1,s=e[1],h=0,l=7,_=4;for(0===s&&(l=138,_=3),e[2*(a+1)+1]=65535,n=0;n<=a;n++)r=s,s=e[2*(n+1)+1],++h<l&&r===s||(h<_?t.bl_tree[2*r]+=h:0!==r?(r!==i&&t.bl_tree[2*r]++,t.bl_tree[32]++):h<=10?t.bl_tree[34]++:t.bl_tree[36]++,h=0,i=r,0===s?(l=138,_=3):r===s?(l=6,_=3):(l=7,_=4))},C=function(t,e,a){var n,r,i=-1,s=e[1],h=0,l=7,_=4;for(0===s&&(l=138,_=3),n=0;n<=a;n++)if(r=s,s=e[2*(n+1)+1],!(++h<l&&r===s)){if(h<_)do{b(t,r,t.bl_tree)}while(0!==--h);else 0!==r?(r!==i&&(b(t,r,t.bl_tree),h--),b(t,16,t.bl_tree),m(t,h-3,2)):h<=10?(b(t,17,t.bl_tree),m(t,h-3,3)):(b(t,18,t.bl_tree),m(t,h-11,7));h=0,i=r,0===s?(l=138,_=3):r===s?(l=6,_=3):(l=7,_=4)}},D=!1,M=function(t,e,a,n){m(t,0+(n?1:0),3),function(t,e,a){x(t),w(t,a),w(t,~a),t.pending_buf.set(t.window.subarray(e,e+a),t.pending),t.pending+=a}(t,e,a)},j=M,L=function(t,e,a,n){for(var r=65535&t,i=t>>>16&65535,s=0;0!==a;){a-=s=a>2e3?2e3:a;do{i=i+(r=r+e[n++]|0)|0}while(--s);r%=65521,i%=65521}return r|i<<16},S=new Uint32Array(function(){for(var t,e=[],a=0;a<256;a++){t=a;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[a]=t}return e}()),T=function(t,e,a,n){var r=S,i=n+a;t^=-1;for(var s=n;s<i;s++)t=t>>>8^r[255&(t^e[s])];return-1^t},O={2:\\\"need dictionary\\\",1:\\\"stream end\\\",0:\\\"\\\",\\\"-1\\\":\\\"file error\\\",\\\"-2\\\":\\\"stream error\\\",\\\"-3\\\":\\\"data error\\\",\\\"-4\\\":\\\"insufficient memory\\\",\\\"-5\\\":\\\"buffer error\\\",\\\"-6\\\":\\\"incompatible version\\\"},q=j,F=function(t,e,a){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&a,t.last_lit++,0===e?t.dyn_ltree[2*a]++:(t.matches++,e--,t.dyn_ltree[2*(_[a]+256+1)]++,t.dyn_dtree[2*v(e)]++),t.last_lit===t.lit_bufsize-1},G=-2,H=258,J=262,K=103,N=113,P=666,Q=function(t,e){return t.msg=O[e],e},R=function(t){return(t<<1)-(t>4?9:0)},V=function(t){for(var e=t.length;--e>=0;)t[e]=0},W=function(t,e,a){return(e<<t.hash_shift^a)&t.hash_mask},X=function(t){var e=t.state,a=e.pending;a>t.avail_out&&(a=t.avail_out),0!==a&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+a),t.next_out),t.next_out+=a,e.pending_out+=a,t.total_out+=a,t.avail_out-=a,e.pending-=a,0===e.pending&&(e.pending_out=0))},Y=function(t,e){(function(t,e,a,n){var r,l,_=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,a=4093624447;for(e=0;e<=31;e++,a>>>=1)if(1&a&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),I(t,t.l_desc),I(t,t.d_desc),_=function(t){var e;for(E(t,t.dyn_ltree,t.l_desc.max_code),E(t,t.dyn_dtree,t.d_desc.max_code),I(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*i[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(l=t.static_len+3+7>>>3)<=r&&(r=l)):r=l=a+5,a+4<=r&&-1!==e?M(t,e,a,n):4===t.strategy||l===r?(m(t,2+(n?1:0),3),B(t,s,h)):(m(t,4+(n?1:0),3),function(t,e,a,n){var r;for(m(t,e-257,5),m(t,a-1,5),m(t,n-4,4),r=0;r<n;r++)m(t,t.bl_tree[2*i[r]+1],3);C(t,t.dyn_ltree,e-1),C(t,t.dyn_dtree,a-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,_+1),B(t,t.dyn_ltree,t.dyn_dtree)),k(t),n&&x(t)})(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,X(t.strm)},Z=function(t,e){t.pending_buf[t.pending++]=e},$=function(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},tt=function(t,e,a,n){var r=t.avail_in;return r>n&&(r=n),0===r?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),a),1===t.state.wrap?t.adler=L(t.adler,e,r,a):2===t.state.wrap&&(t.adler=T(t.adler,e,r,a)),t.next_in+=r,t.total_in+=r,r)},et=function(t,e){var a,n,r=t.max_chain_length,i=t.strstart,s=t.prev_length,h=t.nice_match,l=t.strstart>t.w_size-J?t.strstart-(t.w_size-J):0,_=t.window,o=t.w_mask,d=t.prev,u=t.strstart+H,f=_[i+s-1],c=_[i+s];t.prev_length>=t.good_match&&(r>>=2),h>t.lookahead&&(h=t.lookahead);do{if(_[(a=e)+s]===c&&_[a+s-1]===f&&_[a]===_[i]&&_[++a]===_[i+1]){i+=2,a++;do{}while(_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&i<u);if(n=H-(u-i),i=u-H,n>s){if(t.match_start=e,s=n,n>=h)break;f=_[i+s-1],c=_[i+s]}}}while((e=d[e&o])>l&&0!==--r);return s<=t.lookahead?s:t.lookahead},at=function(t){var e,a,n,r,i,s=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-J)){t.window.set(t.window.subarray(s,s+s),0),t.match_start-=s,t.strstart-=s,t.block_start-=s,e=a=t.hash_size;do{n=t.head[--e],t.head[e]=n>=s?n-s:0}while(--a);e=a=s;do{n=t.prev[--e],t.prev[e]=n>=s?n-s:0}while(--a);r+=s}if(0===t.strm.avail_in)break;if(a=tt(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=a,t.lookahead+t.insert>=3)for(i=t.strstart-t.insert,t.ins_h=t.window[i],t.ins_h=W(t,t.ins_h,t.window[i+1]);t.insert&&(t.ins_h=W(t,t.ins_h,t.window[i+3-1]),t.prev[i&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=i,i++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<J&&0!==t.strm.avail_in)},nt=function(t,e){for(var a,n;;){if(t.lookahead<J){if(at(t),t.lookahead<J&&0===e)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=W(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==a&&t.strstart-a<=t.w_size-J&&(t.match_length=et(t,a)),t.match_length>=3)if(n=F(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=W(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=W(t,t.ins_h,t.window[t.strstart+1]);else n=F(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Y(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(Y(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Y(t,!1),0===t.strm.avail_out)?1:2},rt=function(t,e){for(var a,n,r;;){if(t.lookahead<J){if(at(t),t.lookahead<J&&0===e)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=W(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==a&&t.prev_length<t.max_lazy_match&&t.strstart-a<=t.w_size-J&&(t.match_length=et(t,a),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=F(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=W(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(Y(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=F(t,0,t.window[t.strstart-1]))&&Y(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=F(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(Y(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Y(t,!1),0===t.strm.avail_out)?1:2};function it(t,e,a,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=a,this.max_chain=n,this.func=r}var st=[new it(0,0,0,0,function(t,e){var a=65535;for(a>t.pending_buf_size-5&&(a=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+a;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,Y(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-J&&(Y(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(Y(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(Y(t,!1),t.strm.avail_out),1)}),new it(4,4,8,4,nt),new it(4,5,16,8,nt),new it(4,6,32,32,nt),new it(4,4,16,16,rt),new it(8,16,32,32,rt),new it(8,16,128,128,rt),new it(8,32,128,256,rt),new it(32,128,258,1024,rt),new it(32,258,258,4096,rt)];function ht(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}for(var lt=function(t){var e,i=function(t){if(!t||!t.state)return Q(t,G);t.total_in=t.total_out=0,t.data_type=2;var e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:N,t.adler=2===e.wrap?0:1,e.last_flush=0,function(t){D||(function(){var t,e,i,g,v,w=Array(16);for(i=0,g=0;g<28;g++)for(o[g]=i,t=0;t<1<<a[g];t++)_[i++]=g;for(_[i-1]=g,v=0,g=0;g<16;g++)for(c[g]=v,t=0;t<1<<n[g];t++)l[v++]=g;for(v>>=7;g<30;g++)for(c[g]=v<<7,t=0;t<1<<n[g]-7;t++)l[256+v++]=g;for(e=0;e<=15;e++)w[e]=0;for(t=0;t<=143;)s[2*t+1]=8,t++,w[8]++;for(;t<=255;)s[2*t+1]=9,t++,w[9]++;for(;t<=279;)s[2*t+1]=7,t++,w[7]++;for(;t<=287;)s[2*t+1]=8,t++,w[8]++;for(z(s,287,w),t=0;t<30;t++)h[2*t+1]=5,h[2*t]=y(t,5);d=new p(s,a,257,286,15),u=new p(h,n,0,30,15),f=new p([],r,0,19,7)}(),D=!0),t.l_desc=new g(t.dyn_ltree,d),t.d_desc=new g(t.dyn_dtree,u),t.bl_desc=new g(t.bl_tree,f),t.bi_buf=0,t.bi_valid=0,k(t)}(e),0}(t);return 0===i&&((e=t.state).window_size=2*e.w_size,V(e.head),e.max_lazy_match=st[e.level].max_lazy,e.good_match=st[e.level].good_length,e.nice_match=st[e.level].nice_length,e.max_chain_length=st[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),i},_t=function(t,e){var a,n;if(!t||!t.state||e>5||e<0)return t?Q(t,G):G;var r=t.state;if(!t.output||!t.input&&0!==t.avail_in||r.status===P&&4!==e)return Q(t,0===t.avail_out?-5:G);r.strm=t;var i=r.last_flush;if(r.last_flush=e,42===r.status)if(2===r.wrap)t.adler=0,Z(r,31),Z(r,139),Z(r,8),r.gzhead?(Z(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Z(r,255&r.gzhead.time),Z(r,r.gzhead.time>>8&255),Z(r,r.gzhead.time>>16&255),Z(r,r.gzhead.time>>24&255),Z(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),Z(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Z(r,255&r.gzhead.extra.length),Z(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=T(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Z(r,0),Z(r,0),Z(r,0),Z(r,0),Z(r,0),Z(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),Z(r,3),r.status=N);else{var h=8+(r.w_bits-8<<4)<<8;h|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(h|=32),h+=31-h%31,r.status=N,$(r,h),0!==r.strstart&&($(r,t.adler>>>16),$(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),X(t),a=r.pending,r.pending!==r.pending_buf_size));)Z(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),X(t),a=r.pending,r.pending===r.pending_buf_size)){n=1;break}n=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Z(r,n)}while(0!==n);r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),0===n&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),X(t),a=r.pending,r.pending===r.pending_buf_size)){n=1;break}n=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Z(r,n)}while(0!==n);r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),0===n&&(r.status=K)}else r.status=K;if(r.status===K&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&X(t),r.pending+2<=r.pending_buf_size&&(Z(r,255&t.adler),Z(r,t.adler>>8&255),t.adler=0,r.status=N)):r.status=N),0!==r.pending){if(X(t),0===t.avail_out)return r.last_flush=-1,0}else if(0===t.avail_in&&R(e)<=R(i)&&4!==e)return Q(t,-5);if(r.status===P&&0!==t.avail_in)return Q(t,-5);if(0!==t.avail_in||0!==r.lookahead||0!==e&&r.status!==P){var l=2===r.strategy?function(t,e){for(var a;;){if(0===t.lookahead&&(at(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,a=F(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,a&&(Y(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(Y(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Y(t,!1),0===t.strm.avail_out)?1:2}(r,e):3===r.strategy?function(t,e){for(var a,n,r,i,s=t.window;;){if(t.lookahead<=H){if(at(t),t.lookahead<=H&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=s[r=t.strstart-1])===s[++r]&&n===s[++r]&&n===s[++r]){i=t.strstart+H;do{}while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<i);t.match_length=H-(i-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(a=F(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(a=F(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),a&&(Y(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(Y(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Y(t,!1),0===t.strm.avail_out)?1:2}(r,e):st[r.level].func(r,e);if(3!==l&&4!==l||(r.status=P),1===l||3===l)return 0===t.avail_out&&(r.last_flush=-1),0;if(2===l&&(1===e?function(t){m(t,2,3),b(t,256,s),function(t){16===t.bi_valid?(w(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}(r):5!==e&&(q(r,0,0,!1),3===e&&(V(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),X(t),0===t.avail_out))return r.last_flush=-1,0}return 4!==e?0:r.wrap<=0?1:(2===r.wrap?(Z(r,255&t.adler),Z(r,t.adler>>8&255),Z(r,t.adler>>16&255),Z(r,t.adler>>24&255),Z(r,255&t.total_in),Z(r,t.total_in>>8&255),Z(r,t.total_in>>16&255),Z(r,t.total_in>>24&255)):($(r,t.adler>>>16),$(r,65535&t.adler)),X(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},ot=function(t){if(!t||!t.state)return G;var e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&e!==K&&e!==N&&e!==P?Q(t,G):(t.state=null,e===N?Q(t,-3):0)},dt=new Uint8Array(256),ut=0;ut<256;ut++)dt[ut]=ut>=252?6:ut>=248?5:ut>=240?4:ut>=224?3:ut>=192?2:1;dt[254]=dt[254]=1;var ft=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=\\\"\\\",this.state=null,this.data_type=2,this.adler=0},ct=Object.prototype.toString;function pt(){this.options={level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0};var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg=\\\"\\\",this.ended=!1,this.chunks=[],this.strm=new ft,this.strm.avail_out=0;var e,a,n=function(t,e,a,n,r,i){if(!t)return G;var s=1;if(-1===e&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),r<1||r>9||8!==a||n<8||n>15||e<0||e>9||i<0||i>4)return Q(t,G);8===n&&(n=9);var h=new ht;return t.state=h,h.strm=t,h.wrap=s,h.gzhead=null,h.w_bits=n,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=r+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+3-1)/3),h.window=new Uint8Array(2*h.w_size),h.head=new Uint16Array(h.hash_size),h.prev=new Uint16Array(h.w_size),h.lit_bufsize=1<<r+6,h.pending_buf_size=4*h.lit_bufsize,h.pending_buf=new Uint8Array(h.pending_buf_size),h.d_buf=1*h.lit_bufsize,h.l_buf=3*h.lit_bufsize,h.level=e,h.strategy=i,h.method=a,lt(t)}(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw Error(O[n]);if(t.header&&(e=this.strm,a=t.header,e&&e.state&&(2!==e.state.wrap||(e.state.gzhead=a))),t.dictionary){var r;if(r=\\\"[object ArrayBuffer]\\\"===ct.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=function(t,e){var a=e.length;if(!t||!t.state)return G;var n=t.state,r=n.wrap;if(2===r||1===r&&42!==n.status||n.lookahead)return G;if(1===r&&(t.adler=L(t.adler,e,a,0)),n.wrap=0,a>=n.w_size){0===r&&(V(n.head),n.strstart=0,n.block_start=0,n.insert=0);var i=new Uint8Array(n.w_size);i.set(e.subarray(a-n.w_size,a),0),e=i,a=n.w_size}var s=t.avail_in,h=t.next_in,l=t.input;for(t.avail_in=a,t.next_in=0,t.input=e,at(n);n.lookahead>=3;){var _=n.strstart,o=n.lookahead-2;do{n.ins_h=W(n,n.ins_h,n.window[_+3-1]),n.prev[_&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=_,_++}while(--o);n.strstart=_,n.lookahead=2,at(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=h,t.input=l,t.avail_in=s,n.wrap=r,0}(this.strm,r)))throw Error(O[n]);this._dict_set=!0}}function gt(t,e,a){try{t.postMessage({type:\\\"errored\\\",error:e,streamId:a})}catch(n){t.postMessage({type:\\\"errored\\\",error:e+\\\"\\\",streamId:a})}}function vt(t){const e=t.strm.adler;return new Uint8Array([3,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e])}pt.prototype.push=function(t,e){var a,n,r=this.strm,i=this.options.chunkSize;if(this.ended)return!1;for(n=e===~~e?e:!0===e?4:0,\\\"[object ArrayBuffer]\\\"===ct.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),(2===n||3===n)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(1===(a=_t(r,n)))return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=ot(this.strm),this.onEnd(a),this.ended=!0,0===a;if(0!==r.avail_out){if(n>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},pt.prototype.onData=function(t){this.chunks.push(t)},pt.prototype.onEnd=function(t){0===t&&(this.result=function(t){for(var e=0,a=0,n=t.length;a<n;a++)e+=t[a].length;for(var r=new Uint8Array(e),i=0,s=0,h=t.length;i<h;i++){var l=t[i];r.set(l,s),s+=l.length}return r}(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},function(e=self){try{const a=new Map;e.addEventListener(\\\"message\\\",n=>{try{const r=function(e,a){switch(a.action){case\\\"init\\\":return{type:\\\"initialized\\\",version:\\\"6.24.1\\\"};case\\\"write\\\":{let n=e.get(a.streamId);n||(n=new pt,e.set(a.streamId,n));const r=n.chunks.length,i=function(t){if(\\\"function\\\"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,a,n,r,i,s=t.length,h=0;for(r=0;r<s;r++)a=t.charCodeAt(r),55296==(64512&a)&&r+1<s&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(a=65536+(a-55296<<10)+(n-56320),r++)),h+=a<128?1:a<2048?2:a<65536?3:4;for(e=new Uint8Array(h),i=0,r=0;i<h;r++)a=t.charCodeAt(r),55296==(64512&a)&&r+1<s&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(a=65536+(a-55296<<10)+(n-56320),r++)),a<128?e[i++]=a:a<2048?(e[i++]=192|a>>>6,e[i++]=128|63&a):a<65536?(e[i++]=224|a>>>12,e[i++]=128|a>>>6&63,e[i++]=128|63&a):(e[i++]=240|a>>>18,e[i++]=128|a>>>12&63,e[i++]=128|a>>>6&63,e[i++]=128|63&a);return e}(a.data);return n.push(i,2),{type:\\\"wrote\\\",id:a.id,streamId:a.streamId,result:t(n.chunks.slice(r)),trailer:vt(n),additionalBytesCount:i.length}}case\\\"reset\\\":e.delete(a.streamId)}}(a,n.data);r&&e.postMessage(r)}catch(t){gt(e,t,n.data&&\\\"streamId\\\"in n.data?n.data.streamId:void 0)}})}catch(t){gt(e,t)}}()})();\"])));\n}\nlet state = { status: 0 /* DeflateWorkerStatus.Nil */ };\nexport function startDeflateWorker(configuration, source, onInitializationFailure, createDeflateWorkerImpl = createDeflateWorker) {\n    if (state.status === 0 /* DeflateWorkerStatus.Nil */) {\n        // doStartDeflateWorker updates the state to \"loading\" or \"error\"\n        doStartDeflateWorker(configuration, source, createDeflateWorkerImpl);\n    }\n    switch (state.status) {\n        case 1 /* DeflateWorkerStatus.Loading */:\n            state.initializationFailureCallbacks.push(onInitializationFailure);\n            return state.worker;\n        case 3 /* DeflateWorkerStatus.Initialized */:\n            return state.worker;\n    }\n}\nexport function resetDeflateWorkerState() {\n    if (state.status === 3 /* DeflateWorkerStatus.Initialized */ || state.status === 1 /* DeflateWorkerStatus.Loading */) {\n        state.stop();\n    }\n    state = { status: 0 /* DeflateWorkerStatus.Nil */ };\n}\nexport function getDeflateWorkerStatus() {\n    return state.status;\n}\n/**\n * Starts the deflate worker and handle messages and errors\n *\n * The spec allow browsers to handle worker errors differently:\n * - Chromium throws an exception\n * - Firefox fires an error event\n *\n * more details: https://bugzilla.mozilla.org/show_bug.cgi?id=1736865#c2\n */\nexport function doStartDeflateWorker(configuration, source, createDeflateWorkerImpl = createDeflateWorker) {\n    try {\n        const worker = createDeflateWorkerImpl(configuration);\n        const { stop: removeErrorListener } = addEventListener(configuration, worker, 'error', (error) => {\n            onError(configuration, source, error);\n        });\n        const { stop: removeMessageListener } = addEventListener(configuration, worker, 'message', ({ data }) => {\n            if (data.type === 'errored') {\n                onError(configuration, source, data.error, data.streamId);\n            }\n            else if (data.type === 'initialized') {\n                onInitialized(data.version);\n            }\n        });\n        worker.postMessage({ action: 'init' });\n        setTimeout(() => onTimeout(source), INITIALIZATION_TIME_OUT_DELAY);\n        const stop = () => {\n            removeErrorListener();\n            removeMessageListener();\n        };\n        state = { status: 1 /* DeflateWorkerStatus.Loading */, worker, stop, initializationFailureCallbacks: [] };\n    }\n    catch (error) {\n        onError(configuration, source, error);\n    }\n}\nfunction onTimeout(source) {\n    if (state.status === 1 /* DeflateWorkerStatus.Loading */) {\n        display.error(`${source} failed to start: a timeout occurred while initializing the Worker`);\n        state.initializationFailureCallbacks.forEach((callback) => callback());\n        state = { status: 2 /* DeflateWorkerStatus.Error */ };\n    }\n}\nfunction onInitialized(version) {\n    if (state.status === 1 /* DeflateWorkerStatus.Loading */) {\n        state = { status: 3 /* DeflateWorkerStatus.Initialized */, worker: state.worker, stop: state.stop, version };\n    }\n}\nfunction onError(configuration, source, error, streamId) {\n    if (state.status === 1 /* DeflateWorkerStatus.Loading */ || state.status === 0 /* DeflateWorkerStatus.Nil */) {\n        reportScriptLoadingError({\n            configuredUrl: configuration.workerUrl,\n            error,\n            source,\n            scriptType: 'worker',\n        });\n        if (state.status === 1 /* DeflateWorkerStatus.Loading */) {\n            state.initializationFailureCallbacks.forEach((callback) => callback());\n        }\n        state = { status: 2 /* DeflateWorkerStatus.Error */ };\n    }\n    else {\n        addTelemetryError(error, {\n            worker_version: state.status === 3 /* DeflateWorkerStatus.Initialized */ && state.version,\n            stream_id: streamId,\n        });\n    }\n}\n//# sourceMappingURL=deflateWorker.js.map","/**\n * Test for Browser features used while recording\n */\nexport function isBrowserSupported() {\n    return (\n    // Array.from is a bit less supported by browsers than CSSSupportsRule, but has higher chances\n    // to be polyfilled. Test for both to be more confident. We could add more things if we find out\n    // this test is not sufficient.\n    typeof Array.from === 'function' &&\n        typeof CSSSupportsRule === 'function' &&\n        typeof URL.createObjectURL === 'function' &&\n        'forEach' in NodeList.prototype);\n}\n//# sourceMappingURL=isBrowserSupported.js.map","import { getSessionReplayUrl } from '@datadog/browser-rum-core';\nimport { isBrowserSupported } from '../boot/isBrowserSupported';\nexport function getSessionReplayLink(configuration, sessionManager, viewHistory, isRecordingStarted) {\n    const session = sessionManager.findTrackedSession();\n    const errorType = getErrorType(session, isRecordingStarted);\n    const viewContext = viewHistory.findView();\n    return getSessionReplayUrl(configuration, {\n        viewContext,\n        errorType,\n        session,\n    });\n}\nfunction getErrorType(session, isRecordingStarted) {\n    if (!isBrowserSupported()) {\n        return 'browser-not-supported';\n    }\n    if (!session) {\n        // possibilities:\n        // - rum sampled out\n        // - session expired (edge case)\n        return 'rum-not-tracked';\n    }\n    if (session.sessionReplay === 0 /* SessionReplayState.OFF */) {\n        // possibilities\n        // - replay sampled out\n        return 'incorrect-session-plan';\n    }\n    if (!isRecordingStarted) {\n        return 'replay-not-started';\n    }\n}\n//# sourceMappingURL=getSessionReplayLink.js.map","import { addTelemetryMetrics, noop, timeStampNow, elapsed } from '@datadog/browser-core';\nexport function startRecorderInitTelemetry(telemetry, observable) {\n    if (!telemetry.metricsEnabled) {\n        return { stop: noop };\n    }\n    let startContext;\n    let documentReadyDuration;\n    let recorderSettledDuration;\n    const { unsubscribe } = observable.subscribe((event) => {\n        switch (event.type) {\n            case 'start':\n                startContext = { forced: event.forced, timestamp: timeStampNow() };\n                documentReadyDuration = undefined;\n                recorderSettledDuration = undefined;\n                break;\n            case 'document-ready':\n                if (startContext) {\n                    documentReadyDuration = elapsed(startContext.timestamp, timeStampNow());\n                }\n                break;\n            case 'recorder-settled':\n                if (startContext) {\n                    recorderSettledDuration = elapsed(startContext.timestamp, timeStampNow());\n                }\n                break;\n            case 'aborted':\n            case 'deflate-encoder-load-failed':\n            case 'recorder-load-failed':\n            case 'succeeded':\n                // Only send metrics for the first attempt at starting the recorder.\n                unsubscribe();\n                if (startContext) {\n                    // monitor-until: 2026-07-01\n                    addTelemetryMetrics(\"Recorder init metrics\" /* TelemetryMetrics.RECORDER_INIT_METRICS_TELEMETRY_NAME */, {\n                        metrics: createRecorderInitMetrics(startContext.forced, recorderSettledDuration, elapsed(startContext.timestamp, timeStampNow()), event.type, documentReadyDuration),\n                    });\n                }\n                break;\n        }\n    });\n    return { stop: unsubscribe };\n}\nfunction createRecorderInitMetrics(forced, loadRecorderModuleDuration, recorderInitDuration, result, waitForDocReadyDuration) {\n    return {\n        forced,\n        loadRecorderModuleDuration,\n        recorderInitDuration,\n        result,\n        waitForDocReadyDuration,\n    };\n}\n//# sourceMappingURL=startRecorderInitTelemetry.js.map","import { asyncRunOnReadyState, monitorError, Observable } from '@datadog/browser-core';\nimport { getSessionReplayLink } from '../domain/getSessionReplayLink';\nimport { startRecorderInitTelemetry } from '../domain/startRecorderInitTelemetry';\nexport function createPostStartStrategy(configuration, lifeCycle, sessionManager, viewHistory, loadRecorder, getOrCreateDeflateEncoder, telemetry) {\n    let status = 0 /* RecorderStatus.Stopped */;\n    let stopRecording;\n    lifeCycle.subscribe(9 /* LifeCycleEventType.SESSION_EXPIRED */, () => {\n        if (status === 2 /* RecorderStatus.Starting */ || status === 3 /* RecorderStatus.Started */) {\n            stop();\n            status = 1 /* RecorderStatus.IntentToStart */;\n        }\n    });\n    lifeCycle.subscribe(10 /* LifeCycleEventType.SESSION_RENEWED */, () => {\n        if (status === 1 /* RecorderStatus.IntentToStart */) {\n            start();\n        }\n    });\n    const observable = new Observable();\n    startRecorderInitTelemetry(telemetry, observable);\n    const doStart = async (forced) => {\n        observable.notify({ type: 'start', forced });\n        const [startRecordingImpl] = await Promise.all([\n            notifyWhenSettled(observable, { type: 'recorder-settled' }, loadRecorder()),\n            notifyWhenSettled(observable, { type: 'document-ready' }, asyncRunOnReadyState(configuration, 'interactive')),\n        ]);\n        if (status !== 2 /* RecorderStatus.Starting */) {\n            observable.notify({ type: 'aborted' });\n            return;\n        }\n        if (!startRecordingImpl) {\n            status = 0 /* RecorderStatus.Stopped */;\n            observable.notify({ type: 'recorder-load-failed' });\n            return;\n        }\n        const deflateEncoder = getOrCreateDeflateEncoder();\n        if (!deflateEncoder) {\n            status = 0 /* RecorderStatus.Stopped */;\n            observable.notify({ type: 'deflate-encoder-load-failed' });\n            return;\n        }\n        ;\n        ({ stop: stopRecording } = startRecordingImpl(lifeCycle, configuration, sessionManager, viewHistory, deflateEncoder, telemetry));\n        status = 3 /* RecorderStatus.Started */;\n        observable.notify({ type: 'succeeded' });\n    };\n    function start(options) {\n        const session = sessionManager.findTrackedSession();\n        if (canStartRecording(session, options)) {\n            status = 1 /* RecorderStatus.IntentToStart */;\n            return;\n        }\n        if (isRecordingInProgress(status)) {\n            return;\n        }\n        status = 2 /* RecorderStatus.Starting */;\n        const forced = shouldForceReplay(session, options) || false;\n        // Intentionally not awaiting doStart() to keep it asynchronous\n        doStart(forced).catch(monitorError);\n        if (forced) {\n            sessionManager.setForcedReplay();\n        }\n    }\n    function stop() {\n        if (status === 3 /* RecorderStatus.Started */) {\n            stopRecording === null || stopRecording === void 0 ? void 0 : stopRecording();\n        }\n        status = 0 /* RecorderStatus.Stopped */;\n    }\n    return {\n        start,\n        stop,\n        getSessionReplayLink() {\n            return getSessionReplayLink(configuration, sessionManager, viewHistory, status !== 0 /* RecorderStatus.Stopped */);\n        },\n        isRecording: () => status === 3 /* RecorderStatus.Started */,\n    };\n}\nfunction canStartRecording(session, options) {\n    return !session || (session.sessionReplay === 0 /* SessionReplayState.OFF */ && (!options || !options.force));\n}\nfunction isRecordingInProgress(status) {\n    return status === 2 /* RecorderStatus.Starting */ || status === 3 /* RecorderStatus.Started */;\n}\nfunction shouldForceReplay(session, options) {\n    return options && options.force && session.sessionReplay === 0 /* SessionReplayState.OFF */;\n}\nasync function notifyWhenSettled(observable, event, promise) {\n    try {\n        return await promise;\n    }\n    finally {\n        observable.notify(event);\n    }\n}\n//# sourceMappingURL=postStartStrategy.js.map","import { noop } from '@datadog/browser-core';\nexport function createPreStartStrategy() {\n    let status = 0 /* PreStartRecorderStatus.None */;\n    return {\n        strategy: {\n            start() {\n                status = 1 /* PreStartRecorderStatus.HadManualStart */;\n            },\n            stop() {\n                status = 2 /* PreStartRecorderStatus.HadManualStop */;\n            },\n            isRecording: () => false,\n            getSessionReplayLink: noop,\n        },\n        shouldStartImmediately(configuration) {\n            return (status === 1 /* PreStartRecorderStatus.HadManualStart */ ||\n                (status === 0 /* PreStartRecorderStatus.None */ && !configuration.startSessionReplayRecordingManually));\n        },\n    };\n}\n//# sourceMappingURL=preStartStrategy.js.map","import { canUseEventBridge, noop, bridgeSupports, } from '@datadog/browser-core';\nimport { getReplayStats as getReplayStatsImpl } from '../domain/replayStats';\nimport { createDeflateEncoder, getDeflateWorkerStatus, startDeflateWorker, } from '../domain/deflate';\nimport { isBrowserSupported } from './isBrowserSupported';\nimport { createPostStartStrategy } from './postStartStrategy';\nimport { createPreStartStrategy } from './preStartStrategy';\nexport function makeRecorderApi(loadRecorder, createDeflateWorkerImpl) {\n    if ((canUseEventBridge() && !bridgeSupports(\"records\" /* BridgeCapability.RECORDS */)) || !isBrowserSupported()) {\n        return {\n            start: noop,\n            stop: noop,\n            getReplayStats: () => undefined,\n            onRumStart: noop,\n            isRecording: () => false,\n            getSessionReplayLink: () => undefined,\n        };\n    }\n    // eslint-disable-next-line prefer-const\n    let { strategy, shouldStartImmediately } = createPreStartStrategy();\n    return {\n        start: (options) => strategy.start(options),\n        stop: () => strategy.stop(),\n        getSessionReplayLink: () => strategy.getSessionReplayLink(),\n        onRumStart,\n        isRecording: () => \n        // The worker is started optimistically, meaning we could have started to record but its\n        // initialization fails a bit later. This could happen when:\n        // * the worker URL (blob or plain URL) is blocked by CSP in Firefox only (Chromium and Safari\n        // throw an exception when instantiating the worker, and IE doesn't care about CSP)\n        // * the browser fails to load the worker in case the workerUrl is used\n        // * an unexpected error occurs in the Worker before initialization, ex:\n        //   * a runtime exception collected by monitor()\n        //   * a syntax error notified by the browser via an error event\n        // * the worker is unresponsive for some reason and timeouts\n        //\n        // It is not expected to happen often. Nonetheless, the \"replayable\" status on RUM events is\n        // an important part of the Datadog App:\n        // * If we have a false positive (we set has_replay: true even if no replay data is present),\n        // we might display broken links to the Session Replay player.\n        // * If we have a false negative (we don't set has_replay: true even if replay data is\n        // available), it is less noticeable because no link will be displayed.\n        //\n        // Thus, it is better to have false negative, so let's make sure the worker is correctly\n        // initialized before advertizing that we are recording.\n        //\n        // In the future, when the compression worker will also be used for RUM data, this will be\n        // less important since no RUM event will be sent when the worker fails to initialize.\n        getDeflateWorkerStatus() === 3 /* DeflateWorkerStatus.Initialized */ && strategy.isRecording(),\n        getReplayStats: (viewId) => getDeflateWorkerStatus() === 3 /* DeflateWorkerStatus.Initialized */ ? getReplayStatsImpl(viewId) : undefined,\n    };\n    function onRumStart(lifeCycle, configuration, sessionManager, viewHistory, worker, telemetry) {\n        let cachedDeflateEncoder;\n        function getOrCreateDeflateEncoder() {\n            if (!cachedDeflateEncoder) {\n                worker !== null && worker !== void 0 ? worker : (worker = startDeflateWorker(configuration, 'Datadog Session Replay', () => {\n                    strategy.stop();\n                }, createDeflateWorkerImpl));\n                if (worker) {\n                    cachedDeflateEncoder = createDeflateEncoder(configuration, worker, 1 /* DeflateEncoderStreamId.REPLAY */);\n                }\n            }\n            return cachedDeflateEncoder;\n        }\n        strategy = createPostStartStrategy(configuration, lifeCycle, sessionManager, viewHistory, loadRecorder, getOrCreateDeflateEncoder, telemetry);\n        if (shouldStartImmediately(configuration)) {\n            strategy.start();\n        }\n    }\n}\n//# sourceMappingURL=recorderApi.js.map","import { reportScriptLoadingError } from '../domain/scriptLoadingError';\nexport async function lazyLoadRecorder(importRecorderImpl = importRecorder) {\n    try {\n        return await importRecorderImpl();\n    }\n    catch (error) {\n        reportScriptLoadingError({\n            error,\n            source: 'Recorder',\n            scriptType: 'module',\n        });\n    }\n}\nasync function importRecorder() {\n    const module = await import(/* webpackChunkName: \"recorder\" */ './startRecording');\n    return module.startRecording;\n}\n//# sourceMappingURL=lazyLoadRecorder.js.map","import { getGlobalObject } from '@datadog/browser-core';\nexport function isProfilingSupported() {\n    const globalThis = getGlobalObject();\n    // This API might be unavailable in some browsers\n    const globalThisProfiler = globalThis.Profiler;\n    return globalThisProfiler !== undefined;\n}\n//# sourceMappingURL=profilingSupported.js.map","import { SKIPPED } from '@datadog/browser-core';\nimport { RumEventType } from '@datadog/browser-rum-core';\nexport const startProfilingContext = (hooks) => {\n    // Default status is `starting`.\n    let currentContext = {\n        status: 'starting',\n    };\n    // Register the assemble hook to add the profiling context to the event attributes.\n    hooks.register(0 /* HookNames.Assemble */, ({ eventType }) => {\n        if (eventType !== RumEventType.VIEW && eventType !== RumEventType.LONG_TASK) {\n            return SKIPPED;\n        }\n        return {\n            type: eventType,\n            _dd: {\n                profiling: currentContext,\n            },\n        };\n    });\n    return {\n        get: () => currentContext,\n        set: (newContext) => {\n            currentContext = newContext;\n        },\n    };\n};\n//# sourceMappingURL=profilingContext.js.map","import { reportScriptLoadingError } from '../domain/scriptLoadingError';\nexport async function lazyLoadProfiler(importProfilerImpl = importProfiler) {\n    try {\n        return await importProfilerImpl();\n    }\n    catch (error) {\n        reportScriptLoadingError({\n            error,\n            source: 'Profiler',\n            scriptType: 'module',\n        });\n    }\n}\nasync function importProfiler() {\n    const module = await import(/* webpackChunkName: \"profiler\" */ '../domain/profiling/profiler');\n    return module.createRumProfiler;\n}\n//# sourceMappingURL=lazyLoadProfiler.js.map","import { isSampled } from '@datadog/browser-rum-core';\nimport { addTelemetryDebug, monitorError } from '@datadog/browser-core';\nimport { isProfilingSupported } from '../domain/profiling/profilingSupported';\nimport { startProfilingContext } from '../domain/profiling/profilingContext';\nimport { lazyLoadProfiler } from './lazyLoadProfiler';\nexport function makeProfilerApi() {\n    let profiler;\n    function onRumStart(lifeCycle, hooks, configuration, sessionManager, viewHistory, createEncoder) {\n        const session = sessionManager.findTrackedSession(); // Check if the session is tracked.\n        if (!session) {\n            // No session tracked, no profiling.\n            // Note: No Profiling context is set at this stage.\n            return;\n        }\n        // Sampling (sticky sampling based on session id)\n        if (!isSampled(session.id, configuration.profilingSampleRate)) {\n            // No sampling, no profiling.\n            // Note: No Profiling context is set at this stage.\n            return;\n        }\n        // Listen to events and add the profiling context to them.\n        const profilingContextManager = startProfilingContext(hooks);\n        // Browser support check\n        if (!isProfilingSupported()) {\n            profilingContextManager.set({\n                status: 'error',\n                error_reason: 'not-supported-by-browser',\n            });\n            return;\n        }\n        lazyLoadProfiler()\n            .then((createRumProfiler) => {\n            if (!createRumProfiler) {\n                // monitor-until: 2026-01-01, reconsider after profiling GA\n                addTelemetryDebug('[DD_RUM] Failed to lazy load the RUM Profiler');\n                profilingContextManager.set({ status: 'error', error_reason: 'failed-to-lazy-load' });\n                return;\n            }\n            profiler = createRumProfiler(configuration, lifeCycle, sessionManager, profilingContextManager, createEncoder);\n            profiler.start(viewHistory.findView());\n        })\n            .catch(monitorError);\n    }\n    return {\n        onRumStart,\n        stop: () => {\n            profiler === null || profiler === void 0 ? void 0 : profiler.stop().catch(monitorError);\n        },\n    };\n}\n//# sourceMappingURL=profilerApi.js.map","/**\n * Datadog Browser RUM SDK - Full version with Session Replay and Real User Profiling capabilities.\n * Use this package to monitor your web application's performance and user experience.\n *\n * @packageDocumentation\n * @see [RUM Browser Monitoring Setup](https://docs.datadoghq.com/real_user_monitoring/browser/)\n */\n// Keep the following in sync with packages/rum-slim/src/entries/main.ts\nimport { defineGlobal, getGlobalObject } from '@datadog/browser-core';\nimport { makeRumPublicApi, startRum } from '@datadog/browser-rum-core';\nimport { makeRecorderApi } from '../boot/recorderApi';\nimport { createDeflateEncoder, startDeflateWorker } from '../domain/deflate';\nimport { lazyLoadRecorder } from '../boot/lazyLoadRecorder';\nimport { makeProfilerApi } from '../boot/profilerApi';\nexport { DefaultPrivacyLevel } from '@datadog/browser-core';\nconst recorderApi = makeRecorderApi(lazyLoadRecorder);\nconst profilerApi = makeProfilerApi();\n/**\n * The global RUM instance. Use this to call RUM methods.\n *\n * @category Main\n * @see {@link DatadogRum}\n * @see [RUM Browser Monitoring Setup](https://docs.datadoghq.com/real_user_monitoring/browser/)\n */\nexport const datadogRum = makeRumPublicApi(startRum, recorderApi, profilerApi, {\n    startDeflateWorker,\n    createDeflateEncoder,\n    sdkName: 'rum',\n});\ndefineGlobal(getGlobalObject(), 'DD_RUM', datadogRum);\n//# sourceMappingURL=main.js.map"],"file":"assets/main-CtGiKbkr.js"}